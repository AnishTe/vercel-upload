(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{6160:(e,r,a)=>{Promise.resolve().then(a.bind(a,4083))},4083:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>C});var t=a(5155),s=a(2115),l=a(7594),n=a(853),i=a(960),c=a(9606),d=a(3415),o=a(2679),m=a(3312),u=a(9749),x=a(4870),f=a(3409),h=a(1719),p=a(1902),y=a(8867),N=a(1567);let j=f.bL;f.YJ;let g=f.WT,w=s.forwardRef((e,r)=>{let{className:a,children:s,...l}=e;return(0,t.jsxs)(f.l9,{ref:r,className:(0,N.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[s,(0,t.jsx)(f.In,{asChild:!0,children:(0,t.jsx)(h.A,{className:"h-4 w-4 opacity-50"})})]})});w.displayName=f.l9.displayName;let v=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(f.PP,{ref:r,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,t.jsx)(p.A,{className:"h-4 w-4"})})});v.displayName=f.PP.displayName;let b=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(f.wn,{ref:r,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,t.jsx)(h.A,{className:"h-4 w-4"})})});b.displayName=f.wn.displayName;let A=s.forwardRef((e,r)=>{let{className:a,children:s,position:l="popper",...n}=e;return(0,t.jsx)(f.ZL,{children:(0,t.jsxs)(f.UC,{ref:r,className:(0,N.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,t.jsx)(v,{}),(0,t.jsx)(f.LM,{className:(0,N.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,t.jsx)(b,{})]})})});A.displayName=f.UC.displayName,s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(f.JU,{ref:r,className:(0,N.cn)("px-2 py-1.5 text-sm font-semibold",a),...s})}).displayName=f.JU.displayName;let T=s.forwardRef((e,r)=>{let{className:a,children:s,...l}=e;return(0,t.jsxs)(f.q7,{ref:r,className:(0,N.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(f.VF,{children:(0,t.jsx)(y.A,{className:"h-4 w-4"})})}),(0,t.jsx)(f.p4,{children:s})]})});T.displayName=f.q7.displayName,s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(f.wv,{ref:r,className:(0,N.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=f.wv.displayName;var _=a(3404);let S=[{id:"scrip_name",accessorKey:"scrip_name",header:"Scrip Name",cell:e=>{let{row:r}=e;return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:r.original.scrip_name}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Scrip Symbol: ",r.original.SCRIP_SYMBOL]})]})}},{id:"BUY_QTY",accessorKey:"BUY_QTY",header:"Buy Quantity"},{id:"BUY_RATE",accessorKey:"BUY_RATE",header:"Buy Rate",cell:e=>{let{row:r}=e;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r.original.BUY_RATE)}},{id:"BUY_AMT",accessorKey:"BUY_AMT",header:"Buy Amount",cell:e=>{let{row:r}=e;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r.original.BUY_AMT)}},{id:"BUY_TRADE_DATE",accessorKey:"BUY_TRADE_DATE",header:"Buy Trade Date"},{id:"SALE_QTY",accessorKey:"SALE_QTY",header:"Sale Quantity",conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_RATE",accessorKey:"SALE_RATE",header:"Sale Rate",cell:e=>{let{row:r}=e;return r.original.SALE_RATE?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r.original.SALE_RATE):"-"},conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_AMT",accessorKey:"SALE_AMT",header:"Sale Amount",cell:e=>{let{row:r}=e;return r.original.SALE_AMT?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r.original.SALE_AMT):"-"},conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"NET_QTY",accessorKey:"NET_QTY",header:"Net Quantity"},{id:"CURR_AMOUNT",accessorKey:"CURR_AMOUNT",header:"Current Amount",cell:e=>{let{row:r}=e;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r.original.CURR_AMOUNT)}},{id:"PL_AMT",accessorKey:"PL_AMT",header:"P&L Amount",cell:e=>{let{row:r}=e,a=r.original.PL_AMT,s=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return(0,t.jsx)("span",{className:a>=0?"text-green-600":"text-red-600",children:s})}},{id:"Closing_Price",accessorKey:"Closing_Price",header:"Closing Price",cell:e=>{let{row:r}=e;return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r.original.Closing_Price)}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:r.original.PriceDate})]})}}];var E=a(9063),R=a(5147),I=a(1541),D=a(6323),P=a(814),Y=a(7328),M=a(3900);function C(){let[e,r]=(0,s.useState)(!1),[a,f]=(0,s.useState)(null),[h,p]=(0,s.useState)([]),[y,N]=(0,s.useState)(!1),[v,b]=(0,s.useState)([]),C=(()=>{let e=new Date,r=e.getMonth(),a=e.getFullYear(),t=r<3?a-1:a;return Array.from({length:5},(e,r)=>{let a=t-r;return{label:"".concat(a,"-").concat(a+1),value:"".concat(a,"-").concat(a+1),fromDate:(0,i.GP)(new Date(a,3,1),"dd/MM/yyyy"),toDate:(0,i.GP)(new Date(a+1,2,31),"dd/MM/yyyy")}})})(),F=d.Ik({financialYear:d.Ik({fromDate:d.Yj(),toDate:d.Yj(),value:d.Yj()}),toDate:d.Yj().nonempty("To Date is required")}),L=(0,c.mN)({resolver:(0,o.u)(F),defaultValues:{financialYear:C[0],toDate:C[0].toDate}}),{watch:B,setValue:U}=L;(0,s.useEffect)(()=>{let e=B((e,r)=>{let{name:a}=r;if("financialYear"===a){var t;U("toDate",(null===(t=e.financialYear)||void 0===t?void 0:t.toDate)||C[0].toDate)}});return()=>e.unsubscribe()},[B,C,U]);let O=async(e,a)=>{r(!0);try{let r=await (0,D.yF)({fromDate:e,toDate:a});if(!(0,Y.k)(r)){N(!0);return}let t=JSON.parse(r.data.data);if("True"===t.Success){P.oR.success("Data fetched successfully!");let e=t["Success Description"],r=e.filter(e=>"Expenses"===e.TR_TYPE),a=e.filter(e=>"Expenses"!==e.TR_TYPE);b(r),p(a)}else throw Error(t["Error Description"]||"Failed to fetch data.")}catch(e){f(e.message||"An error occurred.")}finally{r(!1)}};(0,s.useEffect)(()=>{let{fromDate:e,toDate:r}=C[0];O(e,r)},[]);let k=h.reduce((e,r)=>{var a;let t=r.TR_TYPE;return e[t]||(e[t]={rows:[],sum:0}),e[t].rows.push(r),e[t].sum+=parseFloat((null===(a=r.PL_AMT)||void 0===a?void 0:a.toString())||"0"),e},{}),K=null==v?void 0:v.reduce((e,r)=>{var a;return e+parseFloat((null===(a=r.PL_AMT)||void 0===a?void 0:a.toString())||"0")},0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.A,{children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{className:"flex flex-row items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(u.ZB,{children:"Annual P&L Report"})}),(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(x.lV,{...L,children:(0,t.jsxs)("form",{onSubmit:L.handleSubmit(e=>{let{financialYear:r,toDate:a}=e;O(r.fromDate,a)}),className:"flex gap-3",children:[(0,t.jsx)(x.zB,{control:L.control,name:"financialYear",render:e=>{var r;let{field:a}=e;return(0,t.jsxs)(x.eI,{className:"w-[200px]",children:[(0,t.jsxs)(j,{onValueChange:e=>{let r=C.find(r=>r.value===e);a.onChange(r)},defaultValue:(null===(r=a.value)||void 0===r?void 0:r.value)||"",children:[(0,t.jsx)(x.MJ,{children:(0,t.jsx)(w,{children:(0,t.jsx)(g,{placeholder:"Select year"})})}),(0,t.jsx)(A,{children:C.map(e=>(0,t.jsx)(T,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(x.C5,{})]})}}),(0,t.jsx)(x.zB,{control:L.control,name:"toDate",render:e=>{let{field:r}=e;return(0,t.jsxs)(x.eI,{className:"w-[150px]",children:[(0,t.jsx)(x.MJ,{children:(0,t.jsx)(M.p,{type:"date",className:"flex h-10 w-full rounded-md border text-white bg-transparent px-3 py-2 text-sm ",value:(0,i.GP)(new Date(r.value.split("/").reverse().join("-")),"yyyy-MM-dd"),min:(0,i.GP)(new Date(L.watch("financialYear").fromDate.split("/").reverse().join("-")),"yyyy-MM-dd"),max:(0,i.GP)(new Date(L.watch("financialYear").toDate.split("/").reverse().join("-")),"yyyy-MM-dd"),onChange:e=>{let a=new Date(e.target.value);r.onChange((0,i.GP)(a,"dd/MM/yyyy"))}})}),(0,t.jsx)(x.C5,{})]})}}),(0,t.jsx)(m.$,{type:"submit",disabled:e,children:e?(0,t.jsx)(l.A,{}):(0,t.jsx)(n.A,{className:"h-5 w-5"})})]})})})]}),(0,t.jsxs)(u.Wu,{children:[e?(0,t.jsx)(R.A,{columns:4,rows:10}):a?(0,t.jsx)("h3",{className:"text-center text-red-500",children:a}):Object.entries(k).map(e=>{let[r,{rows:a,sum:s}]=e;return(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"OP_ASSETS"===r?"Opening Assets":r}),(0,t.jsxs)("p",{className:"font-semibold ".concat(s>=0?"text-green-600":"text-red-600"),children:["Total ",s>=0?"Profit":"Loss",":"," ",(0,t.jsx)(I.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s)})]})]}),(0,t.jsx)(_.b,{columns:S,data:a,filterColumn:"scrip_name",filterPlaceholder:"Filter Scrip...",showAllRows:!0})]},r)}),v&&v.length>0&&(0,t.jsxs)("div",{className:"mt-6 border rounded-lg shadow-md bg-background  max-w-sm p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center m-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Expenses Details"}),(0,t.jsx)("span",{className:"font-bold ".concat(K>=0?"text-green-600":"text-red-600"),children:"".concat(new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(K))})]}),(0,t.jsx)("ul",{className:"space-y-4",children:v.map((e,r)=>(0,t.jsxs)("li",{className:"flex justify-between items-center p-2 border-b last:border-0",children:[(0,t.jsx)("span",{className:"font-medium ",children:e.BUY_COMPANY_CODE}),(0,t.jsx)("span",{children:(0,t.jsx)(I.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(e.PL_AMT)})})]},r))})]})]})]})})}),y&&(0,t.jsx)(Y.B,{})]})}},5147:(e,r,a)=>{"use strict";a.d(r,{A:()=>l});var t=a(5155);a(2115);var s=a(7081);let l=e=>{let{columns:r,rows:a}=e;return(0,t.jsxs)("div",{className:"w-full p-4 space-y-4",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(r||4)].map((e,r)=>(0,t.jsx)("div",{className:"h-9 rounded-lg bg-gray-100 dark:bg-gray-800",children:(0,t.jsx)(s.E,{className:"w-full h-full"})},"header-".concat(r)))}),(0,t.jsx)("div",{className:"space-y-2",children:[...Array(a||10)].map((e,a)=>(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(r||4)].map((e,r)=>(0,t.jsx)("div",{className:"h-12 rounded-lg bg-gray-100 dark:bg-gray-800",children:(0,t.jsx)(s.E,{className:"w-full h-full"})},"cell-".concat(a,"-").concat(r)))},"row-".concat(a)))})]})}},4870:(e,r,a)=>{"use strict";a.d(r,{C5:()=>y,MJ:()=>p,eI:()=>f,lR:()=>h,lV:()=>d,zB:()=>m});var t=a(5155),s=a(2115),l=a(2317),n=a(9606),i=a(1567),c=a(8986);let d=n.Op,o=s.createContext({}),m=e=>{let{...r}=e;return(0,t.jsx)(o.Provider,{value:{name:r.name},children:(0,t.jsx)(n.xI,{...r})})},u=()=>{let e=s.useContext(o),r=s.useContext(x),{getFieldState:a,formState:t}=(0,n.xW)(),l=a(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...l}},x=s.createContext({}),f=s.forwardRef((e,r)=>{let{className:a,...l}=e,n=s.useId();return(0,t.jsx)(x.Provider,{value:{id:n},children:(0,t.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",a),...l})})});f.displayName="FormItem";let h=s.forwardRef((e,r)=>{let{className:a,...s}=e,{error:l,formItemId:n}=u();return(0,t.jsx)(c.J,{ref:r,className:(0,i.cn)(l&&"text-destructive",a),htmlFor:n,...s})});h.displayName="FormLabel";let p=s.forwardRef((e,r)=>{let{...a}=e,{error:s,formItemId:n,formDescriptionId:i,formMessageId:c}=u();return(0,t.jsx)(l.DX,{ref:r,id:n,"aria-describedby":s?"".concat(i," ").concat(c):"".concat(i),"aria-invalid":!!s,...a})});p.displayName="FormControl",s.forwardRef((e,r)=>{let{className:a,...s}=e,{formDescriptionId:l}=u();return(0,t.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-[0.8rem] text-muted-foreground",a),...s})}).displayName="FormDescription";let y=s.forwardRef((e,r)=>{let{className:a,children:s,...l}=e,{error:n,formMessageId:c}=u(),d=n?String(null==n?void 0:n.message):s;return d?(0,t.jsx)("p",{ref:r,id:c,className:(0,i.cn)("text-[0.8rem] font-medium text-destructive",a),...l,children:d}):null});y.displayName="FormMessage"},8986:(e,r,a)=>{"use strict";a.d(r,{J:()=>d});var t=a(5155),s=a(2115),l=a(6195),n=a(1027),i=a(1567);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(l.b,{ref:r,className:(0,i.cn)(c(),a),...s})});d.displayName=l.b.displayName}},e=>{var r=r=>e(e.s=r);e.O(0,[247,814,794,518,440,825,137,802,272,409,282,491,441,517,358],()=>r(6160)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{6160:(e,a,r)=>{Promise.resolve().then(r.bind(r,4083))},4083:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>C});var t=r(5155),s=r(2115),l=r(7594),n=r(853),i=r(960),c=r(9606),o=r(3415),d=r(2679),m=r(3312),u=r(9749),x=r(4870),f=r(3409),h=r(1719),y=r(1902),p=r(8867),N=r(1567);let j=f.bL;f.YJ;let w=f.WT,A=s.forwardRef((e,a)=>{let{className:r,children:s,...l}=e;return(0,t.jsxs)(f.l9,{ref:a,className:(0,N.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...l,children:[s,(0,t.jsx)(f.In,{asChild:!0,children:(0,t.jsx)(h.A,{className:"h-4 w-4 opacity-50"})})]})});A.displayName=f.l9.displayName;let g=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(f.PP,{ref:a,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,t.jsx)(y.A,{className:"h-4 w-4"})})});g.displayName=f.PP.displayName;let T=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(f.wn,{ref:a,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,t.jsx)(h.A,{className:"h-4 w-4"})})});T.displayName=f.wn.displayName;let _=s.forwardRef((e,a)=>{let{className:r,children:s,position:l="popper",...n}=e;return(0,t.jsx)(f.ZL,{children:(0,t.jsxs)(f.UC,{ref:a,className:(0,N.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...n,children:[(0,t.jsx)(g,{}),(0,t.jsx)(f.LM,{className:(0,N.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,t.jsx)(T,{})]})})});_.displayName=f.UC.displayName,s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(f.JU,{ref:a,className:(0,N.cn)("px-2 py-1.5 text-sm font-semibold",r),...s})}).displayName=f.JU.displayName;let b=s.forwardRef((e,a)=>{let{className:r,children:s,...l}=e;return(0,t.jsxs)(f.q7,{ref:a,className:(0,N.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,t.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(f.VF,{children:(0,t.jsx)(p.A,{className:"h-4 w-4"})})}),(0,t.jsx)(f.p4,{children:s})]})});b.displayName=f.q7.displayName,s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(f.wv,{ref:a,className:(0,N.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=f.wv.displayName;var v=r(3404);let S=[{id:"scrip_name",accessorKey:"scrip_name",header:"Scrip Name",cell:e=>{let{row:a}=e;return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:a.original.scrip_name}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Scrip Symbol: ",a.original.SCRIP_SYMBOL]})]})}},{id:"BUY_QTY",accessorKey:"BUY_QTY",header:"Buy Quantity"},{id:"BUY_RATE",accessorKey:"BUY_RATE",header:"Buy Rate",cell:e=>{let{row:a}=e;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.original.BUY_RATE)}},{id:"BUY_AMT",accessorKey:"BUY_AMT",header:"Buy Amount",cell:e=>{let{row:a}=e;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.original.BUY_AMT)}},{id:"BUY_TRADE_DATE",accessorKey:"BUY_TRADE_DATE",header:"Buy Trade Date"},{id:"SALE_QTY",accessorKey:"SALE_QTY",header:"Sale Quantity",conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_RATE",accessorKey:"SALE_RATE",header:"Sale Rate",cell:e=>{let{row:a}=e;return a.original.SALE_RATE?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.original.SALE_RATE):"-"},conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_AMT",accessorKey:"SALE_AMT",header:"Sale Amount",cell:e=>{let{row:a}=e;return a.original.SALE_AMT?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.original.SALE_AMT):"-"},conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_TRADE_DATE",accessorKey:"SALE_TRADE_DATE",header:"Sale Date"},{id:"NET_QTY",accessorKey:"NET_QTY",header:"Net Quantity"},{id:"CURR_AMOUNT",accessorKey:"CURR_AMOUNT",header:"Current Amount",cell:e=>{let{row:a}=e;return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.original.CURR_AMOUNT)}},{id:"PL_AMT",accessorKey:"PL_AMT",header:"P&L Amount",cell:e=>{let{row:a}=e,r=a.original.PL_AMT,s=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r);return(0,t.jsx)("span",{className:r>=0?"text-green-600":"text-red-600",children:s})}},{id:"Closing_Price",accessorKey:"Closing_Price",header:"Closing Price",cell:e=>{let{row:a}=e;return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.original.Closing_Price)}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:a.original.PriceDate})]})}}];var E=r(3092),R=r(5147),D=r(1541),P=r(6323),Y=r(814),I=r(7328),M=r(3900);function C(){let[e,a]=(0,s.useState)(!1),[r,f]=(0,s.useState)(null),[h,y]=(0,s.useState)([]),[p,N]=(0,s.useState)(!1),[g,T]=(0,s.useState)([]),C=(()=>{let e=new Date,a=e.getMonth(),r=e.getFullYear(),t=a<3?r-1:r;return Array.from({length:5},(e,a)=>{let r=t-a;return{label:"".concat(r,"-").concat(r+1),value:"".concat(r,"-").concat(r+1),fromDate:(0,i.GP)(new Date(r,3,1),"dd/MM/yyyy"),toDate:(0,i.GP)(new Date(r+1,2,31),"dd/MM/yyyy")}})})(),L=o.Ik({financialYear:o.Ik({fromDate:o.Yj(),toDate:o.Yj(),value:o.Yj()}),toDate:o.Yj().nonempty("To Date is required")}),U=(0,c.mN)({resolver:(0,d.u)(L),defaultValues:{financialYear:C[0],toDate:C[0].toDate}}),{watch:B,setValue:F}=U;(0,s.useEffect)(()=>{let e=B((e,a)=>{let{name:r}=a;if("financialYear"===r){var t;F("toDate",(null===(t=e.financialYear)||void 0===t?void 0:t.toDate)||C[0].toDate)}});return()=>e.unsubscribe()},[B,C,F]);let O=async(e,r)=>{a(!0);try{let a=await (0,P.yF)({fromDate:e,toDate:r});if(!(0,I.k)(a)){N(!0);return}let t=JSON.parse(a.data.data);if("True"===t.Success){Y.oR.success("Data fetched successfully!");let e=t["Success Description"],a=e.filter(e=>"Expenses"===e.TR_TYPE),r=e.filter(e=>"Expenses"!==e.TR_TYPE);T(a),y(r)}else throw Error(t["Error Description"]||"Failed to fetch data.")}catch(e){f(e.message||"An error occurred.")}finally{a(!1)}};(0,s.useEffect)(()=>{let{fromDate:e,toDate:a}=C[0];O(e,a)},[]);let K=h.reduce((e,a)=>{var r;let t=a.TR_TYPE;return e[t]||(e[t]={rows:[],sum:0}),e[t].rows.push(a),e[t].sum+=parseFloat((null===(r=a.PL_AMT)||void 0===r?void 0:r.toString())||"0"),e},{}),k=null==g?void 0:g.reduce((e,a)=>{var r;return e+parseFloat((null===(r=a.PL_AMT)||void 0===r?void 0:r.toString())||"0")},0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E.A,{children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{className:"flex flex-row items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(u.ZB,{children:"Annual P&L Report"})}),(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(x.lV,{...U,children:(0,t.jsxs)("form",{onSubmit:U.handleSubmit(e=>{let{financialYear:a,toDate:r}=e;O(a.fromDate,r)}),className:"flex gap-3",children:[(0,t.jsx)(x.zB,{control:U.control,name:"financialYear",render:e=>{var a;let{field:r}=e;return(0,t.jsxs)(x.eI,{className:"w-[200px]",children:[(0,t.jsxs)(j,{onValueChange:e=>{let a=C.find(a=>a.value===e);r.onChange(a)},defaultValue:(null===(a=r.value)||void 0===a?void 0:a.value)||"",children:[(0,t.jsx)(x.MJ,{children:(0,t.jsx)(A,{children:(0,t.jsx)(w,{placeholder:"Select year"})})}),(0,t.jsx)(_,{children:C.map(e=>(0,t.jsx)(b,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(x.C5,{})]})}}),(0,t.jsx)(x.zB,{control:U.control,name:"toDate",render:e=>{let{field:a}=e;return(0,t.jsxs)(x.eI,{className:"w-[150px]",children:[(0,t.jsx)(x.MJ,{children:(0,t.jsx)(M.p,{type:"date",className:"flex h-10 w-full rounded-md border text-white bg-transparent px-3 py-2 text-sm ",value:(0,i.GP)(new Date(a.value.split("/").reverse().join("-")),"yyyy-MM-dd"),min:(0,i.GP)(new Date(U.watch("financialYear").fromDate.split("/").reverse().join("-")),"yyyy-MM-dd"),max:(0,i.GP)(new Date(U.watch("financialYear").toDate.split("/").reverse().join("-")),"yyyy-MM-dd"),onChange:e=>{let r=new Date(e.target.value);a.onChange((0,i.GP)(r,"dd/MM/yyyy"))}})}),(0,t.jsx)(x.C5,{})]})}}),(0,t.jsx)(m.$,{type:"submit",disabled:e,children:e?(0,t.jsx)(l.A,{}):(0,t.jsx)(n.A,{className:"h-5 w-5"})})]})})})]}),(0,t.jsxs)(u.Wu,{children:[e?(0,t.jsx)(R.A,{columns:4,rows:10}):r?(0,t.jsx)("h3",{className:"text-center text-red-500",children:r}):Object.entries(K).map(e=>{let[a,{rows:r,sum:s}]=e;return(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"OP_ASSETS"===a?"Opening Assets":a}),(0,t.jsxs)("p",{className:"font-semibold ".concat(s>=0?"text-green-600":"text-red-600"),children:["Total ",s>=0?"Profit":"Loss",":"," ",(0,t.jsx)(D.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s)})]})]}),(0,t.jsx)(v.b,{columns:S,data:r,filterColumn:"scrip_name",filterPlaceholder:"Filter Scrip...",showAllRows:!0})]},a)}),g&&g.length>0&&(0,t.jsxs)("div",{className:"mt-6 border rounded-lg shadow-md bg-background  max-w-sm p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center m-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Expenses Details"}),(0,t.jsx)("span",{className:"font-bold ".concat(k>=0?"text-green-600":"text-red-600"),children:"".concat(new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(k))})]}),(0,t.jsx)("ul",{className:"space-y-4",children:g.map((e,a)=>(0,t.jsxs)("li",{className:"flex justify-between items-center p-2 border-b last:border-0",children:[(0,t.jsx)("span",{className:"font-medium ",children:e.BUY_COMPANY_CODE}),(0,t.jsx)("span",{children:(0,t.jsx)(D.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(e.PL_AMT)})})]},a))})]})]})]})})}),p&&(0,t.jsx)(I.B,{})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[247,814,794,176,42,518,802,272,409,76,92,473,441,517,358],()=>a(6160)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[354],{102:(e,t,a)=>{Promise.resolve().then(a.bind(a,949))},949:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(5155),l=a(2115),r=a(9749),n=a(7081);let i=[{accessorFn:e=>"".concat(e.DP_ID).concat(e.BO_ID),header:"BOID"},{accessorKey:"SCRIP_NAME",header:"Scrip Name"},{accessorKey:"ISIN",header:"ISIN"},{accessorKey:"SCRIP_SYMBOL",header:"Scrip Symbol"},{accessorKey:"SCRIP_VALUE",header:"Closing Price",cell:e=>{let{row:t}=e,a=parseFloat(t.getValue("SCRIP_VALUE"));return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a)}},{accessorKey:"NET",header:"Quantity"},{accessorKey:"AMOUNT",header:"Amount",cell:e=>{let{row:t}=e,a=parseFloat(t.getValue("AMOUNT"));return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a)}},{accessorKey:"PERCENT_HOLD",header:"Percent of Hold",cell:e=>{let{row:t}=e,a=parseFloat(t.getValue("PERCENT_HOLD"));return"".concat(a.toFixed(2),"%")}}];var c=a(3404),o=a(1541),d=a(9063),u=a(1344),h=a(3312),p=a(6323),x=a(814),m=a(7328),E=a(6472),N=a(5781);function f(){let[e,t]=(0,l.useState)(!0),[a,N]=(0,l.useState)(null),[f,g]=(0,l.useState)(!1),[C,F]=(0,l.useState)([]),[R,b]=(0,l.useState)(0),[y,D]=(0,l.useState)(!1),[j,S]=(0,l.useState)([]),_=[{accessorKey:"scripName",header:"Scrip Name",cell:e=>{let{row:t}=e;return t.original.SCRIP_NAME}},{accessorKey:"percentageOfHold",header:"Percentage of Hold",cell:e=>{let{row:t}=e;return t.original.PERCENT_HOLD}},{accessorKey:"quantity",header:"Quantity",cell:e=>{let{row:t}=e;return t.original.NET}},{accessorKey:"price",header:"Price",cell:e=>{let{row:t}=e;return t.original.SCRIP_VALUE}},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:t}=e;return t.original.AMOUNT}}];(0,l.useEffect)(()=>{(async()=>{t(!0);try{let e=await (0,p.$)();if(!(0,m.k)(e)){g(!0);return}if(e&&e.data&&e.data.data)try{let t=JSON.parse(e.data.data);if("True"===t.Success&&t["Success Description"]){let e=t["Success Description"];F(e)}else throw Error(t["Error Description"]||"Failed to fetch Holdings data.")}catch(e){N("Error parsing data: "+e.message)}else throw Error("Invalid API response format.")}catch(e){N(e.message||"An error occurred while fetching data.")}finally{t(!1)}})()},[]),(0,l.useEffect)(()=>{if(C.length>0){var e;let t=parseFloat((null===(e=C[0])||void 0===e?void 0:e.TOT_AMT)||0);isNaN(t)||t===R||b(t)}},[C,R]);let{top3:P,remaining:T,tail:O,top3Rows:w,tailRows:H,remainingRows:v}=(()=>{if(!C||0===C.length)return{top3:0,remaining:0,tail:0,top3Rows:[],tailRows:[],remainingRows:[]};let e=[...C.map(e=>({...e,PERCENT_HOLD:!e.PERCENT_HOLD||isNaN(parseFloat(e.PERCENT_HOLD))?0:parseFloat(e.PERCENT_HOLD)}))].sort((e,t)=>t.PERCENT_HOLD-e.PERCENT_HOLD),t=e.slice(0,3),a=t.reduce((e,t)=>e+parseFloat(t.PERCENT_HOLD),0),s=e.filter(e=>1>=parseFloat(e.PERCENT_HOLD)),l=s.reduce((e,t)=>e+parseFloat(t.PERCENT_HOLD),0),r=e.filter(e=>!t.includes(e)&&!s.includes(e)&&parseFloat(e.PERCENT_HOLD)>1);return{top3:a,remaining:r.reduce((e,t)=>e+parseFloat(t.PERCENT_HOLD),0),tail:l,top3Rows:t,tailRows:s,remainingRows:r}})(),{labels:I,data:L,colors:k}=(()=>{if(!C||0===C.length)return{labels:[],data:[],colors:[]};let e=e=>{let t="string"==typeof e?parseFloat(e):e;return isNaN(t)?0:parseFloat(t.toFixed(2))},t=[...C.map(t=>({...t,PERCENT_HOLD:e(t.PERCENT_HOLD)}))].sort((t,a)=>e(a.PERCENT_HOLD)-e(t.PERCENT_HOLD)),a=t.filter(t=>1>=e(t.PERCENT_HOLD)).reduce((t,a)=>t+e(a.PERCENT_HOLD),0),s=t.filter(t=>e(t.PERCENT_HOLD)>1),l=["#36A2EB","#FF6384","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#C9CBCF","#8A2BE2","#ADFF2F","#FF4500","#FFD700"],r=s.map(e=>e.SCRIP_NAME||"Unnamed Stock"),n=s.map(t=>e(t.PERCENT_HOLD)),i=s.map((e,t)=>l[t%l.length]);return a>0&&(r.push("Tail Stocks"),n.push(e(a)),i.push("#FF0000")),{labels:r,data:n,colors:i}})();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(r.Zp,{children:[(0,s.jsxs)(r.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsxs)(r.ZB,{children:["Holdings",(0,s.jsx)(h.$,{variant:"outline",onClick:()=>(0,x.oR)("Event has been created",{description:"Sunday, December 03, 2023 at 9:00 AM",action:{label:"Undo",onClick:()=>console.log("Undo")}}),children:"Show Toast"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total Value:"}),e?(0,s.jsx)(n.E,{className:"h-4 w-[100px]"}):(0,s.jsx)("span",{className:"font-bold",children:(0,s.jsx)(o.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(R)})})]})]}),(0,s.jsx)(r.Wu,{children:e?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.E,{className:"h-4 w-full"}),(0,s.jsx)(n.E,{className:"h-4 w-full"}),(0,s.jsx)(n.E,{className:"h-4 w-full"})]}):a?(0,s.jsx)("div",{className:"text-center text-red-500",children:a}):(0,s.jsx)(c.b,{columns:i,data:C})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)(r.Zp,{children:[(0,s.jsx)(r.aR,{children:(0,s.jsx)(r.ZB,{children:"Holdings Distribution"})}),(0,s.jsx)(r.Wu,{children:e?(0,s.jsx)(n.E,{className:"h-[350px] w-full md:h-[400px]"}):(0,s.jsx)("div",{className:"relative h-[350px] w-full md:h-[400px]",children:(0,s.jsx)(E.Fq,{data:{labels:["Top 3 Holdings","Remaining","Tail Holdings"],datasets:[{label:"Holdings Distribution",data:[P,T,O],backgroundColor:["#36A2EB","#FF6384","#FFCE56"],hoverOffset:4}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{label:function(e){let t=e.raw.toFixed(2);return"".concat(e.label,": ").concat(t,"%")}}},legend:{display:!0,position:"top",labels:{generateLabels:function(e){let t=e.data;return t.labels.map((a,s)=>{let l=t.datasets[0].data[s],r=e.getDatasetMeta(0).data[s].hidden;return{text:"".concat(a,": ").concat(l.toFixed(2),"%"),fillStyle:t.datasets[0].backgroundColor[s],strokeStyle:t.datasets[0].backgroundColor[s],lineWidth:0,index:s,hidden:r}})},font:{size:14},color:"#333",padding:10,usePointStyle:!0,boxWidth:12,filter:function(e){return e.hidden&&(e.fontStyle="italic",e.text="- ".concat(e.text)),!0}},onClick:function(e,t){let a=e.chart,s=t.index,l=a.getDatasetMeta(0);l.data[s].hidden=!l.data[s].hidden,a.update()}}},onClick:(e,t)=>{t.length>0&&(S({top3Rows:w,remainingRows:v,tailRows:H}[["top3Rows","remainingRows","tailRows"][t[0].index]]||[]),D(!0))}}})})})]}),(0,s.jsxs)(r.Zp,{children:[(0,s.jsx)(r.aR,{children:(0,s.jsx)(r.ZB,{children:"Stock-wise Distribution"})}),(0,s.jsx)(r.Wu,{children:e?(0,s.jsx)(n.E,{className:"h-[350px] w-full md:h-[400px]"}):(0,s.jsx)("div",{className:"relative h-[350px] w-full md:h-[450px]",children:(0,s.jsx)(E.Fq,{data:{labels:I,datasets:[{label:"Stock Wise Distribution",data:L,backgroundColor:k,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",align:"start",labels:{boxWidth:12,padding:10,font:{size:12},usePointStyle:!0,generateLabels:function(e){let t=e.data,a=e.ctx;return t.labels.map((s,l)=>{let r=t.datasets[0].data[l],n=e.getDatasetMeta(0).data[l].hidden,i=[],c="";return s.split(" ").forEach(e=>{let t=c+e+" ";a.measureText(t).width>120?(i.push(c.trim()),c=e+" "):c=t}),i.push(c.trim()),{text:"".concat(i.join("\n"),": ").concat(r.toFixed(2),"%"),fillStyle:t.datasets[0].backgroundColor[l],strokeStyle:t.datasets[0].backgroundColor[l],hidden:n,datasetIndex:0,index:l}})},color:"#333"},onClick:function(e,t,a){let s=a.chart,l=t.index,r=s.getDatasetMeta(0);r.data[l].hidden=!r.data[l].hidden,s.update()}},tooltip:{callbacks:{label:function(e){var t;let a=e.raw.toFixed(2),s=parseFloat((null===(t=C.find(t=>t.SCRIP_NAME===e.label))||void 0===t?void 0:t.AMOUNT)||0),l=new Intl.NumberFormat("en-IN",{maximumFractionDigits:2,minimumFractionDigits:2}).format(s);return"".concat(e.label,": ").concat(a,"% (â‚¹").concat(l,")")}}}},layout:{padding:{left:10,right:10}},onClick:(e,t)=>{if(t.length>0){let e;let a=I[t[0].index];(e="Tail Stocks"===a?H:C.filter(e=>e.SCRIP_NAME===a))&&e.length>0&&(S(e),D(!0))}}}})})})]})]})]})}),(0,s.jsx)(u.lG,{open:y,onOpenChange:D,children:(0,s.jsxs)(u.Cf,{className:"max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)(u.c7,{children:[(0,s.jsx)(u.L3,{children:"Holdings Chart Data"}),(0,s.jsx)(u.rr,{children:"Holdings Chart data that are available in selected section."})]}),(0,s.jsx)(c.b,{columns:_,data:j,showAllRows:!0})]})}),f&&(0,s.jsx)(m.B,{})]})}N.t1.register(N.Bs,N.m_,N.s$)}},e=>{var t=t=>e(e.s=t);e.O(0,[647,247,814,794,518,440,825,802,759,282,491,441,517,358],()=>t(102)),_N_E=e.O()}]);
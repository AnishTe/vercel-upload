(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{8832:(e,r,a)=>{Promise.resolve().then(a.bind(a,8209))},8209:(e,r,a)=>{"use strict";a.d(r,{default:()=>F});var t=a(5155),s=a(2115),l=a(7594),n=a(853),c=a(1902),i=a(1719),o=a(960),d=a(830),m=a(9606),u=a(3415),h=a(2679),x=a(3312),N=a(9749),y=a(4870),g=a(3900),p=a(3404),f=a(9063),j=a(5147),A=a(5765);let T=e=>[{id:"COCD",accessorKey:"COCD",header:"COCD"},{id:"VOUCHERDATE",accessorKey:"VOUCHERDATE",header:"Date",cell:e=>{let{row:r}=e,a=new Date(r.original.VOUCHERDATE);return(0,t.jsx)("span",{className:"truncate ",children:a.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"2-digit"})})}},{id:"NARRATION",accessorKey:"NARRATION",header:"Narration",cell:e=>{let{row:r}=e;return(0,t.jsx)("div",{className:"max-w-[500px] min-w-[200px] whitespace-normal break-words",title:r.original.NARRATION,children:r.original.NARRATION})}},{id:"OpeningBalance",header:"Opening Balance",cell:e=>{let{row:r}=e;return(0,t.jsx)("span",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(r.original.OpeningBalance)})}},{id:"Amount",header:"Amount",cell:r=>{let{row:a}=r;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(a.original.Amount)}),"BILL"===a.original.CTRCODE&&(0,t.jsx)("button",{type:"button",title:"Open details",className:"text-blue-500 hover:text-blue-700",onClick:()=>e(a.original),children:(0,t.jsx)(A.A,{className:"h-4 w-4"})})]})}},{id:"ClosingBalance",header:"Closing Balance",cell:e=>{let{row:r}=e,a=r.original.ClosingBalance,s=a<0;return(0,t.jsx)("span",{style:{color:s?"red":"inherit"},children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(a)})}}],w=[{accessorKey:"SCRIP_SYMBOL",header:"Scrip Symbol",cell:e=>{let{row:r}=e;return r.original.SCRIP_SYMBOL}},{accessorKey:"open_QUANTITY",header:"Open Quantity",cell:e=>{let{row:r}=e;return r.original.open_QUANTITY}},{accessorKey:"Open_AMOUNT",header:"Open Amount",cell:e=>{let{row:r}=e;return r.original.Open_AMOUNT}},{accessorKey:"BUY_QUANTITY",header:"Buy Quantity",cell:e=>{let{row:r}=e;return r.original.BUY_QUANTITY}},{accessorKey:"BUY_RATE",header:"Buy Rate",cell:e=>{let{row:r}=e;return r.original.BUY_RATE}},{accessorKey:"BUY_AMOUNT",header:"Buy Amount",cell:e=>{let{row:r}=e;return r.original.BUY_AMOUNT}},{accessorKey:"SALE_QUANTITY",header:"Sale Quantity",cell:e=>{let{row:r}=e;return r.original.SALE_QUANTITY}},{accessorKey:"SALE_RATE",header:"Sale Rate",cell:e=>{let{row:r}=e;return r.original.SALE_RATE}},{accessorKey:"SALE_AMOUNT",header:"Sale Amount",cell:e=>{let{row:r}=e;return r.original.SALE_AMOUNT}},{accessorKey:"NET_QUANTITY",header:"Net Quantity",cell:e=>{let{row:r}=e;return r.original.NET_QUANTITY}},{accessorKey:"NET_RATE",header:"Net Rate",cell:e=>{let{row:r}=e;return r.original.NET_RATE}},{accessorKey:"NET_AMOUNT",header:"Net Amount",cell:e=>{let{row:r}=e;return r.original.NET_AMOUNT}}];var b=a(7081),E=a(1541),D=a(1344),R=a(6323),I=a(7328),C=a(532),O=a(1567);let M=C.bL,S=C.l9;C.Mz;let v=s.forwardRef((e,r)=>{let{className:a,align:s="center",sideOffset:l=4,...n}=e;return(0,t.jsx)(C.ZL,{children:(0,t.jsx)(C.UC,{ref:r,align:s,sideOffset:l,className:(0,O.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});v.displayName=C.UC.displayName;var _=a(8986);function F(){let[e,r]=(0,s.useState)(!1),[a,A]=(0,s.useState)(null),[C,O]=(0,s.useState)(!1),[F,B]=(0,s.useState)(null),[U,L]=(0,s.useState)([]),[Y,P]=(0,s.useState)([]),[k,K]=(0,s.useState)(!1),[G,z]=(0,s.useState)(!1),[Q,J]=(0,s.useState)(!1),V=async e=>{O(!0),J(!0);let r=(0,o.GP)(new Date(e.BILL_DATE),"dd/MM/yyyy");try{let a=await (0,R.oV)({toDate:r,mktType:e.MKT_TYPE,SETLNO:e.SETTLEMENT_NO});if(!(0,I.k)(a)){K(!0);return}let t=JSON.parse(a.data.data);if("True"===t.Success&&t["Success Description"])L(t["Success Description"]);else throw Error(t["Error Description"]||"Failed to fetch ledger data.")}catch(e){B(e.message||"An error occurred while fetching data.")}finally{O(!1)}},{fromDate:q,toDate:H}=(()=>{let e=new Date,r=e.getUTCFullYear(),a=3>e.getUTCMonth()?new Date(r-1,3,1):new Date(r,3,1),t=new Date(a.getUTCFullYear()+1,2,31);return{fromDate:(0,o.GP)(a,"yyyy-MM-dd"),toDate:(0,o.GP)(t,"yyyy-MM-dd")}})(),X=u.Ik({fromDate:u.Yj().nonempty("From Date is required"),toDate:u.Yj().nonempty("To Date is required")}),Z=(0,m.mN)({resolver:(0,h.u)(X),defaultValues:{fromDate:q,toDate:H}}),$=async(e,a)=>{r(!0);try{let r=await (0,R.j3)({fromDate:(0,o.GP)((0,d.qg)(e,"yyyy-MM-dd",new Date),"dd/MM/yyyy"),toDate:(0,o.GP)((0,d.qg)(a,"yyyy-MM-dd",new Date),"dd/MM/yyyy")});if(!(0,I.k)(r)){K(!0);return}let t=JSON.parse(r.data.data);if("True"===t.Success&&t["Success Description"])P(t["Success Description"]);else throw Error(t["Error Description"]||"Failed to fetch ledger data.")}catch(e){A(e.message||"An error occurred while fetching data.")}finally{r(!1)}};(0,s.useEffect)(()=>{$(q,H)},[q,H]);let W=(0,s.useMemo)(()=>U.filter(e=>"EXPENSES"===e.company_code||"BROKERAGE"===e.company_code),[U]),ee=(0,s.useMemo)(()=>{let e=[],r={transactionCharges:0,gst:0};return W.forEach(a=>{let t=Math.abs(Number(a.NET_AMOUNT));switch(a.SCRIPDATACOL){case"ACCOUNT732":e.push({label:"SEBI FEES",amount:t});break;case"BRK":e.push({label:"Brokerage",amount:t});break;case"DEF4NSE":case"DEF4BSE":r.transactionCharges+=t;break;case"CGST":case"SGST":r.gst+=t;break;default:e.push({label:a.SCRIPDATACOL,amount:t})}}),r.transactionCharges>0&&e.push({label:"Transaction Charges",amount:r.transactionCharges}),r.gst>0&&e.push({label:"GST",amount:r.gst}),e},[W]);console.log(W);let er=(0,s.useMemo)(()=>U.filter(e=>"EXPENSES"!==e.company_code&&"BROKERAGE"!==e.company_code),[U]),ea=(0,s.useMemo)(()=>Y.filter(e=>"OPENING BALANCE"===e.NARRATION),[Y]),et=(0,s.useMemo)(()=>Y.filter(e=>"OPENING BALANCE"!==e.NARRATION&&"ASSOCIATE OPENING BALANCE"!==e.NARRATION),[Y]),es=(0,s.useMemo)(()=>ea.reduce((e,r)=>e+(r.CR_AMT-r.DR_AMT),0),[ea]),el=(0,s.useMemo)(()=>ea.reduce((e,r)=>e+(r.CR_AMT-r.DR_AMT),0),[ea]),en=(0,s.useMemo)(()=>{let e=el;return et.map(r=>{let a=r.CR_AMT-r.DR_AMT,t=e+a,s={...r,OpeningBalance:e,Amount:a,ClosingBalance:t};return e=t,s})},[et,el]),ec=(0,s.useMemo)(()=>Q?W.reduce((e,r)=>e+(Number(r.NOT_PROFIT)||0),0):0,[Q,W]),ei=(0,s.useMemo)(()=>Q?er.reduce((e,r)=>e+parseFloat(r.NET_AMOUNT||0),0):0,[Q,er]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.A,{children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)(N.Zp,{children:[(0,t.jsxs)(N.aR,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(N.ZB,{children:"Ledger Book"})}),(0,t.jsx)("div",{className:"flex-shrink-0 m-0",children:(0,t.jsx)(y.lV,{...Z,children:(0,t.jsxs)("form",{onSubmit:Z.handleSubmit(e=>{$(e.fromDate,e.toDate)}),className:"flex flex-col sm:flex-row sm:gap-3 items-center w-full",children:[(0,t.jsx)(y.zB,{control:Z.control,name:"fromDate",render:e=>{let{field:r}=e;return(0,t.jsxs)(y.eI,{className:"space-y-0 w-full sm:w-auto",children:[(0,t.jsx)(_.J,{htmlFor:"fromDate",className:"sr-only",children:"From Date"}),(0,t.jsx)(y.MJ,{children:(0,t.jsx)(g.p,{type:"date",id:"fromDate",className:"h-10 rounded-md border text-white bg-transparent px-3 py-2 text-sm w-full sm:w-auto",...r})}),(0,t.jsx)(y.C5,{})]})}}),(0,t.jsx)(y.zB,{control:Z.control,name:"toDate",render:e=>{let{field:r}=e;return(0,t.jsxs)(y.eI,{className:"space-y-0 w-full sm:w-auto",children:[(0,t.jsx)(_.J,{htmlFor:"toDate",className:"sr-only",children:"To Date"}),(0,t.jsx)(y.MJ,{children:(0,t.jsx)(g.p,{type:"date",id:"toDate",className:"h-10 rounded-md border text-white bg-transparent px-3 py-2 text-sm w-full sm:w-auto",...r})}),(0,t.jsx)(y.C5,{})]})}}),(0,t.jsx)(x.$,{type:"submit",disabled:e,className:"mt-2 sm:mt-0",children:e?(0,t.jsx)(l.A,{className:"h-5 w-5"}):(0,t.jsx)(n.A,{className:"h-5 w-5"})})]})})})]}),(0,t.jsxs)(N.Wu,{children:[e?(0,t.jsx)(b.E,{className:"h-8 w-full"}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex justify-center items-center gap-6 m-2",children:[(0,t.jsx)("span",{className:"font-[400]",children:"Opening Balance Total:"}),(0,t.jsx)("span",{className:"font-semibold",children:(0,t.jsx)(E.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2,minimumFractionDigits:2}).format(es)})}),(0,t.jsxs)(M,{children:[(0,t.jsx)(S,{asChild:!0,children:(0,t.jsx)(x.$,{variant:"ghost",size:"sm",children:G?(0,t.jsx)(c.A,{size:8}):(0,t.jsx)(i.A,{size:8})})}),(0,t.jsx)(v,{align:"center",side:"bottom",className:"w-[320px] p-4 bg-white shadow-lg border border-gray-200 rounded-lg",children:(0,t.jsx)("div",{className:"space-y-2",children:ea.map((e,r)=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-2",children:[(0,t.jsx)("span",{className:"text-sm ",children:e.COCD}),(0,t.jsx)("span",{className:"text-sm ",children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e.CR_AMT-e.DR_AMT)})]},r))})})]})]})}),e?(0,t.jsx)(j.A,{columns:4,rows:10}):a?(0,t.jsx)("h3",{children:a}):(0,t.jsx)(p.b,{columns:T(V),data:en,filterColumn:"NARRATION",filterPlaceholder:"Filter Narration...",showAllRows:!0})]})]})})}),(0,t.jsx)(D.lG,{open:Q,onOpenChange:J,children:(0,t.jsxs)(D.Cf,{className:"max-h-[80vh] max-w-[70%] overflow-y-auto",children:[(0,t.jsxs)(D.c7,{children:[(0,t.jsx)(D.L3,{children:"Bill Data Amount"}),(0,t.jsx)(D.rr,{children:"Details related to Bill Amount."})]}),C?(0,t.jsx)(j.A,{columns:4,rows:5}):F?(0,t.jsx)("h3",{children:a}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-row justify-center gap-10 items-center",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,t.jsx)("span",{className:"font-semibold text-lg text-card-foreground",children:"Total Amount:"}),(0,t.jsx)("span",{className:"text-card-foreground ".concat(ei>=0?"text-green-600":"text-red-600"),children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(ei)})]}),(0,t.jsxs)("div",{className:"flex justify-center items-center gap-6 m-2",children:[(0,t.jsx)("span",{className:"font-semibold text-lg text-card-foreground",children:"Expense Details:"}),(0,t.jsx)("span",{className:"font-semibold ".concat(ec>=0?"text-green-600":"text-red-400"),children:(0,t.jsx)(E.A,{animateOn:"view",revealDirection:"center",characters:"12345678",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2,minimumFractionDigits:2}).format(ec)})}),(0,t.jsxs)(M,{children:[ee.length>0&&(0,t.jsx)(S,{asChild:!0,children:(0,t.jsx)(x.$,{variant:"ghost",size:"sm",children:G?(0,t.jsx)(c.A,{size:8}):(0,t.jsx)(i.A,{size:8})})}),ee.length>0&&(0,t.jsx)(v,{align:"center",side:"bottom",className:"w-[320px] p-4 bg-white shadow-lg border border-gray-200 rounded-lg",children:(0,t.jsx)("div",{className:"space-y-2",children:ee.map((e,r)=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-2",children:[(0,t.jsx)("span",{className:"text-sm",children:e.label}),(0,t.jsxs)("span",{className:"text-sm",children:[new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e.amount||0)," "]})]},r))})})]})]})]}),(0,t.jsx)(p.b,{columns:w,data:er,showAllRows:!0})]})]})}),k&&(0,t.jsx)(I.B,{})]})}},5147:(e,r,a)=>{"use strict";a.d(r,{A:()=>l});var t=a(5155);a(2115);var s=a(7081);let l=e=>{let{columns:r,rows:a}=e;return(0,t.jsxs)("div",{className:"w-full p-4 space-y-4",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(r||4)].map((e,r)=>(0,t.jsx)("div",{className:"h-9 rounded-lg bg-gray-100 dark:bg-gray-800",children:(0,t.jsx)(s.E,{className:"w-full h-full"})},"header-".concat(r)))}),(0,t.jsx)("div",{className:"space-y-2",children:[...Array(a||10)].map((e,a)=>(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(r||4)].map((e,r)=>(0,t.jsx)("div",{className:"h-12 rounded-lg bg-gray-100 dark:bg-gray-800",children:(0,t.jsx)(s.E,{className:"w-full h-full"})},"cell-".concat(a,"-").concat(r)))},"row-".concat(a)))})]})}},4870:(e,r,a)=>{"use strict";a.d(r,{C5:()=>g,MJ:()=>y,eI:()=>x,lR:()=>N,lV:()=>o,zB:()=>m});var t=a(5155),s=a(2115),l=a(2317),n=a(9606),c=a(1567),i=a(8986);let o=n.Op,d=s.createContext({}),m=e=>{let{...r}=e;return(0,t.jsx)(d.Provider,{value:{name:r.name},children:(0,t.jsx)(n.xI,{...r})})},u=()=>{let e=s.useContext(d),r=s.useContext(h),{getFieldState:a,formState:t}=(0,n.xW)(),l=a(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:c}=r;return{id:c,name:e.name,formItemId:"".concat(c,"-form-item"),formDescriptionId:"".concat(c,"-form-item-description"),formMessageId:"".concat(c,"-form-item-message"),...l}},h=s.createContext({}),x=s.forwardRef((e,r)=>{let{className:a,...l}=e,n=s.useId();return(0,t.jsx)(h.Provider,{value:{id:n},children:(0,t.jsx)("div",{ref:r,className:(0,c.cn)("space-y-2",a),...l})})});x.displayName="FormItem";let N=s.forwardRef((e,r)=>{let{className:a,...s}=e,{error:l,formItemId:n}=u();return(0,t.jsx)(i.J,{ref:r,className:(0,c.cn)(l&&"text-destructive",a),htmlFor:n,...s})});N.displayName="FormLabel";let y=s.forwardRef((e,r)=>{let{...a}=e,{error:s,formItemId:n,formDescriptionId:c,formMessageId:i}=u();return(0,t.jsx)(l.DX,{ref:r,id:n,"aria-describedby":s?"".concat(c," ").concat(i):"".concat(c),"aria-invalid":!!s,...a})});y.displayName="FormControl",s.forwardRef((e,r)=>{let{className:a,...s}=e,{formDescriptionId:l}=u();return(0,t.jsx)("p",{ref:r,id:l,className:(0,c.cn)("text-[0.8rem] text-muted-foreground",a),...s})}).displayName="FormDescription";let g=s.forwardRef((e,r)=>{let{className:a,children:s,...l}=e,{error:n,formMessageId:i}=u(),o=n?String(null==n?void 0:n.message):s;return o?(0,t.jsx)("p",{ref:r,id:i,className:(0,c.cn)("text-[0.8rem] font-medium text-destructive",a),...l,children:o}):null});g.displayName="FormMessage"},8986:(e,r,a)=>{"use strict";a.d(r,{J:()=>o});var t=a(5155),s=a(2115),l=a(6195),n=a(1027),c=a(1567);let i=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=s.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(l.b,{ref:r,className:(0,c.cn)(i(),a),...s})});o.displayName=l.b.displayName}},e=>{var r=r=>e(e.s=r);e.O(0,[247,814,794,518,440,825,137,802,272,139,282,491,441,517,358],()=>r(8832)),_N_E=e.O()}]);
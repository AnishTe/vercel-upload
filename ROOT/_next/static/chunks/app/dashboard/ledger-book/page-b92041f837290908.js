(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{8832:(e,r,t)=>{Promise.resolve().then(t.bind(t,8209))},8209:(e,r,t)=>{"use strict";t.d(r,{default:()=>F});var a=t(5155),s=t(2115),l=t(7594),n=t(853),i=t(1902),c=t(1719),o=t(960),d=t(830),m=t(9606),u=t(3415),x=t(2679),N=t(3312),h=t(9749),y=t(4870),f=t(3900),p=t(3404),g=t(9063),j=t(5147),A=t(5765);let w=e=>[{id:"COCD",accessorKey:"COCD",header:"COCD"},{id:"VOUCHERDATE",accessorKey:"VOUCHERDATE",header:"Date",cell:e=>{let{row:r}=e,t=new Date(r.original.VOUCHERDATE);return(0,a.jsx)("span",{className:"truncate ",children:t.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"2-digit"})})}},{id:"NARRATION",accessorKey:"NARRATION",header:"Narration",cell:e=>{let{row:r}=e;return(0,a.jsx)("div",{className:"max-w-[500px] min-w-[200px] whitespace-normal break-words",title:r.original.NARRATION,children:r.original.NARRATION})}},{id:"OpeningBalance",header:"Opening Balance",cell:e=>{let{row:r}=e;return(0,a.jsx)("span",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(r.original.OpeningBalance)})}},{id:"Amount",header:"Amount",cell:r=>{let{row:t}=r;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(t.original.Amount)}),"BILL"===t.original.CTRCODE&&(0,a.jsx)("button",{type:"button",title:"Open details",className:"text-blue-500 hover:text-blue-700",onClick:()=>e(t.original),children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})]})}},{id:"ClosingBalance",header:"Closing Balance",cell:e=>{let{row:r}=e,t=r.original.ClosingBalance,s=t<0;return(0,a.jsx)("span",{style:{color:s?"red":"inherit"},children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(t)})}}],T=[{accessorKey:"SCRIP_SYMBOL",header:"Scrip Symbol",cell:e=>{let{row:r}=e;return r.original.SCRIP_SYMBOL}},{accessorKey:"open_QUANTITY",header:"Open Quantity",cell:e=>{let{row:r}=e;return r.original.open_QUANTITY}},{accessorKey:"Open_AMOUNT",header:"Open Amount",cell:e=>{let{row:r}=e;return r.original.Open_AMOUNT}},{accessorKey:"BUY_QUANTITY",header:"Buy Quantity",cell:e=>{let{row:r}=e;return r.original.BUY_QUANTITY}},{accessorKey:"BUY_RATE",header:"Buy Rate",cell:e=>{let{row:r}=e;return r.original.BUY_RATE}},{accessorKey:"BUY_AMOUNT",header:"Buy Amount",cell:e=>{let{row:r}=e;return r.original.BUY_AMOUNT}},{accessorKey:"SALE_QUANTITY",header:"Sale Quantity",cell:e=>{let{row:r}=e;return r.original.SALE_QUANTITY}},{accessorKey:"SALE_RATE",header:"Sale Rate",cell:e=>{let{row:r}=e;return r.original.SALE_RATE}},{accessorKey:"SALE_AMOUNT",header:"Sale Amount",cell:e=>{let{row:r}=e;return r.original.SALE_AMOUNT}},{accessorKey:"NET_QUANTITY",header:"Net Quantity",cell:e=>{let{row:r}=e;return r.original.NET_QUANTITY}},{accessorKey:"NET_RATE",header:"Net Rate",cell:e=>{let{row:r}=e;return r.original.NET_RATE}},{accessorKey:"NET_AMOUNT",header:"Net Amount",cell:e=>{let{row:r}=e;return r.original.NET_AMOUNT}}];var D=t(7081),R=t(1541),E=t(1344),b=t(6323),I=t(7328),O=t(532),M=t(1567);let C=O.bL,v=O.l9;O.Mz;let _=s.forwardRef((e,r)=>{let{className:t,align:s="center",sideOffset:l=4,...n}=e;return(0,a.jsx)(O.ZL,{children:(0,a.jsx)(O.UC,{ref:r,align:s,sideOffset:l,className:(0,M.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});_.displayName=O.UC.displayName;var S=t(8986);function F(){let[e,r]=(0,s.useState)(!1),[t,A]=(0,s.useState)(null),[O,M]=(0,s.useState)(!1),[F,B]=(0,s.useState)(null),[U,L]=(0,s.useState)([]),[Y,P]=(0,s.useState)([]),[K,k]=(0,s.useState)(!1),[z,Q]=(0,s.useState)(!1),[G,J]=(0,s.useState)(!1),V=async e=>{M(!0),J(!0);let r=(0,o.GP)(new Date(e.BILL_DATE),"dd/MM/yyyy");try{let t=await (0,b.oV)({toDate:r,mktType:e.MKT_TYPE,SETLNO:e.SETTLEMENT_NO});if(!(0,I.k)(t)){k(!0);return}let a=JSON.parse(t.data.data);if("True"===a.Success&&a["Success Description"])L(a["Success Description"]);else throw Error(a["Error Description"]||"Failed to fetch ledger data.")}catch(e){B(e.message||"An error occurred while fetching data.")}finally{M(!1)}},{fromDate:q,toDate:H}=(()=>{let e=new Date,r=e.getUTCFullYear(),t=3>e.getUTCMonth()?new Date(r-1,3,1):new Date(r,3,1),a=new Date(t.getUTCFullYear()+1,2,31);return{fromDate:(0,o.GP)(t,"yyyy-MM-dd"),toDate:(0,o.GP)(a,"yyyy-MM-dd")}})(),X=u.Ik({fromDate:u.Yj().nonempty("From Date is required"),toDate:u.Yj().nonempty("To Date is required")}),Z=(0,m.mN)({resolver:(0,x.u)(X),defaultValues:{fromDate:q,toDate:H}}),$=async(e,t)=>{r(!0);try{let r=await (0,b.j3)({fromDate:(0,o.GP)((0,d.qg)(e,"yyyy-MM-dd",new Date),"dd/MM/yyyy"),toDate:(0,o.GP)((0,d.qg)(t,"yyyy-MM-dd",new Date),"dd/MM/yyyy")});if(!(0,I.k)(r)){k(!0);return}let a=JSON.parse(r.data.data);if("True"===a.Success&&a["Success Description"])P(a["Success Description"]);else throw Error(a["Error Description"]||"Failed to fetch ledger data.")}catch(e){A(e.message||"An error occurred while fetching data.")}finally{r(!1)}};(0,s.useEffect)(()=>{$(q,H)},[q,H]);let W=(0,s.useMemo)(()=>U.filter(e=>"EXPENSES"===e.company_code||"BROKERAGE"===e.company_code),[U]),ee=(0,s.useMemo)(()=>U.filter(e=>"EXPENSES"!==e.company_code&&"BROKERAGE"!==e.company_code),[U]),er=(0,s.useMemo)(()=>Y.filter(e=>"OPENING BALANCE"===e.NARRATION),[Y]),et=(0,s.useMemo)(()=>Y.filter(e=>"OPENING BALANCE"!==e.NARRATION&&"ASSOCIATE OPENING BALANCE"!==e.NARRATION),[Y]),ea=(0,s.useMemo)(()=>er.reduce((e,r)=>e+(r.CR_AMT-r.DR_AMT),0),[er]),es=(0,s.useMemo)(()=>er.reduce((e,r)=>e+(r.CR_AMT-r.DR_AMT),0),[er]),el=(0,s.useMemo)(()=>{let e=es;return et.map(r=>{let t=r.CR_AMT-r.DR_AMT,a=e+t,s={...r,OpeningBalance:e,Amount:t,ClosingBalance:a};return e=a,s})},[et,es]),en=(0,s.useMemo)(()=>G?W.reduce((e,r)=>e+r.NOT_PROFIT||0,0):0,[G,W]),ei=(0,s.useMemo)(()=>G?ee.reduce((e,r)=>e+parseFloat(r.NET_AMOUNT||0),0):0,[G,ee]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.A,{children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)(h.Zp,{children:[(0,a.jsxs)(h.aR,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(h.ZB,{children:"Ledger Book"})}),(0,a.jsx)("div",{className:"flex-shrink-0 m-0",children:(0,a.jsx)(y.lV,{...Z,children:(0,a.jsxs)("form",{onSubmit:Z.handleSubmit(e=>{$(e.fromDate,e.toDate)}),className:"flex flex-col sm:flex-row sm:gap-3 items-center w-full",children:[(0,a.jsx)(y.zB,{control:Z.control,name:"fromDate",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.eI,{className:"space-y-0 w-full sm:w-auto",children:[(0,a.jsx)(S.J,{htmlFor:"fromDate",className:"sr-only",children:"From Date"}),(0,a.jsx)(y.MJ,{children:(0,a.jsx)(f.p,{type:"date",id:"fromDate",className:"h-10 rounded-md border text-white bg-transparent px-3 py-2 text-sm w-full sm:w-auto",...r})}),(0,a.jsx)(y.C5,{})]})}}),(0,a.jsx)(y.zB,{control:Z.control,name:"toDate",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.eI,{className:"space-y-0 w-full sm:w-auto",children:[(0,a.jsx)(S.J,{htmlFor:"toDate",className:"sr-only",children:"To Date"}),(0,a.jsx)(y.MJ,{children:(0,a.jsx)(f.p,{type:"date",id:"toDate",className:"h-10 rounded-md border text-white bg-transparent px-3 py-2 text-sm w-full sm:w-auto",...r})}),(0,a.jsx)(y.C5,{})]})}}),(0,a.jsx)(N.$,{type:"submit",disabled:e,className:"mt-2 sm:mt-0",children:e?(0,a.jsx)(l.A,{className:"h-5 w-5"}):(0,a.jsx)(n.A,{className:"h-5 w-5"})})]})})})]}),(0,a.jsxs)(h.Wu,{children:[e?(0,a.jsx)(D.E,{className:"h-8 w-full"}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex justify-center items-center gap-6 m-2",children:[(0,a.jsx)("span",{className:"font-[400]",children:"Opening Balance Total:"}),(0,a.jsx)("span",{className:"font-semibold",children:(0,a.jsx)(R.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2,minimumFractionDigits:2}).format(ea)})}),(0,a.jsxs)(C,{children:[(0,a.jsx)(v,{asChild:!0,children:(0,a.jsx)(N.$,{variant:"ghost",size:"sm",children:z?(0,a.jsx)(i.A,{size:8}):(0,a.jsx)(c.A,{size:8})})}),(0,a.jsx)(_,{align:"center",side:"bottom",className:"w-[320px] p-4 bg-white shadow-lg border border-gray-200 rounded-lg",children:(0,a.jsx)("div",{className:"space-y-2",children:er.map((e,r)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2",children:[(0,a.jsx)("span",{className:"text-sm ",children:e.COCD}),(0,a.jsx)("span",{className:"text-sm ",children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e.CR_AMT-e.DR_AMT)})]},r))})})]})]})}),e?(0,a.jsx)(j.A,{columns:4,rows:10}):t?(0,a.jsx)("h3",{children:t}):(0,a.jsx)(p.b,{columns:w(V),data:el,filterColumn:"NARRATION",filterPlaceholder:"Filter Narration...",showAllRows:!0})]})]})})}),(0,a.jsx)(E.lG,{open:G,onOpenChange:J,children:(0,a.jsxs)(E.Cf,{className:"max-h-[80vh] max-w-[70%] overflow-y-auto",children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsx)(E.L3,{children:"Bill Data Amount"}),(0,a.jsx)(E.rr,{children:"Details related to Bill Amount."})]}),O?(0,a.jsx)(j.A,{columns:4,rows:5}):F?(0,a.jsx)("h3",{children:t}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-row justify-center gap-10 items-center",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,a.jsx)("span",{className:"font-semibold text-lg text-card-foreground",children:"Total Amount:"}),(0,a.jsx)("span",{className:"text-card-foreground ".concat(ei>=0?"text-green-600":"text-red-600"),children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(ei)})]}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-6 m-2",children:[(0,a.jsx)("span",{className:"font-semibold text-lg text-card-foreground",children:"Expense Details:"}),(0,a.jsx)("span",{className:"font-semibold ".concat(en>=0?"text-green-600":"text-red-400"),children:(0,a.jsx)(R.A,{animateOn:"view",revealDirection:"center",characters:"12345678",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2,minimumFractionDigits:2}).format(en)})}),(0,a.jsxs)(C,{children:[(0,a.jsx)(v,{asChild:!0,children:(0,a.jsx)(N.$,{variant:"ghost",size:"sm",children:z?(0,a.jsx)(i.A,{size:8}):(0,a.jsx)(c.A,{size:8})})}),(0,a.jsx)(_,{align:"center",side:"bottom",className:"w-[320px] p-4 bg-white shadow-lg border border-gray-200 rounded-lg",children:(0,a.jsx)("div",{className:"space-y-2",children:W.map((e,r)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2",children:[(0,a.jsx)("span",{className:"text-sm ",children:e.SCRIPDATACOL}),(0,a.jsx)("span",{className:"text-sm",children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(Math.abs(Number(e.NET_AMOUNT)))})]},r))})})]})]})]}),(0,a.jsx)(p.b,{columns:T,data:ee,showAllRows:!0})]})]})}),K&&(0,a.jsx)(I.B,{})]})}},5147:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var a=t(5155);t(2115);var s=t(7081);let l=e=>{let{columns:r,rows:t}=e;return(0,a.jsxs)("div",{className:"w-full p-4 space-y-4",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(r||4)].map((e,r)=>(0,a.jsx)("div",{className:"h-9 rounded-lg bg-gray-100 dark:bg-gray-800",children:(0,a.jsx)(s.E,{className:"w-full h-full"})},"header-".concat(r)))}),(0,a.jsx)("div",{className:"space-y-2",children:[...Array(t||10)].map((e,t)=>(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(r||4)].map((e,r)=>(0,a.jsx)("div",{className:"h-12 rounded-lg bg-gray-100 dark:bg-gray-800",children:(0,a.jsx)(s.E,{className:"w-full h-full"})},"cell-".concat(t,"-").concat(r)))},"row-".concat(t)))})]})}},4870:(e,r,t)=>{"use strict";t.d(r,{C5:()=>f,MJ:()=>y,eI:()=>N,lR:()=>h,lV:()=>o,zB:()=>m});var a=t(5155),s=t(2115),l=t(2317),n=t(9606),i=t(1567),c=t(8986);let o=n.Op,d=s.createContext({}),m=e=>{let{...r}=e;return(0,a.jsx)(d.Provider,{value:{name:r.name},children:(0,a.jsx)(n.xI,{...r})})},u=()=>{let e=s.useContext(d),r=s.useContext(x),{getFieldState:t,formState:a}=(0,n.xW)(),l=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...l}},x=s.createContext({}),N=s.forwardRef((e,r)=>{let{className:t,...l}=e,n=s.useId();return(0,a.jsx)(x.Provider,{value:{id:n},children:(0,a.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",t),...l})})});N.displayName="FormItem";let h=s.forwardRef((e,r)=>{let{className:t,...s}=e,{error:l,formItemId:n}=u();return(0,a.jsx)(c.J,{ref:r,className:(0,i.cn)(l&&"text-destructive",t),htmlFor:n,...s})});h.displayName="FormLabel";let y=s.forwardRef((e,r)=>{let{...t}=e,{error:s,formItemId:n,formDescriptionId:i,formMessageId:c}=u();return(0,a.jsx)(l.DX,{ref:r,id:n,"aria-describedby":s?"".concat(i," ").concat(c):"".concat(i),"aria-invalid":!!s,...t})});y.displayName="FormControl",s.forwardRef((e,r)=>{let{className:t,...s}=e,{formDescriptionId:l}=u();return(0,a.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-[0.8rem] text-muted-foreground",t),...s})}).displayName="FormDescription";let f=s.forwardRef((e,r)=>{let{className:t,children:s,...l}=e,{error:n,formMessageId:c}=u(),o=n?String(null==n?void 0:n.message):s;return o?(0,a.jsx)("p",{ref:r,id:c,className:(0,i.cn)("text-[0.8rem] font-medium text-destructive",t),...l,children:o}):null});f.displayName="FormMessage"},8986:(e,r,t)=>{"use strict";t.d(r,{J:()=>o});var a=t(5155),s=t(2115),l=t(6195),n=t(1027),i=t(1567);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(l.b,{ref:r,className:(0,i.cn)(c(),t),...s})});o.displayName=l.b.displayName}},e=>{var r=r=>e(e.s=r);e.O(0,[247,814,794,518,440,825,137,802,272,139,282,491,441,517,358],()=>r(8832)),_N_E=e.O()}]);
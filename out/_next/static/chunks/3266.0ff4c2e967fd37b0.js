(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3266],{3266:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>I});var a=l(95155),o=l(12115),n=l(43932),r=l.n(n);l(8769),l(81956),l(4469),l(5921),l(60420),l(57091),l(26618),l(95198),l(27071),l(54119);var s=l(73312),i=l(33900),c=l(57485),d=l(94831),u=l(89095),p=l(20853),h=l(40767),m=l(84267),g=l(92598),f=l(51719),b=l(98867),y=l(44857),x=l(97307),C=l(45687),S=l(5565),w=l(76046),v=l(92340),E=l.n(v),A=l(10142),F=l(79254),N=l.n(F),T=l(38003),R=l(97555);let I=e=>{let{columns:t,data:l,showAllRows:n=!1,year:v,fromDate:F,toDate:I,selectableRows:k,totalDataSummary:j,expensesData:L,showPagination:D=!0,columnSearch:z=!1,ref:O,downloadFileName:P="data",onAddPortfolio:B,columnsWithTotals:_,downloadPDF:M=!0,downloadExcel:U=!0,downloadCSV:W=!0}=e,K=(0,o.useRef)(null),[G,Y]=o.useState({}),{userDetails:H,currentUser:V}=(0,x.J)(),[X,Z]=(0,o.useState)({userDetails:null,currentUser:null}),[$,q]=(0,o.useState)(""),Q=(0,o.useRef)(!1),J=(0,w.useSearchParams)(),ee=(0,o.useRef)(null);(0,o.useImperativeHandle)(O,()=>ee.current);let[et,el]=(0,o.useState)(!1),ea=(0,o.useMemo)(()=>l,[l]),eo=(0,o.useMemo)(()=>t,[t]),{state:en}=(0,R.cL)();(0,o.useEffect)(()=>{let e=J.get("clientId"),t=J.get("branchClientCheck"),l=J.get("familyClientCheck");Z(a=>{let o=null,n="";if(e&&(t?n="branchClientCheck_".concat(e):l&&(n="familyClientCheck_".concat(e)),n)){let t=sessionStorage.getItem(n);return(o=t?JSON.parse(t):null,a.userDetails!==o||a.currentUser!==e)?{userDetails:o,currentUser:e}:a}return a.userDetails!==H||a.currentUser!==V?{userDetails:H,currentUser:V}:a})},[J,H,V]),(0,o.useEffect)(()=>{let e=ee.current;if(!e)return;let t=()=>{let t=r()(e.table().body());try{t.unmark({done:()=>{$&&t.mark($)}})}catch(e){console.error("Mark.js highlight error:",e)}};return e.on("draw.dt",t),()=>{e.off("draw.dt",t)}},[$]);let er=(0,o.useMemo)(()=>ea&&"object"==typeof ea?Object.entries(ea).map(e=>{let[t,l]=e;return{category:t,sum:l.sum,rows:l.rows}}):[],[ea]),es=(0,o.useMemo)(()=>er.flatMap(e=>e.rows.map(t=>({...t,category:e.category}))),[er]);(0,o.useEffect)(()=>{if(!ee.current)return;let e=r()(null==ee?void 0:ee.current).DataTable();ee.current&&(setTimeout(()=>{var t;(null===(t=ee.current.columns)||void 0===t?void 0:t.adjust)&&ee.current.columns.adjust(),e.responsive.recalc(),e.draw(!1)},200),setTimeout(()=>{e.columns().every(function(){r()(this.header()).css({"min-width":"100px","max-width":"100px",width:"auto"})}),ee.current.columns.adjust().responsive.recalc().draw(!1)},300))},[en]);let ei=(0,o.useCallback)((e,t,l,a)=>{let o=r()(l.node()).find(".dtr-control");a?o.addClass("expanded"):o.removeClass("expanded")},[]);(0,o.useEffect)(()=>{if(K.current)return r()(K.current).on("responsive-display",ei),()=>{K.current&&r()(K.current).off("responsive-display",ei)}},[ei]),(0,o.useEffect)(()=>{if(K.current&&!Q.current&&K.current&&r().fn.DataTable()){let e=r()(K.current).DataTable({data:es,columns:[{data:null,defaultContent:"",className:"dtr-control",orderable:!1},...t.map(e=>{var t;return{data:e.accessorKey,title:e.header,visible:!e.hidden&&!e.deselected,name:e.accessorKey,orderable:!1!==e.sortable,width:null!==(t=e.width)&&void 0!==t?t:void 0,render:(t,l,a,n)=>{if("function"==typeof e.dtRender)return e.dtRender(t,l,a,n);if(e.cell&&"function"==typeof e.cell){let t=e.cell({row:a});return o.isValidElement(t)?C.renderToString(t):t}return t}}})],responsive:{details:{type:"column",target:k?1:0,renderer:(e,t,l)=>{let a=Array.isArray(l)?l.filter(e=>e.hidden&&0!==e.columnIndex):[];if(0===a.length)return!1;let o=document.createElement("ul");o.className="dtr-details",o.addEventListener("click",e=>{e.target.closest("button")||e.stopPropagation()});let n=document.createElement("li");return n.className="dtr-details-header",n.innerHTML='<div class="expand-hint"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" class="lucide lucide-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg> <span>Expanded Details</span></div>',o.appendChild(n),a.forEach(e=>{let t=document.createElement("li");t.className="dt-head-custom dt-body-custom";let l=document.createElement("span");l.className="dtr-title",l.textContent=e.title+":";let a=document.createElement("span");a.className="dtr-data",a.innerHTML=e.data,t.appendChild(l),t.appendChild(a),o.appendChild(t)}),o}},breakpoints:[{name:"desktop",width:Number.POSITIVE_INFINITY},{name:"tablet",width:1024},{name:"mobile",width:640}]},columnDefs:[{className:"dtr-control",orderable:!1,targets:0},{targets:"_all",className:"dt-head-custom dt-body-custom",orderable:!0},...t.map((e,t)=>({targets:t+1,orderable:!1!==e.sortable})),{responsivePriority:1,targets:[0,1]},{responsivePriority:2,targets:t.map((e,t)=>t+1).filter(e=>{let l=t[e-1];return l&&("id"===l.accessorKey||"name"===l.accessorKey||"date"===l.accessorKey)})},{responsivePriority:1e4,targets:t.map((e,t)=>t+1).filter(e=>{let l=t[e-1];return l&&("description"===l.accessorKey||"details"===l.accessorKey)})}],dom:'<"datatable-container"t><"datatable-footer"<"datatable-info"i><"datatable-pagination"p>>',buttons:[{extend:"pdfHtml5",text:"Export PDF",title:"DataTable Export",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible"}}],deferRender:!0,destroy:!0,scrollX:!0,autoWidth:!1,order:[],scrollY:D?"800px":"500px",scrollCollapse:!0,pageLength:n?es.length:10,ordering:!0,paging:!0,scroller:!0,info:D,stripeClasses:[],stateDuration:-1,retrieve:!0,search:!1,lengthChange:!1,searching:!0,rowCallback:(e,t,l)=>{r()(e).css({"line-height":"1.2","font-size":"0.75rem"})},initComplete:function(){let e=this.api();z&&e.columns().every(t=>{let l;if(0===t||k&&1===t)return;let a=e.column(t),o=r()(a.header()).text().trim(),n=r()('<div class="column-search-wrapper"></div>'),s=r()('<input type="text" class="column-search" placeholder="Search '+o+'" />');s.attr("aria-label","Search ".concat(o)),s.attr("role","searchbox"),r()(n).append(s),r()(a.header()).append(n),r()(s).on("keyup change",function(e){e.stopPropagation(),clearTimeout(l);let t=r()(this).val();l=setTimeout(()=>{a.search()!==t&&a.search(t).draw()},300)}),s.on("click",e=>{e.stopPropagation()})}),r()(".dataTables_filter").hide();let t=r()(".datatable-pagination");e.on("draw",()=>{let l=e.page.info(),a=l.pages,o=l.page,n=Math.max(0,o-2),s=Math.min(a-1,n+4);s-n<4&&n>0&&(n=Math.max(0,s-4));let i="";for(let e=n;e<=s;e++)i+='\n                                <button class="pagination-button page-number '.concat(e===o?"active":"",'" \n                                        data-page="').concat(e,'">\n                                ').concat(e+1,"\n                                </button>\n                            ");let c='\n                            <div class="custom-pagination">\n                                <button class="pagination-button first-page '.concat(0===l.page?"disabled":"",'" \n                                        ').concat(0===l.page?"disabled":"",'>\n                                <span>\xab</span>\n                                </button>\n                                <button class="pagination-button previous-page ').concat(0===l.page?"disabled":"",'"\n                                        ').concat(0===l.page?"disabled":"",'>\n                                <span>‹</span>\n                                </button>\n                                \n                                <div class="pagination-numbers">\n                                ').concat(i,'\n                                </div>\n                                \n                                <button class="pagination-button next-page ').concat(l.page===l.pages-1?"disabled":"",'"\n                                        ').concat(l.page===l.pages-1?"disabled":"",'>\n                                <span>›</span>\n                                </button>\n                                <button class="pagination-button last-page ').concat(l.page===l.pages-1?"disabled":"",'"\n                                        ').concat(l.page===l.pages-1?"disabled":"",">\n                                <span>\xbb</span>\n                                </button>\n                            </div>\n                            ");l.pages>1?t.html(c).show():t.hide(),t.find(".first-page").on("click",function(){r()(this).hasClass("disabled")||e.page("first").draw("page")}),t.find(".previous-page").on("click",function(){r()(this).hasClass("disabled")||e.page("previous").draw("page")}),t.find(".next-page").on("click",function(){r()(this).hasClass("disabled")||e.page("next").draw("page")}),t.find(".last-page").on("click",function(){r()(this).hasClass("disabled")||e.page("last").draw("page")}),t.find(".page-number").on("click",function(){let t=Number.parseInt(r()(this).data("page"));e.page(t).draw("page")})});let l=r()(".datatable-length"),a=r()('<select class="custom-length-select"></select>');[10,25,50,100].forEach(t=>{a.append('<option value="'.concat(t,'" ').concat(e.page.len()===t?"selected":"",">\n                            ").concat(t," entries\n                        </option>"))}),l.html('<div class="custom-length-container"><span>Show</span></div>'),l.find(".custom-length-container").append(a),l.find(".custom-length-container").append("<span>entries</span>"),a.on("change",function(){let t=r()(this).val();e.page.len(t).draw()});let o=r()(".datatable-info");e.on("draw",()=>{let t=e.page.info(),l='\n                            <div class="custom-info">\n                                <span>Showing '.concat(t.start+1," to ").concat(t.end," of ").concat(t.recordsDisplay," entries</span>\n                                ").concat(t.recordsDisplay!==t.recordsTotal?'<span class="filtered-info">(filtered from '.concat(t.recordsTotal," total entries)</span>"):"","\n                            </div>\n                        ");o.html(l)}),e.draw(),r()(K.current).find("td.dtr-control").empty(),r()(K.current).find("td.dtr-control"),e.on("responsive-display",(e,t,l,a)=>{let o=r()(l.node()).find("td.dtr-control");o.empty(),a?(o.addClass("expanded"),r()(l.node()).addClass("expanded-row")):(o.removeClass("expanded"),r()(l.node()).removeClass("expanded-row"))}),setTimeout(()=>{r()(".dtr-control").addClass("pulse-hint"),setTimeout(()=>{r()(".dtr-control").removeClass("pulse-hint")},5e3)},1e3)},drawCallback:function(e){let t=new(r()).fn.dataTable.Api(e),l=null;t.rows({page:"current"}).every(function(){let e=this.data();if(e.category!==l){var a;let o=t.columns().indexes().filter(e=>t.column(e).visible()),n=ec(e.category,(null===(a=er.find(t=>t.category===e.category))||void 0===a?void 0:a.sum)||0,o.length);r()(this.node()).before(n),l=e.category}}),r()(K.current).on("click",".add-portfolio-btn",function(){let e=JSON.parse(r()(this).attr("data-row")||"");null==B||B(e)})},footerCallback:function(e,t,l,a,o){let n=this.api();n.columns.adjust(),null==_||_.forEach(e=>{let t=n.columns().indexes().toArray().find(t=>n.column(t).dataSrc()===e);if(void 0===t)return;let l=n.column(t).footer();if(!l)return;let a=n.column(t,{search:"applied"}).data().reduce((e,t)=>("number"==typeof e?e:parseFloat(e)||0)+("number"==typeof t?t:parseFloat(t)||0),0),o=new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a),r=a>=0?"green":"red";l.innerHTML='<span style="color: '.concat(r,'; font-weight: bold;">').concat(o,"</span>")})}});ee.current=e,Q.current=!0;let l={};return t.forEach(e=>{l[e.accessorKey]=!e.hidden&&!e.deselected}),Y(l),r()(K.current).on("draw.dt",()=>{r()(".category-info").each(function(){let e=ed(r()(this).data("category"));r()(this).attr("title",e)})}),e.on("column-visibility.dt",(t,l,a,o)=>{let n=e.column(a).dataSrc();Y(e=>({...e,[n]:o}))}),r()("<style>").prop("type","text/css").html("\n                    \n              ".concat(D?"":"\n                    .dataTables_info, .dataTables_paginate, .dataTables_length {\n                        display: none !important;\n                    }\n                ","\n              \n               \n            ")).appendTo("head"),()=>{if(ee.current&&K.current)try{ee.current.columns().search("").draw(),r()(K.current).find("input.column-search").off("keyup change click"),r()(K.current).off("click",".add-portfolio-btn"),r()(K.current).off("draw.dt"),r()(K.current).off("responsive-display",ei),r()(K.current).off("column-visibility.dt"),r()(document).off("click","thead th #selectAllCheckbox"),r().fn.DataTable.isDataTable(K.current)&&(ee.current.destroy(),Q.current=!1)}catch(e){console.error("Error while destroying DataTable:",e)}}}},[t,es,n,er,D,ei]);let ec=(e,t,l)=>{let a="OP_ASSETS"===e?"OPENING ASSETS":e.toUpperCase(),o=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Math.abs(t)),n=t>=0?"Profit":"Loss";return'\n            <tr id="'.concat(e,'" class="category-row">\n                <td colspan="').concat(l,'" class="text-center font-semibold py-2">\n                <div class="flex items-center justify-center gap-2">\n                    <div >').concat(a,'</div>  \n                    <span class="cursor-pointer category-info" data-category="').concat(e,'">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" class="lucide lucide-info"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>\n                    </span>\n                    (\n                    <span class="mx-1 ').concat(t>=0?"text-green-600":"text-red-600",'">\n                    ').concat("OP_ASSETS"===e||"ASSETS"===e?"Unrealized ".concat(n,": "):"LIABILITIES"===e?"LIABILITIES: ":"".concat(n,": "),"\n                    ").concat(o,"\n                    </span>\n                    )\n                </div>\n                </td>\n            </tr>\n            ")},ed=e=>{switch(e){case"OP_ASSETS":return"Holdings acquired before the beginning of the current financial year. These assets have been carried forward from previous periods and are part of the portfolio's opening balance.";case"ASSETS":return"Holdings purchased during the current financial year. These represent new acquisitions added to the portfolio after the start of the financial year.";case"SHORTTERM":return"The profit earned from selling assets held for a period of less than 12 months, subject to applicable short-term capital gains tax.";case"LONGTERM":return"The profit earned from selling assets held for a period of 12 months or more, typically eligible for preferential tax rates";case"LIABILITIES":return"Represents stocks that have been sold but lack corresponding buy trade records in the back-office system. This indicates a discrepancy requiring reconciliation to ensure accurate transaction history and financial reporting.";case"TRADING":return"Represents transactions where stocks are bought and sold on the same trading day. These trades are settled without carrying positions overnight and are typically considered for intraday profit or loss calculations.";default:return""}},eu=()=>t.filter(e=>G[e.accessorKey]),ep=e=>{let t=r()(K.current).DataTable(),l=t.columns().indexes().toArray().find(l=>t.column(l).dataSrc()===e);if(void 0!==l){let a=t.column(l),o=!a.visible();a.visible(o),Y(t=>({...t,[e]:o})),1!==Object.values(G).filter(Boolean).length||o||(alert("At least one column should be visible!"),a.visible(!0),Y(t=>({...t,[e]:!0}))),setTimeout(()=>{t.columns.adjust().responsive.recalc().draw(!1)},100)}};(0,o.useEffect)(()=>{ee.current&&ee.current.search($).draw()},[$]);let eh=()=>{setTimeout(()=>{r()(".dataTable").each(function(){let e=r()(this).DataTable();r().fn.dataTable.isDataTable(this)&&(e.columns.adjust().responsive.recalc(),e.draw(!1))}),r()(".dataTable").css("width","100%")},300)};return(0,o.useEffect)(()=>(window.addEventListener("resize",eh),()=>{window.removeEventListener("resize",eh)}),[]),(0,a.jsxs)("div",{className:"w-full mt-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 p-2 bg-muted rounded-lg border border-border shadow-sm sm:justify-between",children:[(0,a.jsxs)("div",{className:"relative flex items-center w-full sm:w-auto max-w-sm ",children:[(0,a.jsx)(p.A,{className:"absolute left-2 h-3 w-3 text-muted-foreground"}),(0,a.jsx)(i.p,{type:"search",className:"w-full pl-8 pr-10 h-9 rounded-md border bg-background text-xs focus:ring focus:ring-ring custom-search-input",placeholder:"Search all columns...",value:$,onChange:e=>{q(e.target.value)}}),$&&(0,a.jsx)(s.$,{size:"sm",variant:"ghost",className:"absolute right-1 hover:text-foreground hover:bg-transparent",onClick:()=>q(""),children:(0,a.jsx)(h.A,{className:"h-1 w-1 p-0 m-0"})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto sm:flex-row sm:gap-4",children:[z&&(0,a.jsxs)("button",{className:"px-3 py-2 flex items-center gap-2 rounded-md border border-border bg-background text-xs font-medium hover:bg-muted",onClick:()=>{ee.current&&(ee.current.columns().search("").draw(),r()(K.current).find(".column-search").each(function(){this.value="",this.setAttribute("value",""),r()(this).trigger("input"),r()(this).trigger("change"),r()(this).trigger("keyup")}),r()(".custom-search-input").each(function(){this.value="",this.setAttribute("value",""),r()(this).trigger("input").trigger("change").trigger("keyup")}),q(""),ee.current.columns().every(e=>{e.search("").draw()}),ee.current.draw(),setTimeout(()=>{document.querySelectorAll(".column-search").forEach(e=>{e.value=""})},50))},children:[(0,a.jsx)(m.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Clear"})]}),(0,a.jsxs)(u.AM,{open:et,onOpenChange:el,children:[(0,a.jsx)(u.Wv,{asChild:!0,children:(0,a.jsxs)(s.$,{variant:"outline",className:"flex items-center gap-2 p-1 px-2",children:[(0,a.jsx)(g.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"hidden sm:inline text-xs",children:"Columns"}),(0,a.jsx)(f.A,{className:"h-3 w-3"})]})}),(0,a.jsx)(u.hl,{align:"end",className:"w-[200px] p-0",children:(0,a.jsx)(d.uB,{children:(0,a.jsx)(d.L$,{children:t.filter(e=>!0!==e.hidden).map(e=>{var t;let l=null!==(t=G[e.accessorKey])&&void 0!==t&&t;return(0,a.jsxs)(d.h_,{onSelect:()=>ep(e.accessorKey),disabled:e.disabled,children:[(0,a.jsx)(b.A,{className:"mr-2 h-3 w-3 transition-opacity duration-150 ".concat(l?"opacity-100":"opacity-0")}),e.header]},e.accessorKey||e.id)})},P)})})]}),U&&W&&M&&(0,a.jsxs)(c.rI,{children:[(0,a.jsx)(c.ty,{asChild:!0,children:(0,a.jsxs)("button",{className:"px-3 py-2 flex items-center gap-2 rounded-md border border-border bg-background text-xs font-medium hover:bg-muted",children:[(0,a.jsx)(y.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Export"}),(0,a.jsx)(f.A,{className:"h-3 w-3"})]})}),(0,a.jsxs)(c.SQ,{align:"end",className:"w-[80px] text-xs",children:[W&&(0,a.jsxs)(c.hO,{onClick:()=>{var e;let t=r()(K.current).DataTable();t.columns().indexes().filter(e=>t.column(e).visible());let l=eu(),a=l.length,o=e=>{let t=Array(a).fill("");return t[0]=e,t},n=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e).replace(/,/g,""),s=[o("Pune e Stock Broking Limited"),o(""),o("Name: ".concat(null===(e=X.userDetails)||void 0===e?void 0:e.clientName," | FINANCIAL YEAR REPORT: ").concat(v," | Date Range: ").concat(F," to ").concat(I," | Client ID: ").concat(X.currentUser)),[],o("Summary")],i=[["Unrealized",n(j.unrealized)],["Realized",n(j.realized)],["Liabilities",n(j.liabilities)],["Expenses",n(L.total)]],c=[[],o("Expenses"),...L.rows.map(e=>[e[L.rowKey],n(e[L.rowAmount])]),["Total Expenses",n(L.total)],[],o("Detailed Report")],d=er.flatMap(e=>{let t=n(Math.abs(e.sum)),a="OP_ASSETS"===e.category||"ASSETS"===e.category?"Unrealized (".concat(e.sum>=0?"Profit":"Loss",": ").concat(t,")"):"LIABILITIES"===e.category?"Liabilities: ".concat(t):"Realized (".concat(e.sum>=0?"Profit":"Loss",": ").concat(t,")");return[[],o("".concat("OP_ASSETS"===e.category?"OPENING ASSETS":e.category.toUpperCase()," - ").concat(a)),...e.rows.map(e=>l.map(t=>{let l=e[t.accessorKey];return"number"==typeof l?n(l):l||""}))]}),u=new Blob(["\uFEFF"+[...s,...i.map(e=>e.join(",")),...c.map(e=>e.join(",")),[],l.map(e=>e.header).join(","),...d.map(e=>e.join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),p=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),h=document.createElement("a"),m=URL.createObjectURL(u);h.setAttribute("href",m),h.setAttribute("download","".concat(P,"_").concat(p,".csv")),document.body.appendChild(h),h.click(),document.body.removeChild(h)},className:"flex items-center gap-1 justify-around p-2",children:[(0,a.jsx)(S.default,{src:"/images/SVG/csv.svg",alt:"CSV icon",width:15,height:15,priority:!0,className:"cursor-pointer m-1"}),"CSV"]}),U&&(0,a.jsxs)(c.hO,{onClick:()=>{var e,t,a;r()(K.current).DataTable().columns().indexes().toArray();let o=eu(),n=o.length,s=(null==P?void 0:P.trim())?P:document.title,i={},c={},d=e=>{if(null==e||""===e||"N/A"===e)return"";if("string"==typeof e&&/^\d{2}\/\d{2}\/\d{4}$/.test(e))return e;if("string"==typeof e){if(/[a-zA-Z]/.test(e))return e.trim();let t=Number.parseFloat(e.replace(/[^0-9.-]/g,"").trim());return isNaN(t)?"-":Number.parseFloat(t.toFixed(2))}return"number"==typeof e?Number.parseFloat(e.toFixed(2)):0},u=e=>e>=0?"Profit":"Loss",p=new(N()).Workbook,h=p.addWorksheet("Report",{pageSetup:{paperSize:9,orientation:"portrait",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}}});h.headerFooter.oddFooter="&L&F&C&P of &N&R&D &T";let m=(e,t)=>{h.mergeCells(e,1,e,n);let l=h.getRow(e);l.alignment={horizontal:"center",vertical:"middle"},"title"===t?(l.font={bold:!0,size:16,color:{argb:"000000"}},l.height=24):"subtitle"===t?(l.font={bold:!0,size:12,color:{argb:"000000"}},l.height=20):"section"===t?(l.font={bold:!0,size:14,color:{argb:"000000"}},l.height=22,l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}}):l.font={bold:!0,size:12}},g="FINANCIAL YEAR REPORT OF ".concat(s.replace(/_/g," "),": ").concat(v),f="Date Range: ".concat(F," to ").concat(I),b="Name: ".concat(null===(e=X.userDetails)||void 0===e?void 0:e.clientName,"   |   Client ID: ").concat(X.currentUser,"   |   PAN: ").concat(null===(t=X.userDetails)||void 0===t?void 0:t.pan,"   |   Mobile: ").concat(null===(a=X.userDetails)||void 0===a?void 0:a.mobile),y=h.addRow(["Pune e Stock Broking Limited"]);m(1,"title"),y.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"4472C4"}},e.font={bold:!0,size:16,color:{argb:"FFFFFF"}}}),h.addRow([]),h.addRow([g]),m(3,"subtitle"),h.addRow([f]),m(4),h.addRow([b]),m(5),h.addRow([]);let x=h.rowCount+1;h.addRow(["Table of Contents"]),m(x,"section"),h.addRow(["1. Summary"]),h.addRow(["   1.1 Unrealized "]),h.addRow(["   1.2 Realized "]),h.addRow(["   1.3 Other "]),h.addRow(["   1.4 Expenses "]),h.addRow(["2. Detailed Report"]),h.addRow([]);let C=h.rowCount+1;h.addRow(["1. Summary"]),m(C,"section"),c.Summary=C,h.getCell("A".concat(x+1)).value={text:"1. Summary",hyperlink:"#'".concat(h.name,"'!A").concat(C)},h.getCell("A".concat(x+1)).font={color:{argb:"0563C1"},underline:!0},h.addRow([]),h.addRow(["Category","Amount"]).eachCell(e=>{e.font={bold:!0,size:11},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),h.addRow([]),h.addRow(["1.1 Unrealized "]).font={bold:!0,size:12},c.Unrealized=h.rowCount,h.getCell("A".concat(x+2)).value={text:"   1.1 Unrealized ",hyperlink:"#'".concat(h.name,"'!A").concat(c.Unrealized)},h.getCell("A".concat(x+2)).font={color:{argb:"0563C1"},underline:!0};let S=j.unrealized;Object.entries(l).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).forEach(e=>{let[t,l]=e,a={OP_ASSETS:"OPENING ASSETS"}[t]||t,o=d(l.sum),n=h.rowCount+1;h.addRow([a,o]).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof o&&(h.getCell("B".concat(n)).numFmt="#,##0.00;[Red]-#,##0.00",o<0&&(h.getCell("B".concat(n)).font={color:{argb:"FF0000"}}));let r="Category_".concat(t.replace(/\s+/g,"_"));i[a]=r,h.getCell("A".concat(n)).name=r,h.getCell("A".concat(n)).value={text:a,hyperlink:"#'".concat(h.name,"'!").concat(r)},h.getCell("A".concat(n)).font={color:{argb:"0563C1"},underline:!0}});let w=h.addRow(["Unrealized Total (".concat(u(S),")"),S]);w.font={bold:!0},w.eachCell(e=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}}}),h.getCell("B".concat(h.rowCount)).numFmt="#,##0.00;[Red]-#,##0.00",S<0&&(h.getCell("B".concat(h.rowCount)).font={bold:!0,color:{argb:"FF0000"}}),h.addRow([]),h.addRow(["1.2 Realized "]).font={bold:!0,size:12},c.Realized=h.rowCount,h.getCell("A".concat(x+3)).value={text:"   1.2 Realized ",hyperlink:"#'".concat(h.name,"'!A").concat(c.Realized)},h.getCell("A".concat(x+3)).font={color:{argb:"0563C1"},underline:!0};let E=j.realized;Object.entries(l).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).forEach(e=>{let[t,l]=e,a=d(l.sum),o=h.rowCount+1;h.addRow([t,a]).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof a&&(h.getCell("B".concat(o)).numFmt="#,##0.00;[Red]-#,##0.00",a<0&&(h.getCell("B".concat(o)).font={color:{argb:"FF0000"}}));let n="Category_".concat(t.replace(/\s+/g,"_"));i[t]=n,h.getCell("A".concat(o)).name=n,h.getCell("A".concat(o)).value={text:t,hyperlink:"#'".concat(h.name,"'!").concat(n)},h.getCell("A".concat(o)).font={color:{argb:"0563C1"},underline:!0}});let A=d(L.total),R=h.rowCount+1;h.addRow(["Expenses",A]).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof A&&(h.getCell("B".concat(R)).numFmt="#,##0.00;[Red]-#,##0.00",A<0&&(h.getCell("B".concat(R)).font={color:{argb:"FF0000"}}));let k="Category_Expenses";i.Expenses=k,h.getCell("A".concat(R)).name=k,h.getCell("A".concat(R)).value={text:"Expenses",hyperlink:"#'".concat(h.name,"'!").concat(k)},h.getCell("A".concat(R)).font={color:{argb:"0563C1"},underline:!0};let D=h.addRow(["Realized Total (".concat(u(E),")"),E]);D.font={bold:!0},D.eachCell(e=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}}}),h.getCell("B".concat(h.rowCount)).numFmt="#,##0.00;[Red]-#,##0.00",E<0&&(h.getCell("B".concat(h.rowCount)).font={bold:!0,color:{argb:"FF0000"}}),h.addRow([]),h.addRow(["1.3 Other "]).font={bold:!0,size:12},c.Other=h.rowCount,h.getCell("A".concat(x+4)).value={text:"   1.3 Other ",hyperlink:"#'".concat(h.name,"'!A").concat(c.Other)},h.getCell("A".concat(x+4)).font={color:{argb:"0563C1"},underline:!0};let z=0;Object.entries(l).filter(e=>{let[t]=e;return"LIABILITIES"===t}).forEach(e=>{let[t,l]=e,a=d(l.sum);z+="number"==typeof a?a:0;let o=h.rowCount+1;h.addRow([t,a]).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof a&&(h.getCell("B".concat(o)).numFmt="#,##0.00;[Red]-#,##0.00",a<0&&(h.getCell("B".concat(o)).font={color:{argb:"FF0000"}}));let n="Category_".concat(t.replace(/\s+/g,"_"));i[t]=n,h.getCell("A".concat(o)).name=n,h.getCell("A".concat(o)).value={text:t,hyperlink:"#'".concat(h.name,"'!").concat(n)},h.getCell("A".concat(o)).font={color:{argb:"0563C1"},underline:!0}});let O=h.addRow(["Other Total",z]);O.font={bold:!0},O.eachCell(e=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}}}),h.getCell("B".concat(h.rowCount)).numFmt="#,##0.00;[Red]-#,##0.00",z<0&&(h.getCell("B".concat(h.rowCount)).font={bold:!0,color:{argb:"FF0000"}}),h.addRow([]),h.addRow(["1.4 Expenses "]).font={bold:!0,size:12},c.Expenses=h.rowCount,h.getCell("A".concat(x+5)).value={text:"   1.4 Expenses ",hyperlink:"#'".concat(h.name,"'!A").concat(c.Expenses)},h.getCell("A".concat(x+5)).font={color:{argb:"0563C1"},underline:!0};let B=d(Math.abs(L.total));L.rows.forEach(e=>{let t=d(e[L.rowAmount]),l=h.rowCount+1;h.addRow([e[L.rowKey],Math.abs(t)]).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof t&&(h.getCell("B".concat(l)).numFmt="#,##0.00;[Red]-#,##0.00",t<0&&(h.getCell("B".concat(l)).font={color:{argb:"FF0000"}}))});let M=h.addRow(["Expenses Total (".concat(u(Number(B)),")"),Number(B)]);M.font={bold:!0},M.eachCell(e=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}}}),h.getCell("B".concat(h.rowCount)).numFmt="#,##0.00;[Red]-#,##0.00","number"==typeof B&&B<0&&(h.getCell("B".concat(h.rowCount)).font={bold:!0,color:{argb:"FF0000"}}),i.Expenses=k,h.getCell("A".concat(c.Expenses)).name=k,h.addRow([]),h.addRow([]);let U=h.rowCount+1;h.addRow(["2. Detailed Report"]),m(U,"section"),c.DetailedReport=U,h.addRow([]),h.getCell("A".concat(x+6)).value={text:"2. Detailed Report",hyperlink:"#'".concat(h.name,"'!A").concat(U)},h.getCell("A".concat(x+6)).font={color:{argb:"0563C1"},underline:!0};let W=h.addRow(o.map(e=>e.header));W.font={bold:!0,size:11},W.alignment={horizontal:"center",vertical:"middle"},W.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),er.forEach(e=>{let t=d(e.sum),l="".concat("OP_ASSETS"===e.category?"OPENING ASSETS":e.category.toUpperCase()," (").concat(u(Number(t)),")"),a=h.rowCount+1,r=h.addRow(["".concat(l,": ").concat(t)]);r.font={bold:!0,size:12},r.fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}};let s="Category_".concat(e.category.replace(/\s+/g,"_"));h.getCell("A".concat(a)).name=s,h.mergeCells(a,1,a,n),h.getRow(a).alignment={horizontal:"center",vertical:"middle"},h.getCell("A".concat(a)).value={text:"".concat(l,": ").concat(t),hyperlink:"#'".concat(h.name,"'!A").concat(c["OP_ASSETS"===e.category||"ASSETS"===e.category?"Unrealized":"LIABILITIES"===e.category?"Other":"Realized"])},h.getCell("A".concat(a)).font={bold:!0,size:12,color:{argb:"0563C1"},underline:!0};let i={};null==_||_.forEach(e=>{i[e]=0}),e.rows.forEach((e,t)=>{let l=o.map(t=>{let l=d(e[t.accessorKey]);return(null==_?void 0:_.includes(t.accessorKey))&&"number"==typeof l&&(i[t.accessorKey]=(i[t.accessorKey]||0)+l),l}),a=h.addRow(l);t%2==1&&a.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"F9F9F9"}}}),a.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},"number"==typeof e.value&&(e.numFmt="#,##0.00;[Red]-#,##0.00",e.value<0&&(e.font={color:{argb:"FF0000"}}))})});let p=o.map((e,t)=>0===t?"Total":(null==_?void 0:_.includes(e.accessorKey))?i[e.accessorKey]||0:""),m=h.addRow(p);m.font={bold:!0},m.eachCell((e,t)=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}},"number"==typeof e.value&&(e.numFmt="#,##0.00;[Red]-#,##0.00",e.value<0&&(e.font={bold:!0,color:{argb:"FF0000"}}))}),h.addRow([])}),h.columns.forEach(e=>{var t;let l=0;null===(t=e.eachCell)||void 0===t||t.call(e,{includeEmpty:!0},e=>{let t=e.value?e.value.toString().length:0;t>l&&(l=t)}),e.width=Math.min(l+4,30)});let G=h.rowCount+1;h.addRow(["3. Category Definitions"]),m(G,"section"),c.CategoryDefinitions=G,h.getCell("A".concat(x+7)).value={text:"3. Category Definitions",hyperlink:"#'".concat(h.name,"'!A").concat(G)},h.getCell("A".concat(x+7)).font={color:{argb:"0563C1"},underline:!0},h.addRow([]),["OP_ASSETS","ASSETS","SHORTTERM","LONGTERM","LIABILITIES","TRADING"].forEach((e,t)=>{let l="OP_ASSETS"===e?"OPENING ASSETS":e,a=ed(e);if(!i[l])return;let o=h.rowCount+1,r=h.addRow(["".concat(l,": ","    ").concat(a)]);if(h.mergeCells(o,1,o,n),t%2==1&&r.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"F9F9F9"}}}),r.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.alignment={vertical:"middle",wrapText:!0}}),Object.keys(i).includes(l)||Object.keys(i).includes(e)){let t=i[l]||i[e];t&&(h.getCell("A".concat(o)).value={text:"".concat(l,": ").concat(a),hyperlink:"#'".concat(h.name,"'!").concat(t)},h.getCell("A".concat(o)).font={color:{argb:"0563C1"}})}}),h.addRow([]);let Y=h.addRow(["Back to Table of Contents"]);Y.getCell(1).value={text:"Back to Table of Contents",hyperlink:"#'".concat(h.name,"'!A").concat(x)},Y.getCell(1).font={color:{argb:"0563C1"},underline:!0},p.xlsx.writeBuffer().then(e=>{let t=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),l="".concat(s,"_").concat(t,".xlsx");(0,T.saveAs)(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l)})},className:"flex items-center gap-1 justify-around p-2",children:[(0,a.jsx)(S.default,{src:"/images/SVG/excel.svg",alt:"Excel icon",width:20,height:20,priority:!0,className:"cursor-pointer m-1"}),"Excel"]}),M&&(0,a.jsxs)(c.hO,{onClick:()=>{var e,t,a,o,n;let s=r()(K.current).DataTable(),i=s.columns().indexes().toArray(),c=s.columns().header().toArray().filter((e,t)=>-1!==i.indexOf(t)).map(e=>e.textContent),d=new A.default({orientation:"portrait",unit:"mm",format:"a4"}),u=(null==P?void 0:P.trim())?P:document.title,p=e=>null==e||""===e?"-":e.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2});d.setProperties({title:"Financial Report - ".concat((null===(e=X.userDetails)||void 0===e?void 0:e.clientName)||"-"),subject:"Financial Year Report: ".concat(v||"-"),author:"Pune e Stock Broking Limited",creator:"Pune e Stock Broking Limited"});let h=d.internal.pageSize.width,m=d.internal.pageSize.height,g=h-10,f=15;d.setFillColor(20,60,120),d.rect(5,f-5,g,22,"F"),d.setFillColor(40,80,140),d.rect(5,f-5,g,2,"F"),d.setFillColor(10,40,100),d.rect(5,f+5,g,2,"F"),d.setFont("helvetica","bold"),d.setFontSize(14),d.setTextColor(255,255,255),d.text("Pune e Stock Broking Limited",h/2,f+2,{align:"center"}),f+=4,d.setFont("helvetica","normal"),d.setFontSize(7.5),d.setTextColor(255,255,255),d.text("1198 Shukrawar Peth, Subhash Nagar Lane No.3 Pune, Maharashtra, India, Tel No. 020-41000600 / 020-24496162 Fax No. 020-24498100",h/2,f+2,{align:"center",maxWidth:g}),f+=3,d.text("SEBI Registration No: NSE-EQ: INB231289233, NSE-F&O: INF231289233, NSE-CDS: INF231289233, BSE-EQ: INB011289239, MCX-SX: INZ000027030",h/2,f+2,{align:"center",maxWidth:g}),f+=3,d.text("BSE-EQ: INB0, BSE-F&O: INF, MCX-SX: INE",h/2,f+2,{align:"center",maxWidth:g}),f+=12,d.setFillColor(240,245,250),d.rect(5,f-2,g,16,"F"),d.setTextColor(20,60,120),d.setFontSize(11),d.text("FINANCIAL YEAR REPORT - ".concat(u.replace(/_/g," ")),h/2,f+2,{align:"center"}),f+=10,d.setFontSize(9),d.setTextColor(50,50,80),d.setFont("helvetica","bold"),d.text("Financial Year:",10,f),d.setFont("helvetica","normal"),d.text(v||"-",40,f),d.setFont("helvetica","bold"),d.text("Date Range:",h-80,f),d.setFont("helvetica","normal"),d.text("".concat(F||"-"," to ").concat(I||"-"),h-5-5,f,{align:"right"}),f+=10,d.setFillColor(248,248,248),d.rect(5,f-2,g,28,"F"),d.setDrawColor(100,100,120),d.setLineWidth(.5),d.rect(5,f-2,g,28,"S"),d.setFillColor(230,230,235),d.rect(6,f-1,g-2,6,"F"),d.setFontSize(9),d.setTextColor(50,50,80),d.setFont("helvetica","bold"),d.text("CLIENT INFORMATION",h/2,f+3,{align:"center"}),f+=10;let b=h-80,y=h-5-5;d.setFontSize(8),d.setTextColor(50,50,50),d.setFont("helvetica","bold"),d.text("Client Name:",10,f),d.setFont("helvetica","normal"),d.text((null===(t=X.userDetails)||void 0===t?void 0:t.clientName)||"-",40,f),d.setFont("helvetica","bold"),d.text("PAN:",b,f),d.setFont("helvetica","normal"),d.text((null===(a=X.userDetails)||void 0===a?void 0:a.pan)||"-",y,f,{align:"right"}),f+=6,d.setFont("helvetica","bold"),d.text("Client ID:",10,f),d.setFont("helvetica","normal"),d.text(X.currentUser||"-",40,f),d.setFont("helvetica","bold"),d.text("Mobile:",b,f),d.setFont("helvetica","normal"),d.text((null===(o=X.userDetails)||void 0===o?void 0:o.mobile)||"-",y,f,{align:"right"}),f+=6,(null===(n=X.userDetails)||void 0===n?void 0:n.email)&&(d.setFont("helvetica","bold"),d.text("Email:",10,f),d.setFont("helvetica","normal"),d.text(X.userDetails.email||"-",40,f)),f+=12,d.setFillColor(245,222,179),d.rect(5,f-5,g,8,"F"),d.setFont("helvetica","bold"),d.setFontSize(11),d.setTextColor(80,40,20),d.text("FINANCIAL SUMMARY",h/2,f,{align:"center"}),f+=10;let x=j.unrealized>=0;d.setFillColor(x?220:240,230,x?240:230),d.rect(5,f-5,g,8,"F"),d.setDrawColor(180,180,190),d.setLineWidth(.2),d.rect(5,f-5,g,8,"S"),d.setFontSize(9),d.setFont("helvetica","bold"),d.setTextColor(50,50,80),d.text("UNREALIZED",10,f+1),f+=4;let C=Object.entries(l).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).map(e=>{let[t,l]=e;return["OP_ASSETS"===t?"OPENING ASSETS":t,p(l.sum)]}),S=p(j.unrealized),w=j.unrealized>=0?"Profit":"Loss";E()(d,{startY:f,body:C,styles:{fontSize:8,cellPadding:2},theme:"grid",headStyles:{fillColor:[230,230,235]},alternateRowStyles:{fillColor:[245,245,248]},columnStyles:{0:{cellWidth:.7*g,fontStyle:"bold"},1:{cellWidth:.3*g,halign:"right"}},margin:{left:5,right:5},foot:[[{content:"UNREALIZED TOTAL (".concat(w,")"),styles:{fontStyle:"bold",fillColor:[x?220:240,230,x?240:230],textColor:[50,50,80]}},{content:"".concat(S),styles:{fontStyle:"bold",fillColor:[x?220:240,230,x?240:230],textColor:[50,50,80],halign:"right"}}]]}),f=d.lastAutoTable.finalY+8;let N=j.realized>=0;d.setFillColor(N?220:240,N?240:230,220),d.rect(5,f-5,g,8,"F"),d.setDrawColor(180,190,180),d.setLineWidth(.2),d.rect(5,f-5,g,8,"S"),d.setFontSize(9),d.setFont("helvetica","bold"),d.setTextColor(50,70,50),d.text("REALIZED",10,f+1),f+=4;let T=Object.entries(l).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).map(e=>{let[t,l]=e;return[t,p(l.sum)]});T.push(["Expenses",p(L.total)]);let R=j.realized>=0?"Profit":"Loss";E()(d,{startY:f,body:T,styles:{fontSize:8,cellPadding:2},theme:"grid",headStyles:{fillColor:[230,235,230]},alternateRowStyles:{fillColor:[245,248,245]},columnStyles:{0:{cellWidth:.7*g,fontStyle:"bold"},1:{cellWidth:.3*g,halign:"right"}},margin:{left:5,right:5},foot:[[{content:"REALIZED TOTAL (".concat(R,")"),styles:{fontStyle:"bold",fillColor:[N?220:240,N?240:230,220],textColor:[50,70,50]}},{content:"".concat(p(j.realized)),styles:{fontStyle:"bold",fillColor:[N?220:240,N?240:230,220],textColor:[50,70,50],halign:"right"}}]]}),f=d.lastAutoTable.finalY+8,d.setFillColor(240,230,220),d.rect(5,f-5,g,8,"F"),d.setDrawColor(190,180,180),d.setLineWidth(.2),d.rect(5,f-5,g,8,"S"),d.setFontSize(9),d.setFont("helvetica","bold"),d.setTextColor(70,50,50),d.text("EXPENSES",10,f+1),f+=4;let k=L.rows.map(e=>[e[L.rowKey]||"-",p(e[L.rowAmount])]);E()(d,{startY:f,body:k,styles:{fontSize:8,cellPadding:2},theme:"grid",headStyles:{fillColor:[235,230,230]},alternateRowStyles:{fillColor:[248,245,245]},columnStyles:{0:{cellWidth:.7*g,fontStyle:"bold"},1:{cellWidth:.3*g,halign:"right"}},margin:{left:5,right:5},foot:[[{content:"EXPENSES TOTAL",styles:{fontStyle:"bold",fillColor:[240,230,220],textColor:[70,50,50]}},{content:p(Math.abs(L.total)),styles:{fontStyle:"bold",fillColor:[240,230,220],textColor:[70,50,50],halign:"right"}}]]}),d.addPage(),f=15,d.setFillColor(245,222,179),d.rect(5,f-5,g,8,"F"),d.setFont("helvetica","bold"),d.setFontSize(11),d.setTextColor(80,40,20),d.text("DETAILED REPORT",h/2,f,{align:"center"}),f+=10,er.forEach(e=>{let t=p(Math.abs(e.sum)),l=e.sum>=0,a="".concat("OP_ASSETS"===e.category?"OPENING ASSETS":e.category.toUpperCase()," (").concat(l?"Profit":"Loss",": ").concat(t,")");d.setFillColor(l?220:240,l?240:220,230),d.rect(5,f-5,g,8,"F"),d.setDrawColor(l?100:150,120,l?150:100),d.setLineWidth(.2),d.rect(5,f-5,g,8,"S"),d.setFontSize(9),d.setFont("helvetica","bold"),d.setTextColor(50,50,70),d.text(a,10,f+1),f+=8;let o=e.rows.map(e=>c.map((t,l)=>{let a=e[s.column(l).dataSrc()];if(null==a||""===a)return"-";let o=Number(a);return isNaN(o)?a:p(o)}));E()(d,{startY:f,head:[c],body:o,styles:{fontSize:7,cellPadding:1.5,overflow:"linebreak"},headStyles:{fillColor:[40,80,140],textColor:255,fontSize:8,fontStyle:"bold"},theme:"grid",margin:{left:5,right:5},didParseCell:e=>{0===e.column.index&&e.cell.text&&"string"==typeof e.cell.text&&"string"==typeof e.cell.text&&(e.cell.text.includes("/")||e.cell.text.includes("-"))&&(e.cell.styles.halign="center"),e.cell.text&&"string"==typeof e.cell.text&&"string"==typeof e.cell.text&&(e.cell.text.includes("₹")||e.cell.text.includes(","))&&(e.cell.styles.halign="right",e.cell.styles.font="helvetica")},willDrawCell:e=>{e.cell.height<7&&(e.cell.height=7)}}),f=d.lastAutoTable.finalY+8}),(f=d.lastAutoTable.finalY+10)>m-60&&(d.addPage(),f=15);let D=new Set;Object.entries(l).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).forEach(e=>{let[t]=e;return D.add(t)}),Object.entries(l).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).forEach(e=>{let[t]=e;return D.add(t)}),l.LIABILITIES&&D.add("LIABILITIES");let z=Array.from(D).map(e=>["OP_ASSETS"===e?"OPENING ASSETS":e.toUpperCase(),ed(e)]);d.setFillColor(240,240,240),d.rect(5,f-5,g,8,"F"),d.setDrawColor(180,180,180),d.setLineWidth(.2),d.rect(5,f-5,g,8,"S"),d.setFontSize(9),d.setFont("helvetica","bold"),d.setTextColor(50,50,50),d.text("CATEGORY DESCRIPTIONS",h/2,f,{align:"center"}),f+=8,E()(d,{startY:f,body:z,styles:{fontSize:7,cellPadding:2,overflow:"linebreak"},theme:"grid",headStyles:{fillColor:[240,240,240]},alternateRowStyles:{fillColor:[248,248,248]},columnStyles:{0:{cellWidth:.25*g,fontStyle:"bold",fillColor:[245,245,245]},1:{cellWidth:.75*g,fontStyle:"normal"}},margin:{left:5,right:5}}),(e=>{let t=e.internal.getNumberOfPages();for(let l=1;l<=t;l++){e.setPage(l),e.setDrawColor(200,200,200),e.setLineWidth(.1),e.line(5,m-8,h-5,m-8),e.setFontSize(7),e.setFont("helvetica","normal"),e.setTextColor(100,100,100);let a=new Date().toLocaleDateString("en-IN");e.text("Generated on: ".concat(a),5,m-5),e.setFont("helvetica","bold"),e.text("Pune e Stock Broking Limited",h/2,m-5,{align:"center"}),e.setFont("helvetica","normal"),e.text("Page ".concat(l," of ").concat(t),h-5,m-5,{align:"right"})}})(d);let O=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),B="".concat(u,"_").concat(O,".pdf");d.save(B)},className:"flex items-center gap-1 justify-around p-2",children:[(0,a.jsx)(S.default,{src:"/images/SVG/pdfSvg.svg",alt:"PDF icon",width:20,height:20,priority:!0,className:"cursor-pointer m-1"}),"PDF"]})]})]}),D&&(0,a.jsxs)("div",{className:"ml-auto",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Show"}),(0,a.jsxs)("select",{title:"entries",className:"h-8 px-1 rounded-md border border-border bg-background text-xs mx-1",onChange:e=>{ee.current&&ee.current.page.len(Number.parseInt(e.target.value)).draw()},children:[(0,a.jsx)("option",{value:"10",children:"10"}),(0,a.jsx)("option",{value:"25",children:"25"}),(0,a.jsx)("option",{value:"50",children:"50"}),(0,a.jsx)("option",{value:"100",children:"100"})]}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"entries"})]})]})]}),(0,a.jsx)("div",{className:"rounded-md",children:(0,a.jsxs)("table",{ref:K,className:"row-border hover cell-border row-border",children:[(0,a.jsx)("thead",{}),(0,a.jsx)("tbody",{}),_&&(0,a.jsx)("tfoot",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{style:{display:"none"}}),k&&(0,a.jsx)("th",{}),eo.map((e,t)=>(0,a.jsx)("th",{"data-column-id":e.accessorKey,children:(_.includes(e.accessorKey),"")},t))]})})]})})]})}},94831:(e,t,l)=>{"use strict";l.d(t,{G7:()=>c,L$:()=>p,h_:()=>h,oI:()=>d,uB:()=>i,xL:()=>u});var a=l(95155),o=l(12115),n=l(7859),r=l(20853),s=l(21567);l(51344);let i=o.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,a.jsx)(n.uB,{ref:t,className:(0,s.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",l),...o})});i.displayName=n.uB.displayName;let c=o.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,a.jsx)(r.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(n.uB.Input,{ref:t,className:(0,s.cn)("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",l),...o})]})});c.displayName=n.uB.Input.displayName;let d=o.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,a.jsx)(n.uB.List,{ref:t,className:(0,s.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",l),...o})});d.displayName=n.uB.List.displayName;let u=o.forwardRef((e,t)=>(0,a.jsx)(n.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));u.displayName=n.uB.Empty.displayName;let p=o.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,a.jsx)(n.uB.Group,{ref:t,className:(0,s.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",l),...o})});p.displayName=n.uB.Group.displayName,o.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,a.jsx)(n.uB.Separator,{ref:t,className:(0,s.cn)("-mx-1 h-px bg-border",l),...o})}).displayName=n.uB.Separator.displayName;let h=o.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,a.jsx)(n.uB.Item,{ref:t,className:(0,s.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l),...o})});h.displayName=n.uB.Item.displayName},89095:(e,t,l)=>{"use strict";l.d(t,{AM:()=>s,Wv:()=>i,hl:()=>c});var a=l(95155),o=l(12115),n=l(38417),r=l(21567);let s=n.bL,i=n.l9;n.Mz;let c=o.forwardRef((e,t)=>{let{className:l,align:o="center",sideOffset:s=4,...i}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsx)(n.UC,{ref:t,align:o,sideOffset:s,className:(0,r.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...i})})});c.displayName=n.UC.displayName},27071:()=>{}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5996],{75996:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var l=n(95155),o=n(12115),a=n(43932),r=n.n(a);n(54119),n(23299),n(8769),n(81956),n(4469),n(95198);var s=n(73312),i=n(57485),c=n(33900),d=n(94831),u=n(89095),p=n(20853),h=n(40767),m=n(84267),f=n(92598),g=n(51719),b=n(98867),x=n(44857),v=n(45687),y=n(97307),w=n(76046),C=n(10142),N=n(92340),F=n.n(N),k=n(79254),S=n.n(k),j=n(38003),E=n(5565),T=n(97555);window.$=window.jQuery=r();let A=e=>{let{columns:t,data:n,selectAllCheckbox:a=!0,showPagination:N=!0,downloadFileName:k,onRowClick:A,getActionButtonDetails:R,selectableRows:D,onSelectionChange:L,columnsWithTotals:I,moreDetails:P,viewColumns:B=!0,columnSearch:_=!1,includeFileData:z=!1,ref:M,year:O,fromDate:K,toDate:W,onRowRender:H,downloadPDF:$=!0,downloadExcel:U=!0,downloadCSV:V=!0}=e,Y=(0,o.useRef)("datatable-".concat(Math.random().toString(36).substring(2,11))).current,G=(0,o.useRef)(M);(0,o.useImperativeHandle)(M,()=>G.current);let J=(0,o.useRef)(null),Q=(0,o.useRef)([]),X=(0,o.useRef)(!1),[Z,q]=(0,o.useState)(""),[ee,et]=(0,o.useState)({userDetails:null,currentUser:null}),[en,el]=(0,o.useState)(!1),{userDetails:eo,currentUser:ea}=(0,y.J)(),er=(0,w.useSearchParams)(),{state:es}=(0,T.cL)();(0,o.useEffect)(()=>{if(!J.current)return;let e=r()(null==J?void 0:J.current).DataTable();J.current&&(setTimeout(()=>{var t;(null===(t=J.current.columns)||void 0===t?void 0:t.adjust)&&J.current.columns.adjust(),e.responsive.recalc(),e.draw(!1)},200),setTimeout(()=>{e.columns().every(function(){r()(this.header()).css({"min-width":"100px","max-width":"300px",width:"auto"})}),J.current.columns.adjust().responsive.recalc().draw(!1)},300))},[es]),(0,o.useEffect)(()=>{let e=er.get("clientId"),t=er.get("branchClientCheck"),n=er.get("familyClientCheck");et(l=>{if(e){let o="";if(t?o="branchClientCheck_".concat(e):n&&(o="familyClientCheck_".concat(e)),o){let t=sessionStorage.getItem(o),n=t?JSON.parse(t):null;return l.userDetails!==n||l.currentUser!==e?{userDetails:n,currentUser:e}:l}}return l.userDetails!==eo||l.currentUser!==ea?{userDetails:eo,currentUser:ea}:l})},[er,eo,ea]),(0,o.useEffect)(()=>{let e=J.current;if(!e)return;let t=()=>{let t=r()(e.table().body());try{t.unmark({done:()=>{Z&&t.mark(Z)}})}catch(e){console.error("Mark.js highlight error:",e)}};return e.on("draw.dt",t),()=>{e.off("draw.dt",t)}},[Z]);let ei=(0,o.useMemo)(()=>n,[n]),ec=(0,o.useMemo)(()=>t,[t]),ed=e=>null==e||""===e?"-":"number"==typeof e?e:"string"!=typeof e||isNaN(e)?"string"==typeof e&&e.match(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}$/)?e.split(" ")[0]:e:e.startsWith("0")||e.length>e.replace(/^0+/,"").length?e:Number.parseFloat(e),eu=(0,o.useMemo)(()=>{let e=null==ec?void 0:ec.filter(e=>{if(e.conditionalColumn){for(let[t,n]of Object.entries(e.conditionalColumn))if(null==ei?void 0:ei.some(e=>n.some(n=>e[t]===n.value)))return!1}return!e.hidden});return D&&(e=[{id:"select_all_checkbox",data:null,title:"".concat(a?'<input type="checkbox" id="selectAllCheckbox" title="Select All" />':""),className:"select-checkbox",orderable:!1,searchable:!1,defaultContent:"",cell:e=>{var t;let{data:n,type:o,row:a}=e;return(0,l.jsx)("input",{type:"checkbox",className:"rowCheckbox","data-id":(null===(t=a.original)||void 0===t?void 0:t.client_id)||a.client_id,name:"Select Row",title:"Select Row",defaultChecked:!1})}},...e]),e},[ec,ei,D]);(0,o.useEffect)(()=>{r()(G.current).on("click",".expandable-button",function(e){var t,n;e.stopPropagation();let l=r()(this),o=JSON.parse(l.attr("data-hidden-data")||"[]");r()(".expandable-popover").remove();let a='\n                <div class="expandable-popover bg-background border rounded-lg shadow-lg" \n                    style="min-width: 250px; max-width: 90vw; position: absolute; z-index: 1000;">\n                    <div class="flex items-center justify-between border-b p-2">\n                        <span class="font-medium">Details</span>\n                        <button name="expand" class="close-popover p-1 hover:bg-background-100 rounded-full">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" \n                                stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">\n                                <line x1="18" y1="6" x2="6" y2="18"></line>\n                                <line x1="6" y1="6" x2="18" y2="18"></line>\n                            </svg>\n                        </button>\n                    </div>\n                    <div class="p-4">\n                        <table class="w-full">\n                            <tbody>\n                                '.concat(o.map(e=>'\n                                                                <tr class="border-b last:border-0">\n                                                                    <td class="py-2 pr-4 font-medium text-sm">'.concat(e.header,'</td>\n                                                                    <td class="py-2 text-sm break-words">').concat(e.value,"</td>\n                                                                </tr>\n                                                                ")).join(""),"\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            "),s=r()(a);r()("body").append(s);let i=l.offset(),c=l.outerWidth(),d=l.outerHeight(),u=r()(window).width(),p=s.outerWidth(),h=(null!==(t=null==i?void 0:i.left)&&void 0!==t?t:0)+(null!=c?c:0)/2;h+(null!=p?p:0)>(null!=u?u:0)&&(h=(null!=u?u:0)-(null!=p?p:0)-20),h<0&&(h=20),s.css({top:(null!==(n=null==i?void 0:i.top)&&void 0!==n?n:0)+(null!=d?d:0)+5,left:h}),s.find(".close-popover").on("click",()=>{s.remove()}),r()(document).on("click",function e(t){r()(t.target).closest(".expandable-popover, .expandable-button").length||(s.remove(),r()(document).off("click",e))})})},[]),(0,o.useEffect)(()=>{if(G.current&&!X.current&&G.current&&r().fn.DataTable()){var e;r()(G.current).attr("id",Y);let n=null===(e=r()(G.current))||void 0===e?void 0:e.DataTable({data:null==ei?void 0:ei.map(e=>{let t={};return eu.forEach(n=>{t[n.accessorKey]=ed(e[n.accessorKey])}),{...t,original:e}}),columns:[{data:"",defaultContent:"",className:"dtr-control dtr-hidden",orderable:!1,visible:!0},...eu.map(e=>({data:e.accessorKey||e.data,title:e.title||e.header,visible:!e.deselected&&!1!==e.visible,orderable:!1!==e.orderable,className:e.className||"",defaultContent:e.defaultContent||"",width:e.width||"auto",render:(n,l,a,r)=>{if("function"==typeof e.dtRender)return e.dtRender(n,l,a,r);let s=ed(n);if(e.hiddenColumns&&e.hiddenColumns.length>0){let n=e.hiddenColumns.map(e=>{let n=t.find(t=>t.id===e),l=(null==n?void 0:n.header)||e,o=a.original[e];return n&&void 0!==o?{header:l,value:o}:null}).filter(e=>null!==e);if(n.length>0){let t=s;if(e.cell&&"function"==typeof e.cell){let n=e.cell({row:a});t=o.isValidElement(n)?v.renderToString(n):n}return'\n                                        <div class="flex items-center">\n                                            '.concat(t,'\n                                            <button class="expandable-button ml-2 h-3 w-3 p-0" \n                                                    data-hidden-data=\'').concat(JSON.stringify(n),'\'>\n                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" \n                                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" \n                                                        strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">\n                                                        <polyline points="9 18 15 12 9 6"></polyline>\n                                                    </svg>\n                                            </button>\n                                        </div>\n                                    ')}}if(e.cell&&"function"==typeof e.cell){let t=e.cell({row:a});if(o.isValidElement(t)){let e=document.createElement("div");return e.innerHTML=v.renderToString(t),setTimeout(()=>{let t=e.querySelector("button");t&&t.addEventListener("click",e=>{e.stopPropagation(),null==R||R(e,a.original,"someAction")})},0),e.innerHTML}return t}return s}}))],responsive:{details:{type:"column",target:0,renderer:(e,t,n)=>{let l=Array.isArray(n)?n.filter(e=>e.hidden&&0!==e.columnIndex):[];if(0===l.length)return!1;let o=document.createElement("ul");o.className="dtr-details",o.addEventListener("click",e=>{e.target.closest("button")||e.stopPropagation()});let a=document.createElement("li");return a.className="dtr-details-header",a.innerHTML='<div class="expand-hint"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" class="lucide lucide-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg> <span>Expanded Details</span></div>',o.appendChild(a),l.forEach(e=>{let t=document.createElement("li");t.className="dt-head-custom dt-body-custom";let n=document.createElement("span");n.className="dtr-title",n.textContent=e.title+":";let l=document.createElement("span");l.className="dtr-data",l.innerHTML=e.data,t.appendChild(n),t.appendChild(l),o.appendChild(t)}),o}},breakpoints:[{name:"desktop",width:Number.POSITIVE_INFINITY},{name:"tablet",width:1024},{name:"mobile",width:640}]},columnDefs:[{targets:"_all",width:"auto"},{targets:0,orderable:!1,searchable:!1,className:"dtr-control ",visible:!1,responsivePriority:-1},{targets:0,className:"select-checkbox",orderable:!1,checkboxes:{selectRow:!0}},{className:"dtr-control",orderable:!1,targets:0},{targets:"_all",className:"dt-head-custom dt-body-custom",orderable:!0},...eu.map((e,t)=>({targets:t+1,orderable:!1!==e.sortable})),{responsivePriority:1,targets:[0,1]},{responsivePriority:2,targets:eu.map((e,t)=>t+1).filter(e=>{let t=eu[e-1];return t&&("id"===t.accessorKey||"name"===t.accessorKey||"date"===t.accessorKey)})},{responsivePriority:1e4,targets:eu.map((e,t)=>t+1).filter(e=>{let t=eu[e-1];return t&&("description"===t.accessorKey||"details"===t.accessorKey||"actions"===t.accessorKey)})}],dom:'<"datatable-container"t><"datatable-footer"<"datatable-info"i><"datatable-pagination"p>>',buttons:[{extend:"pdfHtml5",text:"Export PDF",title:"DataTable Export",orientation:"landscape",pageSize:"A4",exportOptions:{columns:":visible"}}],select:!!D&&{style:"multi",selector:"td:first-child"},deferRender:!0,destroy:!0,scrollX:!0,autoWidth:!1,order:[],scrollY:N?"600px":"400px",scrollCollapse:!0,pageLength:10,ordering:!0,paging:N,info:N,stripeClasses:[],stateDuration:-1,retrieve:!0,search:!1,lengthChange:!1,searching:!0,language:{search:"",searchPlaceholder:"Search all columns...",lengthMenu:"Show _MENU_ entries",info:"Showing _START_ to _END_ of _TOTAL_ entries",paginate:{first:"First",last:"Last",next:"Next",previous:"Prev"}},rowCallback:(e,t,n)=>{r()(e).css({"line-height":"1.2","font-size":"0.75rem"})},footerCallback:function(e,t,n,l,o){let a=this.api();a.columns.adjust(),null==I||I.forEach(e=>{let t=a.columns().indexes().toArray().find(t=>a.column(t).dataSrc()===e);if(void 0===t)return;let n=a.column(t).footer();if(!n)return;let l=a.column(t,{search:"applied"}).data().reduce((e,t)=>Number.parseFloat(e)+Number.parseFloat(t),0),o=new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),r=l>=0?"green":"red";n.innerHTML='<span style="color: '.concat(r,'; font-weight: bold;">').concat(o,"</span>")})},initComplete:function(){let e=this.api();_&&e.columns().every(t=>{let n;if(0===t||D&&1===t)return;let l=e.column(t),o=r()(l.header()).text().trim(),a=r()('<div class="column-search-wrapper"></div>'),s=r()('<input name="column-search-'.concat(o,'" type="text" class="column-search" placeholder="Search ').concat(o,'" />'));s.attr("aria-label","Search ".concat(o)),s.attr("role","searchbox"),r()(a).append(s),r()(l.header()).append(a),r()(s).on("keyup change",function(e){e.stopPropagation(),clearTimeout(n);let t=r()(this).val();n=setTimeout(()=>{l.search()!==t&&l.search(t).draw()},300)}),s.on("click",e=>{e.stopPropagation()})}),r()(".dataTables_filter").hide();let t=r()(".datatable-pagination");e.on("draw",()=>{let n=e.page.info(),l=n.pages,o=n.page,a=Math.max(0,o-2),s=Math.min(l-1,a+4);s-a<4&&a>0&&(a=Math.max(0,s-4));let i="";for(let e=a;e<=s;e++)i+='\n                                <button class="pagination-button page-number '.concat(e===o?"active":"",'" \n                                        data-page="').concat(e,'">\n                                ').concat(e+1,"\n                                </button>\n                            ");let c='\n                            <div class="custom-pagination">\n                                <button class="pagination-button first-page '.concat(0===n.page?"disabled":"",'" \n                                        ').concat(0===n.page?"disabled":"",'>\n                                <span>\xab</span>\n                                </button>\n                                <button class="pagination-button previous-page ').concat(0===n.page?"disabled":"",'"\n                                        ').concat(0===n.page?"disabled":"",'>\n                                <span>‹</span>\n                                </button>\n                                \n                                <div class="pagination-numbers">\n                                ').concat(i,'\n                                </div>\n                                \n                                <button class="pagination-button next-page ').concat(n.page===n.pages-1?"disabled":"",'"\n                                        ').concat(n.page===n.pages-1?"disabled":"",'>\n                                <span>›</span>\n                                </button>\n                                <button class="pagination-button last-page ').concat(n.page===n.pages-1?"disabled":"",'"\n                                        ').concat(n.page===n.pages-1?"disabled":"",">\n                                <span>\xbb</span>\n                                </button>\n                            </div>\n                            ");n.pages>1?t.html(c).show():t.hide(),t.find(".first-page").on("click",function(){r()(this).hasClass("disabled")||e.page("first").draw("page")}),t.find(".previous-page").on("click",function(){r()(this).hasClass("disabled")||e.page("previous").draw("page")}),t.find(".next-page").on("click",function(){r()(this).hasClass("disabled")||e.page("next").draw("page")}),t.find(".last-page").on("click",function(){r()(this).hasClass("disabled")||e.page("last").draw("page")}),t.find(".page-number").on("click",function(){let t=Number.parseInt(r()(this).data("page"));e.page(t).draw("page")})});let n=r()(".datatable-length"),l=r()('<select name="entries" class="custom-length-select"></select>');[10,25,50,100].forEach(t=>{l.append('<option value="'.concat(t,'" ').concat(e.page.len()===t?"selected":"",">\n                            ").concat(t," entries\n                        </option>"))}),n.html('<div class="custom-length-container"><span>Show</span></div>'),n.find(".custom-length-container").append(l),n.find(".custom-length-container").append("<span>entries</span>"),l.on("change",function(){let t=r()(this).val();e.page.len(t).draw()});let o=r()(".datatable-info"),a=()=>{let t=e.page.info(),n=e.rows({selected:!0}).count(),l='\n                                              <div class="custom-info">\n                                                <span>Showing '.concat(t.start+1," to ").concat(t.end," of ").concat(t.recordsDisplay," entries</span>\n                                                ").concat(t.recordsDisplay!==t.recordsTotal?'<span class="filtered-info">(filtered from '.concat(t.recordsTotal," total entries)</span>"):"","\n                                                ").concat(n>0?'<span class="selected-info">('.concat(n," selected)</span>"):"","\n                                              </div>\n                                            ");o.html(l)};e.on("draw",a),e.on("select",a),e.on("deselect",a),e.draw(),r()(G.current).find("td.dtr-control").empty(),r()(G.current).find("td.dtr-control"),e.on("responsive-display",(e,t,n,l)=>{let o=r()(n.node()).find("td.dtr-control");o.empty(),l?(o.addClass("expanded"),r()(n.node()).addClass("expanded-row")):(o.removeClass("expanded"),r()(n.node()).removeClass("expanded-row"))}),setTimeout(()=>{r()(".dtr-control").addClass("pulse-hint"),setTimeout(()=>{r()(".dtr-control").removeClass("pulse-hint")},5e3)},1e3)},createdRow:(e,t,n)=>{H&&H(t,e),r()(e).attr("data-row-data",JSON.stringify(t))}});J.current=n,D&&(r()(G.current).on("click","tbody tr",e=>{r()(e.target).is(".rowCheckbox")||r()(e.target).closest(".rowCheckbox").length||e.stopPropagation()}),n.on("select.dt deselect.dt",()=>{let e=n.rows().nodes(),t=n.rows({selected:!0}).nodes(),l=n.rows({selected:!0}).data().toArray().map((e,n)=>{let l=t[n],o=r()(l).find("input:not(.rowCheckbox), select, textarea"),a={};return null==o||o.each(function(){let e=r()(this).attr("id")||r()(this).attr("name")||r()(this).attr("data-id");e&&(a[e]=r()(this).val())}),{...e,inputs:a}});L&&JSON.stringify(l)!==JSON.stringify(Q.current)&&(Q.current=l,null==L||L(l)),Array.from(e).forEach(e=>{r()(e).find(".rowCheckbox").prop("checked",!1)}),Array.from(t).forEach(e=>{r()(e).find(".rowCheckbox").prop("checked",!0)})}),r()(G.current).on("click","td.select-checkbox",function(e){e.stopPropagation();let t=n.row(r()(this).closest("tr"));t.select&&(r()(t.node()).hasClass("selected")?t.deselect():t.select())}),n.on("select.dt deselect.dt",()=>{let e=n.rows().nodes(),t=n.rows({selected:!0}).nodes();r()(e).find(".rowCheckbox").prop("checked",!1),r()(t).find(".rowCheckbox").prop("checked",!0),r()("#selectAllCheckbox").prop("checked",t.length===e.length)}),r()(document).on("click","thead th #selectAllCheckbox",function(e){e.stopPropagation(),r()(this).prop("checked")?(n.rows().select(),setTimeout(()=>{let e=n.rows().nodes(),t=n.rows({selected:!0}).nodes().length===e.length;r()("#selectAllCheckbox").prop("checked",t)},0)):(n.rows().deselect(),r()("#selectAllCheckbox").prop("checked",!1))}),n.on("draw.dt",function(){let e=n.rows({selected:!0}).nodes();r()(e).find(".rowCheckbox").prop("checked",!0)}));let l={};return eu.forEach(e=>{l[e.accessorKey]=!e.hidden&&!e.deselected}),em(l),n.on("column-visibility.dt",(e,t,l,o)=>{let a=n.column(l).dataSrc();em(e=>({...e,[a]:o}))}),A&&r()(G.current).on("click","tbody tr",function(e){if(!r()(e.target).closest("button").length){let e=n.row(this).data();e&&A(e)}}),R&&r()(G.current).on("click",".action-btn",function(e){e.stopPropagation();let t=r()(this).closest("tr"),l=n.row(t).data(),o=r()(this).data("action"),a=t.find("input, select, textarea"),s={};a.each(function(){let e=r()(this).attr("name")||r()(this).attr("data-id");e&&(s[e]=r()(this).val())}),l&&o&&R(e,{...l,inputs:s},o)}),r()("<style>").prop("type","text/css").html("\n              ".concat(N?"":"\n                    .dataTables_info, .dataTables_paginate, .dataTables_length {\n                        display: none !important;\n                    }\n                ",'\n\n                    td:has(input[name="upiId"]) {\n    position: relative;\n}\n\n            ')).appendTo("head"),r()(G.current).on("responsive-display",(e,t,n,l)=>{let o=r()(n.node()).find(".dtr-control");l?o.addClass("expanded"):o.removeClass("expanded")}),X.current=!0,()=>{if(J.current&&G.current)try{J.current.columns().search("").draw(),r()(G.current).find("input.column-search").off("keyup change click"),r()(G.current).off("click",".action-btn"),r()(G.current).off("draw.dt"),r()(G.current).off("responsive-display"),r()(G.current).off("column-visibility.dt"),r()(document).off("click","thead th #selectAllCheckbox"),r().fn.DataTable.isDataTable(G.current)&&(J.current.destroy(),X.current=!1)}catch(e){console.error("Error while destroying DataTable:",e)}}}},[eu,ei,N,t,z,ee,P,k]),r()(G.current).on("click","button",e=>{e.stopPropagation(),e.preventDefault()});let ep=e=>{let t=r()(G.current).DataTable(),n=t.columns().indexes().toArray().find(n=>t.column(n).dataSrc()===e);if(void 0!==n){let l=t.column(n),o=!l.visible();l.visible(o),em(t=>({...t,[e]:o})),1!==Object.values(eh).filter(Boolean).length||o||(alert("At least one column should be visible!"),l.visible(!0),em(t=>({...t,[e]:!0}))),setTimeout(()=>{t.columns.adjust().responsive.recalc().draw(!1)},200)}},[eh,em]=(0,o.useState)(()=>{let e={};return eu.forEach(t=>{e[t.accessorKey]=!t.deselected}),e}),ef=e=>{let t=new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.abs(e));return"₹ ".concat(t).concat(e<0?" CR":"")},eg=()=>eu.filter(e=>eh[e.accessorKey]),eb=async()=>{let e=r()(G.current).DataTable();e.columns().indexes().toArray();let t=eg();console.log(t);let n=t.length,l=(null==k?void 0:k.trim())?k:document.title,a={},s={},i=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],null==e||""===e||"N/A"===e)return 0;if("string"==typeof e){if(/^\d{2}\/\d{2}\/\d{4}$/.test(e))return e;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[t,n,l]=e.split("-");return"".concat(l,"/").concat(n,"/").concat(t)}}if("string"==typeof e){if(/[a-zA-Z]/.test(e))return e.trim();let t=Number.parseFloat(e.replace(/[^0-9.-]/g,"").trim());return isNaN(t)?"0":Number(t.toFixed(2))}return"number"==typeof e?Number(e.toFixed(2)):0},c=new(S()).Workbook,d=c.addWorksheet("Report",{pageSetup:{paperSize:9,orientation:"portrait",fitToPage:!0,fitToWidth:1,fitToHeight:0,margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}}});d.headerFooter.oddFooter="&L&F&C&P of &N&R&D &T";let u=(e,t)=>{d.mergeCells(e,1,e,n);let l=d.getRow(e);l.alignment={horizontal:"center",vertical:"middle"},"title"===t?(l.font={bold:!0,size:16,color:{argb:"000000"}},l.height=24):"subtitle"===t?(l.font={bold:!0,size:12,color:{argb:"000000"}},l.height=20):"section"===t?(l.font={bold:!0,size:14,color:{argb:"000000"}},l.height=22,l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}}):l.font={bold:!0,size:12}},p=d.addRow(["Pune e Stock Broking Limited"]);if(u(1,"title"),p.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"4472C4"}},e.font={bold:!0,size:16,color:{argb:"FFFFFF"}}}),d.addRow([]),z){var h,m,f;let e="FINANCIAL YEAR REPORT OF ".concat(l.replace(/_/g," ")," ").concat(O?": ".concat(O):""),t="Date Range: ".concat(K," to ").concat(W),n="Name: ".concat(null===(h=ee.userDetails)||void 0===h?void 0:h.clientName,"   |   Client ID: ").concat(ee.currentUser,"   |   PAN: ").concat(null===(m=ee.userDetails)||void 0===m?void 0:m.pan,"   |   Mobile: ").concat(null===(f=ee.userDetails)||void 0===f?void 0:f.mobile);d.addRow([e]),u(3,"subtitle"),K&&W&&d.addRow([t]),u(4),d.addRow([n]),u(5),d.addRow([]);let o=d.rowCount+1;d.addRow(["Table of Contents"]),u(o,"section");let r=[];if(r.push("1. Summary"),"object"==typeof P){let e=1;Object.keys(P).forEach((t,n)=>{r.push("   1.".concat(e,". ").concat(t)),e++})}r.push("2. Detailed Report"),r.forEach(e=>{d.addRow([e])}),d.addRow([]);let c=d.rowCount+1;if(d.addRow(["1. Summary"]),u(c,"section"),s.Summary=c,d.getCell("A".concat(o+1)).value={text:"1. Summary",hyperlink:"#'".concat(d.name,"'!A").concat(c)},d.getCell("A".concat(o+1)).font={color:{argb:"0563C1"},underline:!0},d.addRow([]),d.addRow(["Category","Amount"]).eachCell(e=>{e.font={bold:!0,size:11},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"object"==typeof P){let e=1;Object.entries(P).forEach((t,n)=>{let[l,r]=t;d.addRow([]),d.addRow(["1.".concat(e,". ").concat(l)]).font={bold:!0,size:12},s[l]=d.rowCount;let c=o+1+e;if(d.getCell("A".concat(c)).value={text:"   1.".concat(e,". ").concat(l),hyperlink:"#'".concat(d.name,"'!A").concat(s[l])},d.getCell("A".concat(c)).font={color:{argb:"0563C1"},underline:!0},"object"==typeof r&&"rows"in r){var u;if(null===(u=r.rows)||void 0===u||u.forEach(e=>{d.rowCount;let t=i(e[r.rowAmount]),n=d.addRow([e[r.rowKey],t]);n.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof n.getCell(2).value&&(n.getCell(2).numFmt="#,##0.00;[Red]-#,##0.00","number"==typeof t&&t<0&&"expenses"!==l.toLowerCase()&&(n.getCell(2).font={color:{argb:"FF0000"}}))}),null!==r.total){let e=i(r.total),t="expenses"===l.toLowerCase()?Math.abs(e):e,n=Number(t)>=0?"Profit":"Loss",o=d.addRow(["".concat(l," Total ").concat("expenses"!==l.toLowerCase()?"(".concat(n,")"):""),t]);o.font={bold:!0},o.eachCell(e=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}}}),d.getCell("B".concat(d.rowCount)).numFmt="#,##0.00;[Red]-#,##0.00",0>Number(t)&&"expenses"!==l.toLowerCase()&&(d.getCell("B".concat(d.rowCount)).font={bold:!0,color:{argb:"FF0000"}})}}else if(Array.isArray(r)){r.forEach(e=>{let t=d.rowCount+1,n=d.addRow([e.code,i(e.sum)]);if(n.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof n.getCell(2).value){n.getCell(2).numFmt="#,##0.00;[Red]-#,##0.00";let e=n.getCell(2).value;"number"==typeof e&&e<0&&(n.getCell(2).font={color:{argb:"FF0000"}})}let l="Category_".concat(e.code.replace(/\s+/g,"_"));a[e.code]=l,d.getCell("A".concat(t)).name=l});let e=r.reduce((e,t)=>{let n=i(t.sum);return e+("number"==typeof n?n:0)},0),t=d.addRow(["".concat(l," Total (").concat(e>=0?"Profit":"Loss",")"),e]);t.font={bold:!0},t.eachCell(e=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}}}),d.getCell("B".concat(d.rowCount)).numFmt="#,##0.00;[Red]-#,##0.00",e<0&&(d.getCell("B".concat(d.rowCount)).font={bold:!0,color:{argb:"FF0000"}})}else{d.rowCount;let e=d.addRow([l,i(r)]);if(e.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),"number"==typeof e.getCell(2).value){e.getCell(2).numFmt="#,##0.00;[Red]-#,##0.00";let t=e.getCell(2).value;null!=t&&"number"==typeof t&&t<0&&(e.getCell(2).font={color:{argb:"FF0000"}})}}e++})}d.addRow([]),d.addRow([]);let p=d.rowCount+1;d.addRow(["2. Detailed Report"]),u(p,"section"),s.DetailedReport=p;let g=r.findIndex(e=>"2. Detailed Report"===e)+1;d.getCell("A".concat(o+g)).value={text:"2. Detailed Report",hyperlink:"#'".concat(d.name,"'!A").concat(p)},d.getCell("A".concat(o+g)).font={color:{argb:"0563C1"},underline:!0},d.addRow([])}let g=(e,t,n)=>{if(e.cell&&"function"==typeof e.cell){var l,a,r,s,c;let n=e.cell({row:t}),d=null!==(l=e.amountToBe)&&void 0!==l?l:"string"==typeof e.header&&e.header.toLowerCase().includes("amount");if(o.isValidElement(n)){let e=document.createElement("div");return e.innerHTML=v.renderToString(n),i((null===(a=e.textContent)||void 0===a?void 0:a.trim())||(null===(r=e.innerText)||void 0===r?void 0:r.trim())||"",d)}if("string"==typeof n&&n.includes("<")){let e=document.createElement("div");return e.innerHTML=n,i((null===(s=e.textContent)||void 0===s?void 0:s.trim())||(null===(c=e.innerText)||void 0===c?void 0:c.trim())||"",d)}return i(n,d)}return i(t[e.accessorKey],e.amountToBe)},b=d.addRow(t.map(e=>e.header));b.font={bold:!0,size:11},b.alignment={horizontal:"center",vertical:"middle"},b.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9E1F2"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let x=e.rows().data().toArray(),y=e.rows().nodes().toArray(),w={};if(null==I||I.forEach(e=>{w[e]=0}),x.forEach((e,n)=>{let l=t.map((t,l)=>{let o=g(t,e,y[n]);return(null==I?void 0:I.includes(t.accessorKey))&&"number"==typeof o&&(w[t.accessorKey]=(w[t.accessorKey]||0)+o),o}),o=d.addRow(l);n%2==1&&o.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"F9F9F9"}}}),o.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),null==I?void 0:I.length){let e=t.map((e,t)=>0===t?"Total":(null==I?void 0:I.includes(e.accessorKey))?w[e.accessorKey]||0:""),n=d.addRow(e);n.font={bold:!0},n.eachCell((e,t)=>{e.border={top:{style:"double"},left:{style:"thin"},bottom:{style:"double"},right:{style:"thin"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"E2EFDA"}},"number"==typeof e.value&&(e.numFmt="#,##0.00;[Red]-#,##0.00",e.value<0&&(e.font={bold:!0,color:{argb:"FF0000"}}))})}d.columns.forEach(e=>{var t;let n=0;null===(t=e.eachCell)||void 0===t||t.call(e,{includeEmpty:!0},e=>{let t=e.value?e.value.toString().length:0;t>n&&(n=t)}),e.width=Math.min(n+4,30)}),d.addRow([]);let C=await c.xlsx.writeBuffer(),N=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),F="".concat(l,"_").concat(N,".xlsx");(0,j.saveAs)(new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),F)},ex=()=>{setTimeout(()=>{r()(".dataTable").each(function(){let e=r()(this).DataTable();r().fn.dataTable.isDataTable(this)&&(e.columns.adjust().responsive.recalc(),e.draw(!1))}),r()(".dataTable").css("width","100%")},300)};return(0,o.useEffect)(()=>(window.addEventListener("resize",ex),()=>{window.removeEventListener("resize",ex)}),[]),(0,o.useEffect)(()=>{if(G.current)return r()(G.current).on("responsive-display",(e,t,n,l)=>{let o=r()(n.node()).find(".dtr-control");l?o.addClass("expanded"):o.removeClass("expanded")}),()=>{G.current&&r()(G.current).off("responsive-display")}},[]),(0,o.useEffect)(()=>{J.current&&J.current.search(Z).draw()},[Z]),(0,l.jsxs)("div",{className:"w-full mt-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2 p-2 bg-muted rounded-lg border border-border shadow-sm sm:justify-between",children:[(0,l.jsxs)("div",{className:"relative flex items-center w-full sm:w-auto max-w-sm ",children:[(0,l.jsx)(p.A,{className:"absolute left-2 h-3 w-3 text-muted-foreground"}),(0,l.jsx)(c.p,{id:"global-search-".concat(Math.random().toString(36).substr(2,9)),type:"search",className:"w-full pl-8 pr-10 h-9 rounded-md border bg-background text-xs focus:ring focus:ring-ring custom-search-input",placeholder:"Search all columns...",value:Z,onChange:e=>{q(e.target.value)}}),Z&&(0,l.jsx)(s.$,{size:"sm",variant:"ghost",className:"absolute right-1 hover:text-foreground hover:bg-transparent",onClick:()=>q(""),children:(0,l.jsx)(h.A,{className:"h-1 w-1 p-0 m-0"})})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto sm:flex-row sm:gap-4",children:[_&&(0,l.jsxs)("button",{className:"px-3 py-2 flex items-center gap-2 rounded-md border border-border bg-background text-xs font-medium hover:bg-muted",onClick:()=>{J.current&&(J.current.columns().search("").draw(),r()(G.current).find(".column-search").each(function(){this.value="",this.setAttribute("value",""),r()(this).trigger("input"),r()(this).trigger("change"),r()(this).trigger("keyup")}),r()(".custom-search-input").each(function(){this.value="",this.setAttribute("value",""),r()(this).trigger("input").trigger("change").trigger("keyup")}),q(""),J.current.columns().every(function(){this.search("").draw()}),J.current.draw(),setTimeout(()=>{document.querySelectorAll(".column-search").forEach(e=>{e.value=""})},50))},children:[(0,l.jsx)(m.A,{className:"h-3 w-3"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Clear"})]}),B&&(0,l.jsxs)(u.AM,{open:en,onOpenChange:el,children:[(0,l.jsx)(u.Wv,{asChild:!0,children:(0,l.jsxs)(s.$,{variant:"outline",className:"flex items-center gap-2 p-1 px-2",children:[(0,l.jsx)(f.A,{className:"h-3 w-3"}),(0,l.jsx)("span",{className:"hidden sm:inline text-xs",children:"Columns"}),(0,l.jsx)(g.A,{className:"h-3 w-3"})]})}),(0,l.jsx)(u.hl,{align:"end",className:"w-[200px] p-0",children:(0,l.jsx)(d.uB,{children:(0,l.jsx)(d.L$,{children:t.filter(e=>!0!==e.hidden).map(e=>{var t;let n=null!==(t=eh[e.accessorKey])&&void 0!==t&&t;return(0,l.jsxs)(d.h_,{onSelect:()=>ep(e.accessorKey),disabled:e.disabled,children:[(0,l.jsx)(b.A,{className:"mr-2 h-3 w-3 transition-opacity duration-150 ".concat(n?"opacity-100":"opacity-0")}),e.header]},e.accessorKey||e.id)})},k)})})]}),U&&V&&$&&(0,l.jsxs)(i.rI,{children:[(0,l.jsx)(i.ty,{asChild:!0,children:(0,l.jsxs)("button",{className:"px-3 py-2 flex items-center gap-2 rounded-md border border-border bg-background text-xs font-medium hover:bg-muted",children:[(0,l.jsx)(x.A,{className:"h-3 w-3"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Export"}),(0,l.jsx)(g.A,{className:"h-3 w-3"})]})}),(0,l.jsxs)(i.SQ,{align:"end",className:"w-[80px] text-xs",children:[V&&(0,l.jsxs)(i.hO,{onClick:()=>{let e=r()(G.current).DataTable(),n=e.columns().indexes().toArray().map(t=>e.column(t).visible()),l=t.filter((e,t)=>n[t+1]),a=e.rows().data().toArray(),s=e=>{let t=Array(l.length).fill("");return t[0]=e,t},i=(e,t)=>{let n="";if(e.cell&&"function"==typeof e.cell){let l=e.cell({row:t});if(o.isValidElement(l)){let e=v.renderToString(l),t=document.createElement("div");t.innerHTML=e,n=t.textContent||t.innerText||""}else if("string"==typeof l&&l.includes("<")){let e=document.createElement("div");e.innerHTML=l,n=e.textContent||e.innerText||""}else n=null!=l?l:""}else{var l;n=null!==(l=t[e.accessorKey])&&void 0!==l?l:""}return isNaN(Number(n=String(n).trim()))||""===n?"string"==typeof n&&n.includes("₹")?""===(n=n.replace(/[^0-9.-]/g,""))||isNaN(Number(n))?n:Number(n):(n=n.replace(/"/g,'""')).includes(",")||n.includes("\n")||n.includes('"')?'"'.concat(n,'"'):n:Number(n)},c=e=>'"'.concat(ef(e).replace(/,/g,"\xa0"),'"'),d=[s("Pune e Stock Broking Limited")];if(z){var u;d.push(s("")),d.push(["Name: ".concat(null===(u=ee.userDetails)||void 0===u?void 0:u.clientName,"                    Client ID: ").concat(ee.currentUser)]),d.push([""]),"object"==typeof P&&Object.entries(P).forEach(e=>{let[t,n]=e;if("object"==typeof n&&"rows"in n){d.push([t]);let e=n.rows.map(e=>[e[n.rowKey],c(e[n.rowAmount])]);if(null!==n.total){let l=c(n.total),o=n.total>=0?"Profit":"Loss";e.push(["".concat(t," Total (").concat(o,")"),l])}d=[...d,...e,[]]}else{let e=c(n);d.push(["".concat(t,":"),e])}}),d.push([""])}d.push(s("Detailed Report")),d.push([""]);let p=d.flatMap(e=>{let t=e.join(",").trim();return""!==t?["# ".concat(t)]:[""]}).filter(Boolean);p.push("# --- START OF DATA ---"),l.map(e=>'"'.concat(e.header,'"')).join(","),a.map(e=>l.map(t=>{var n;return null!==(n=i(t,e))&&void 0!==n?n:""}).join(","));let h=[...p,""];h.push(l.map(e=>e.header).join(",")),a.forEach(e=>{h.push(l.map(t=>{var n;return null!==(n=i(t,e))&&void 0!==n?n:""}).join(","))});let m=new Blob(["\uFEFF"+h.join("\n")],{type:"text/csv;charset=utf-8;"}),f=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),g=document.createElement("a"),b=URL.createObjectURL(m);g.setAttribute("href",b);let x=(null==k?void 0:k.trim())?k:document.title;g.setAttribute("download","".concat(x,"_").concat(f,".csv")),document.body.appendChild(g),g.click(),document.body.removeChild(g)},className:"flex items-center gap-1 justify-around p-2",children:[(0,l.jsx)(E.default,{src:"/images/SVG/csv.svg",alt:"CSV icon",width:15,height:15,priority:!0,className:"cursor-pointer m-1"}),"CSV"]}),U&&(0,l.jsxs)(i.hO,{onClick:eb,className:"flex items-center gap-1 justify-around p-2",children:[(0,l.jsx)(E.default,{src:"/images/SVG/excel.svg",alt:"Excel icon",width:20,height:20,priority:!0,className:"cursor-pointer m-1"}),"Excel"]}),$&&(0,l.jsxs)(i.hO,{onClick:()=>{let e=r()(G.current).DataTable();e.columns().indexes().toArray();let t=eg(),n=t.length,l=e.rows().data().toArray(),a=(e,t)=>{let n="";if(e.cell&&"function"==typeof e.cell){let l=e.cell({row:t});if(o.isValidElement(l)){let e=document.createElement("div");e.innerHTML=v.renderToString(l),n=e.textContent||e.innerText||""}else if("string"==typeof l&&l.includes("<")){let e=document.createElement("div");e.innerHTML=l,n=e.textContent||e.innerText||""}else n=null!=l?l:""}else{var l;n=null!==(l=t[e.accessorKey])&&void 0!==l?l:""}return 1===(n=String(n).trim()).length?n:((e=>"string"==typeof e&&e.match(/₹|\$|,/)&&!e.match(/[a-zA-Z]/)&&e.trim().length<16)(n)&&(n=n.replace(/[^0-9.-]/g,"")),(e=>"string"==typeof e&&!isNaN(Number(e))&&!/[a-zA-Z]/.test(e)&&/^-?\d+(\.\d+)?$/.test(e.trim())&&e.trim().length<16)(n))?Number(n).toFixed(2):n},s=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],null==e||""===e||"N/A"===e)return 0;if("string"==typeof e){if(/^\d{2}\/\d{2}\/\d{4}$/.test(e))return e;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[t,n,l]=e.split("-");return"".concat(l,"/").concat(n,"/").concat(t)}}if("string"==typeof e){if(/[a-zA-Z]/.test(e))return e.trim();let t=Number.parseFloat(e.replace(/[^0-9.-]/g,"").trim());return isNaN(t)?"0":Number(t.toFixed(2))}return"number"==typeof e?Number(e.toFixed(2)):0},i=new C.default({orientation:"portrait",unit:"mm",format:"a4"}),c=(null==k?void 0:k.trim())?k:document.title,d=i.internal.pageSize.width,u=i.internal.pageSize.height,p=d-10,h=15;if(z){var m,f,g,b,x;i.setProperties({title:"Report - ".concat((null===(m=ee.userDetails)||void 0===m?void 0:m.clientName)||"-"),subject:"Client Report: ".concat(ee.currentUser||"-"),author:"Pune e Stock Broking Limited",creator:"Pune e Stock Broking Limited"}),i.setFillColor(20,60,120),i.rect(5,h-5,p,22,"F"),i.setFillColor(40,80,140),i.rect(5,h-5,p,2,"F"),i.setFillColor(10,40,100),i.rect(5,h+5,p,2,"F"),i.setFont("helvetica","bold"),i.setFontSize(14),i.setTextColor(255,255,255),i.text("Pune e Stock Broking Limited",d/2,h+2,{align:"center"}),h+=4,i.setFont("helvetica","normal"),i.setFontSize(7.5),i.setTextColor(255,255,255),i.text("1198 Shukrawar Peth, Subhash Nagar Lane No.3 Pune, Maharashtra, India, Tel No. 020-41000600 / 020-24496162 Fax No. 020-24498100",d/2,h+2,{align:"center",maxWidth:p}),h+=3,i.text("SEBI Registration No: NSE-EQ: INB231289233, NSE-F&O: INF231289233, NSE-CDS: INF231289233, BSE-EQ: INB011289239, MCX-SX: INZ000027030",d/2,h+2,{align:"center",maxWidth:p}),h+=3,i.text("BSE-EQ: INB0, BSE-F&O: INF, MCX-SX: INE",d/2,h+2,{align:"center",maxWidth:p}),h+=12,i.setFillColor(240,245,250),i.rect(5,h-2,p,10,"F"),i.setTextColor(20,60,120),i.setFontSize(11),i.text("FINANCIAL YEAR REPORT - ".concat(c.replace(/_/g," ")),d/2,h+2,{align:"center"}),h+=10,O&&(i.setFontSize(9),i.setTextColor(50,50,80),i.setFont("helvetica","bold"),i.text("Financial Year:",10,h),i.setFont("helvetica","normal"),i.text(O||"-",40,h)),K&&W&&(i.setFont("helvetica","bold"),i.text("Date Range:",d-80,h),i.setFont("helvetica","normal"),i.text("".concat(K||"-"," to ").concat(W||"-"),d-5-5,h,{align:"right"})),h+=8,i.setFillColor(248,248,248),i.rect(5,h-2,p,28,"F"),i.setDrawColor(100,100,120),i.setLineWidth(.3),i.rect(5,h-2,p,28,"S"),i.setFillColor(230,230,235),i.rect(6,h-1,p-2,6,"F"),i.setFontSize(9),i.setTextColor(50,50,80),i.setFont("helvetica","bold"),i.text("CLIENT INFORMATION",d/2,h+3,{align:"center"}),h+=10;let e=d/2+5,t=d-5-5;i.setFontSize(8),i.setTextColor(50,50,50),i.setFont("helvetica","bold"),i.text("Client Name:",10,h),i.setFont("helvetica","normal"),i.text((null===(f=ee.userDetails)||void 0===f?void 0:f.clientName)||"-",40,h),i.setFont("helvetica","bold"),i.text("PAN:",e,h),i.setFont("helvetica","normal"),i.text((null===(g=ee.userDetails)||void 0===g?void 0:g.pan)||"-",t,h,{align:"right"}),h+=6,i.setFont("helvetica","bold"),i.text("Client ID:",10,h),i.setFont("helvetica","normal"),i.text(ee.currentUser||"-",40,h),i.setFont("helvetica","bold"),i.text("Mobile:",e,h),i.setFont("helvetica","normal"),i.text((null===(b=ee.userDetails)||void 0===b?void 0:b.mobile)||"-",t,h,{align:"right"}),h+=6,(null===(x=ee.userDetails)||void 0===x?void 0:x.email)&&(i.setFont("helvetica","bold"),i.text("Email:",10,h),i.setFont("helvetica","normal"),i.text(ee.userDetails.email||"-",40,h)),h+=12,"object"==typeof P&&(i.setFillColor(245,222,179),i.rect(5,h-5,p,8,"F"),i.setFontSize(10),i.setFont("helvetica","bold"),i.setTextColor(80,40,20),i.text("FINANCIAL SUMMARY",d/2,h,{align:"center"}),h+=10,Object.entries(P).forEach(e=>{let[t,n]=e,l="expenses"===t.toLowerCase();if("object"==typeof n&&"rows"in n){let e=(n.total||0)>=0;i.setFillColor(e?220:240,e?240:230,220),i.rect(5,h-5,p,8,"F"),i.setDrawColor(180,180,190),i.setLineWidth(.2),i.rect(5,h-5,p,8,"S"),i.setFontSize(9),i.setFont("helvetica","bold"),i.setTextColor(50,50,80),i.text(t.toUpperCase(),10,h+1),h+=4;let o=n.rows.map(e=>[e[n.rowKey],s(e[n.rowAmount])]);if(null!==n.total){let e=s(n.total),a=n.total>=0?"Profit":"Loss";o.push(["".concat(t," Total ").concat(l?"":"(".concat(a,")")),e])}F()(i,{startY:h,body:o,styles:{fontSize:7,cellPadding:2,lineWidth:.1},theme:"grid",margin:{left:5,right:5},columnStyles:{0:{cellWidth:.7*p,fontStyle:"normal"},1:{cellWidth:.3*p,halign:"right"}},didParseCell:t=>{t.row.index===o.length-1&&(t.cell.styles.fontStyle="bold",t.cell.styles.fillColor=[e?220:240,e?240:230,220],t.cell.styles.textColor=[50,50,80]),1===t.column.index&&(t.cell.styles.halign="right")}}),h=i.lastAutoTable.finalY+8}else{let e=s(n);i.setFontSize(8),i.setFont("helvetica","bold"),i.text("".concat(t,":"),10,h+2),i.setFont("helvetica","normal"),i.text("".concat(l?Math.abs(Number(e)):String(e)),35,h+2),h+=6}})),i.addPage()}h=15,i.setFillColor(245,222,179),i.rect(5,h-5,p,8,"F"),i.setFont("helvetica","bold"),i.setFontSize(11),i.setTextColor(80,40,20),i.text("DETAILED REPORT",d/2,h,{align:"center"}),h+=10;let y=[t.map(e=>e.header)],w=l.map(e=>t.map(t=>s(a(t,e)))),N=Array(n).fill("");null==I||I.forEach(n=>{let l=e.columns().indexes().toArray().find(t=>e.column(t).dataSrc()===n);if(void 0===l)return;let o=e.column(l,{search:"applied"}).data().reduce((e,t)=>Number.parseFloat(e.toString())+Number.parseFloat(t),0),a=t.findIndex(e=>e.accessorKey===n);-1!==a&&(N[a]=o.toFixed(2))}),w.push(N),F()(i,{startY:h,head:y,body:w,styles:{fontSize:6.5,cellPadding:1.5,overflow:"linebreak",lineWidth:.1},headStyles:{fillColor:[40,80,140],textColor:255,fontSize:7,fontStyle:"bold",cellPadding:1.5},alternateRowStyles:{fillColor:[245,245,248]},margin:{left:5,right:5},didParseCell:e=>{if(e.cell.text&&"string"==typeof e.cell.text){let t=e.cell.text;/^-?\d+\.\d+$/.test(t)?e.cell.styles.halign="right":/^\d{1,2}[-/]\d{1,2}[-/]\d{2,4}$/.test(t)&&(e.cell.styles.halign="center")}e.row.index===w.length-1&&(e.cell.styles.fontStyle="bold",e.cell.styles.fillColor=[230,230,235],e.cell.styles.textColor=[50,50,80])},willDrawCell:e=>{e.cell.height<6&&(e.cell.height=6)},columnStyles:(()=>{let e={};return t.forEach((t,n)=>{let l=t.header.toLowerCase();l.includes("date")?e[n]={cellWidth:18,halign:"center"}:(l.includes("amount")||l.includes("price")||l.includes("value")||l.includes("total"))&&(e[n]={cellWidth:22,halign:"right"})}),e})()}),(e=>{let t=e.internal.getNumberOfPages();for(let n=1;n<=t;n++){e.setPage(n),e.setDrawColor(200,200,200),e.setLineWidth(.1),e.line(5,u-8,d-5,u-8),e.setFontSize(7),e.setFont("helvetica","normal"),e.setTextColor(100,100,100);let l=new Date().toLocaleDateString("en-IN");e.text("Generated on: ".concat(l),5,u-5),e.setFont("helvetica","bold"),e.text("Pune e Stock Broking Limited",d/2,u-5,{align:"center"}),e.setFont("helvetica","normal"),e.text("Page ".concat(n," of ").concat(t),d-5,u-5,{align:"right"})}})(i);let S=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),j="".concat(c,"_").concat(S,".pdf");i.save(j)},className:"flex items-center gap-1 justify-around p-2",children:[(0,l.jsx)(E.default,{src:"/images/SVG/pdfSvg.svg",alt:"PDF icon",width:20,height:20,priority:!0,className:"cursor-pointer m-1"}),"PDF"]})]})]}),N&&(0,l.jsxs)("div",{className:"ml-auto",children:[(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"Show"}),(0,l.jsxs)("select",{title:"entries",className:"h-8 px-1 rounded-md border border-border bg-background text-xs mx-1",onChange:e=>{J.current&&J.current.page.len(Number.parseInt(e.target.value)).draw()},children:[(0,l.jsx)("option",{value:"10",children:"10"}),(0,l.jsx)("option",{value:"25",children:"25"}),(0,l.jsx)("option",{value:"50",children:"50"}),(0,l.jsx)("option",{value:"100",children:"100"})]}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"entries"})]})]})]}),(0,l.jsx)("div",{className:"rounded-md",children:(0,l.jsxs)("table",{id:Y,ref:G,className:"row-border hover cell-border",children:[(0,l.jsx)("thead",{}),(0,l.jsx)("tbody",{}),I&&(0,l.jsx)("tfoot",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{style:{display:"none"}}),D&&(0,l.jsx)("th",{}),ec.map((e,t)=>(0,l.jsx)("th",{"data-column-id":e.accessorKey,children:(I.includes(e.accessorKey),"")},t))]})})]})})]})}},94831:(e,t,n)=>{n.d(t,{G7:()=>c,L$:()=>p,h_:()=>h,oI:()=>d,uB:()=>i,xL:()=>u});var l=n(95155),o=n(12115),a=n(7859),r=n(20853),s=n(21567);n(51344);let i=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,l.jsx)(a.uB,{ref:t,className:(0,s.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",n),...o})});i.displayName=a.uB.displayName;let c=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,l.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,l.jsx)(r.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,l.jsx)(a.uB.Input,{ref:t,className:(0,s.cn)("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",n),...o})]})});c.displayName=a.uB.Input.displayName;let d=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,l.jsx)(a.uB.List,{ref:t,className:(0,s.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",n),...o})});d.displayName=a.uB.List.displayName;let u=o.forwardRef((e,t)=>(0,l.jsx)(a.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));u.displayName=a.uB.Empty.displayName;let p=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,l.jsx)(a.uB.Group,{ref:t,className:(0,s.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",n),...o})});p.displayName=a.uB.Group.displayName,o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,l.jsx)(a.uB.Separator,{ref:t,className:(0,s.cn)("-mx-1 h-px bg-border",n),...o})}).displayName=a.uB.Separator.displayName;let h=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,l.jsx)(a.uB.Item,{ref:t,className:(0,s.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n),...o})});h.displayName=a.uB.Item.displayName}}]);
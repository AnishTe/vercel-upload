(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6622],{33195:(e,t,a)=>{Promise.resolve().then(a.bind(a,59121))},65753:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},80175:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]])},61594:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},93650:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]])},69660:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]])},3265:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("ReceiptText",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M14 8H8",key:"1l3xfs"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"M13 16H8",key:"wsln4y"}]])},83489:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},77711:(e,t,a)=>{"use strict";a.d(t,{default:()=>l.a});var r=a(21956),l=a.n(r)},21956:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=a(60306)._(a(30580));function l(e,t){var a;let l={};"function"==typeof e&&(l.loader=e);let s={...l,...t};return(0,r.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},39827:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let r=a(93719);function l(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return a}},30580:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let r=a(95155),l=a(12115),s=a(39827),n=a(79214);function i(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},c=function(e){let t={...d,...e},a=(0,l.lazy)(()=>t.loader().then(i)),c=t.loading;function o(e){let i=c?(0,r.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,d=!t.ssr||!!t.loading,o=d?l.Suspense:l.Fragment,u=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(o,{...d?{fallback:i}:{},children:u})}return o.displayName="LoadableComponent",o}},79214:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return i}});let r=a(95155),l=a(47650),s=a(75861),n=a(18284);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=s.workAsyncStorage.getStore();if(void 0===a)return null;let i=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files;i.push(...t)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>{let t=a.assetPrefix+"/_next/"+(0,n.encodeURIPath)(e);return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,l.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},59121:(e,t,a)=>{"use strict";a.d(t,{default:()=>S});var r=a(95155),l=a(12115),s=a(43932),n=a.n(s),i=a(22130),d=a(73312),c=a(61594),o=a(83489),u=a(93650),h=a(37528),p=a(25121),f=a(30814),m=a(47282),y=a(67328),x=a(12711),b=a(85147),j=a(55546);a(33900);let v=[{id:"clientId",accessorKey:"clientId",header:"Client ID",cell:e=>{var t;let{row:a}=e,l=null!==(t=a.original.clientId)&&void 0!==t?t:"-";return(0,r.jsx)("div",{className:"font-medium",children:l})}},{id:"scrip",accessorKey:"scrip",header:"Scrip Name",hidden:!0},{id:"branchcode",accessorKey:"branchcode",header:"Branch Code"},{id:"boidinp",accessorKey:"boid",header:"BOID"},{id:"quantity",accessorKey:"quantity",header:"Free Quantity"},{id:"pledgedquantity",accessorKey:"pledgedquantity",header:"Pledged"},{id:"alreadyApplied",accessorKey:"alreadyApplied",header:"Already Applied"},{id:"applyQuantityInp",accessorKey:"quantity",header:"Apply"},{id:"isin",accessorKey:"isin",header:"ISIN",hidden:!0}];var g=a(65753),k=a(69660),N=a(72508),w=a(77711),A=a(74317),M=a(68678);let C=(0,w.default)(()=>Promise.all([a.e(2226),a.e(7690),a.e(9190),a.e(1122),a.e(2449),a.e(7981),a.e(853)]).then(a.bind(a,17981)),{loadableGenerated:{webpack:()=>[17981]},ssr:!1});function S(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(!1),[w,S]=(0,l.useState)(null),[P,q]=(0,l.useState)(!1),[O,I]=(0,l.useState)(!1);(0,j.U)("(max-width: 640px)");let[_,R]=(0,l.useState)([]),[E,B]=(0,l.useState)(""),[D,K]=(0,l.useState)(null),[T,F]=(0,l.useState)([]),H=(0,l.useRef)(null),z=(0,l.useRef)([]),L=(0,l.useRef)(null),Q=(0,l.useCallback)(()=>{if(!H.current)return[];let e=n()(H.current).find("table");if(!e)return[];let t=e.DataTable(),a=t.rows({selected:!0}).nodes();return t.rows({selected:!0}).data().toArray().map((e,t)=>{let r=n()(a[t]),l=r.next("tr.child"),s={};return r.add(l).find("input, select, textarea").each(function(){let e=n()(this).attr("name")||n()(this).attr("data-id");e&&(s[e]=this.value)}),{...e,inputs:s}})},[]),Z=(0,l.useCallback)(async()=>{s(!0),S(null);try{let e=await (0,m.D5k)();if(!(0,y.k9)(e)){I(!0);return}let t="string"==typeof e.data.data?JSON.parse(e.data.data):e.data.data;if(t)R(t.map(e=>({scrip:e.scrip,value:e.buybackid.toString(),isin:e.isin,fromdate:e.fromdate,todate:e.todate,buybackprice:e.buybackprice,nsesettno:e.nsesettno,bsesettno:e.bsesettno})));else throw Error(t["Error Description"]||"Failed to fetch template data.")}catch(e){S(e.message||"An error occurred while fetching data.")}finally{s(!1)}},[]);(0,l.useEffect)(()=>{Z()},[Z]);let V=(0,l.useCallback)(async e=>{s(!0),S(null);try{let a=await (0,m.lm3)({isin:e});if(!(0,y.k9)(a)){I(!0);return}let r="string"==typeof a.data.data?JSON.parse(a.data.data):a.data.data;r&&Object.keys(r).length>0?t(r):t([])}catch(e){S(e.message||"An error occurred while fetching data.")}finally{s(!1)}},[]),J=async()=>{var e,t;if(0===T.length){f.oR.error("Please select at least one row.");return}s(!0);try{let t=T.map(e=>({applied:e.inputs.quantity||e.applied,clientId:e.clientId.toString(),quantity:e.quantity,boid:e.boid,scrip:e.scrip,isin:e.isin,buybackid:E,branchcode:e.branchcode.toString(),orderType:"CDSL"})),a=await (0,m.KI1)({data:t});if(!(0,y.k9)(a)){I(!0);return}let l=a.data;if(l&&l.data){let t=l.data.every(e=>!0===e.status),a=l.data.map(e=>{var t,a;let r=(null===(t=e.request)||void 0===t?void 0:t.clientId)||"N/A",l=(null===(a=e.request)||void 0===a?void 0:a.applied)||"N/A",s=e.message||(e.status?"Application submitted successfully.":"Application failed.");return!0===e.status?"✔️ Client ".concat(r,": Applied ").concat(l," – ").concat(s):"❌ Client ".concat(r,": Applied ").concat(l," – ").concat(s)}),s=(0,r.jsx)("div",{children:a.map((e,t)=>(0,r.jsx)("div",{children:e},t))});t?f.oR.success(s):f.oR.error(s),t&&await V((null===(e=_.find(e=>e.value===E))||void 0===e?void 0:e.isin)||"")}else f.oR.error("Buyback request failed. Please try again.")}catch(e){console.error("Error during buyback application:",e),f.oR.error("An error occurred while applying for buyback. Please try again later.")}finally{s(!1),q(!1),null===(t=L.current)||void 0===t||t.close()}},G=e=>{let t=n()(e),a=JSON.parse((t.closest("tr").hasClass("child")?t.closest("tr").prev():t.closest("tr")).attr("data-row-data")||"{}"),r=parseInt(t.val()),l=parseInt(a.quantity),s=Number.parseInt(a.alreadyApplied)||0,i=l-s;return isNaN(r)||r<0?(U(t,"*Quantity should not be blank or zero."),!1):r>i?(U(t,"*Already applied Quantity ".concat(s,". Available Quantity : ").concat(i)),!1):r>l?(U(t,"*Quantity cannot exceed the free quantity."),!1):(a.applied=r,W(t),!0)},U=(e,t)=>{e.addClass("border-red-500"),e.next(".error-message").length||e.after('<span class="error-message text-red-500" style="display: block;">'.concat(t,"</span>"))},W=e=>{e.removeClass("border-red-500"),e.next(".error-message").remove()},X=()=>{let e=!0;if(!H.current)return!0;let t=n()(H.current).find("table");if(!t.length)return!0;try{let a=t.DataTable().rows({selected:!0}).nodes();n()(a).each(function(){let t=n()(this),a=t.next("tr.child");t.add(a).find("input[name='quantity']").each(function(){G(this)||(e=!1)})})}catch(t){console.error("Error in validateAllInputs:",t),n()("input[name='quantity']").each(function(){G(this)||(e=!1)})}return e};return(0,l.useEffect)(()=>{if(H.current&&0!==e.length)return n()(H.current).on("input","input[name='quantity']",function(){G(this)}),()=>{H.current&&n()(H.current).off("input","input[name='quantity']")}},[e]),(0,r.jsxs)(x.default,{children:[(0,r.jsxs)(i.Zp,{className:"w-full",children:[(0,r.jsxs)(i.aR,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-2 sm:space-y-0",children:[(0,r.jsx)(i.ZB,{children:"Buyback"}),(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2 rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800 dark:border-amber-800/30 dark:bg-amber-900/30 dark:text-amber-200",children:[(0,r.jsx)(c.A,{className:"h-3.5 w-3.5 flex-shrink-0"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"NOTE:"})," On End Date Cut_Off time to place order is 12:00 PM."]})]})]}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsx)("div",{className:"bg-slate-50 rounded-md p-1 mb-2",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-3 items-start md:items-center justify-between",children:[(0,r.jsx)("div",{className:"w-full md:w-auto",children:(0,r.jsx)("div",{className:"relative w-full md:w-[260px]",children:(0,r.jsxs)(h.l6,{value:E,onValueChange:e=>{if(!e||"NONE"===e){f.oR.error("Please select a company."),B(""),t([]),K(null);return}B(e);let a=_.find(t=>t.value===e);a&&(K(a),V(a.isin))},children:[(0,r.jsx)(h.bq,{className:"w-full bg-white h-9",children:(0,r.jsx)(h.yv,{placeholder:"Select a company"})}),(0,r.jsxs)(h.gC,{children:[(0,r.jsx)(h.eb,{value:"NONE",children:"Select a company"}),_.map(e=>(0,r.jsx)(h.eb,{value:e.value,children:e.scrip},e.value))]})]})})}),D&&"NONE"!==E?(0,r.jsx)(r.Fragment,{children:e.length>0&&(0,r.jsxs)(d.$,{onClick:()=>{let e=Q();if(0===e.length){f.oR.error("Please select at least one");return}if(z.current=e,F(e),X()){var t;null===(t=L.current)||void 0===t||t.open()}else f.oR.error("Please review the details before confirming.")},className:"w-full sm:w-auto",size:"sm",children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Apply Buyback"]})}):null]})}),(0,r.jsx)(M.A,{selectedCompanyDetails:D}),E&&"NONE"!==E?(0,r.jsx)(r.Fragment,{children:a?(0,r.jsx)(b.A,{columns:4,rows:10}):w?(0,r.jsx)("div",{className:"text-center text-red-500 p-4 bg-red-100 rounded-md",children:w}):0===e.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-4 text-center bg-muted/20 rounded-md border border-dashed border-muted-foreground/20 my-4",children:[(0,r.jsx)("div",{className:"rounded-full bg-muted p-3 mb-4",children:(0,r.jsx)(u.A,{className:"h-8 w-8 text-muted-foreground"})}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No records found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4 max-w-md",children:"There are no records available for this criteria."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",ref:H,children:(0,r.jsx)(C,{columns:v,data:e,selectableRows:!0,showPagination:!0},"buyback_table")})}):null]})]}),(0,r.jsx)(A.A,{ref:L,title:"Confirm Buyback ?",onConfirm:J,confirmLoading:!1,confirmText:"Confirm",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-base font-medium",children:"Are you sure you want to buyback?"}),D&&(0,r.jsx)("div",{className:"flex flex-col space-y-2 p-3 bg-slate-50 rounded-md",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),(0,r.jsx)("span",{className:"font-semibold",children:D.scrip}),D.buybackprice>0&&(0,r.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"ISIN:"}),(0,r.jsx)(p.E,{variant:"secondary",className:"font-medium",children:D.isin})]})]})})]}),(0,r.jsx)("div",{className:"rounded-md border overflow-hidden",children:(0,r.jsxs)(N.XI,{children:[(0,r.jsx)(N.A0,{children:(0,r.jsxs)(N.Hj,{children:[(0,r.jsx)(N.nd,{className:"w-1/3",children:"ClientId"}),(0,r.jsx)(N.nd,{className:"w-1/4",children:"Quantity"})]})}),(0,r.jsx)(N.BF,{children:T&&T.length>0?T.map((e,t)=>{var a;return(0,r.jsxs)(N.Hj,{children:[(0,r.jsx)(N.nA,{className:"font-medium",children:e.clientId}),(0,r.jsx)(N.nA,{className:"font-medium",children:(null===(a=e.inputs)||void 0===a?void 0:a.quantity)||"-"})]},t)}):(0,r.jsx)(N.Hj,{children:(0,r.jsx)(N.nA,{colSpan:3,className:"text-center py-4",children:"No shares selected"})})})]})}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground mt-2",children:(0,r.jsx)("p",{children:"Please review the details before confirming."})})]})}),O&&(0,r.jsx)(y.Bs,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3740,1181,8526,8562,164,2589,814,8007,5565,9526,6143,4015,8665,6527,6137,7555,7328,9086,1816,8441,1517,7358],()=>t(33195)),_N_E=e.O()}]);
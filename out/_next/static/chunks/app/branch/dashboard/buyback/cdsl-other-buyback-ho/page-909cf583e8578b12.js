(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2766],{47603:(e,r,s)=>{Promise.resolve().then(s.bind(s,34376))},34376:(e,r,s)=>{"use strict";s.d(r,{default:()=>K});var t=s(95155),a=s(12115),l=s(43932),n=s.n(l),i=s(22130),d=s(73312),c=s(61594),o=s(62060),m=s(93650),u=s(37528),x=s(25121),h=s(30814),p=s(45686),f=s(47282),j=s(72508),g=s(67328),y=s(12711),b=s(51344),N=s(69606),v=s(85060),C=s(43415),w=s(33900),D=s(98986),S=s(44870),I=s(84179),k=s(48617),R=s(89095);let E=e=>{let r={clientId:C.Yj().min(1,"UCC is required"),branchCode:C.Yj().min(1,"Branch Code is required"),quantity:C.ai().positive("Quantity must be positive"),depositoryType:C.k5(["CDSL","NSDL"])};return"CDSL"===e?C.Ik({...r,cdslBoId:C.Yj().regex(/^\d{16}$/,"BO ID must be 16 digits")}):C.Ik({...r,dpId:C.Yj().regex(/^\d{6}$/,"DP ID must be 8 digits"),boId:C.Yj().regex(/^\d{8}$/,"BO ID must be 8 digits")})},L=e=>{let{content:r}=e,[s,l]=(0,a.useState)(!1),n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=n.current;if(!e)return;let r=()=>l(!0),s=()=>l(!1);return e.addEventListener("mouseenter",r),e.addEventListener("mouseleave",s),()=>{e.removeEventListener("mouseenter",r),e.removeEventListener("mouseleave",s)}},[]),(0,t.jsxs)(R.AM,{open:s,onOpenChange:l,children:[(0,t.jsx)(R.Wv,{asChild:!0,children:(0,t.jsx)(d.$,{ref:n,variant:"ghost",size:"sm",className:"p-0 h-auto ml-1",children:(0,t.jsx)(k.A,{size:16})})}),(0,t.jsxs)(R.hl,{className:"min-w-[50px] max-w-[250px] p-4 m-2 bg-gray-800 text-white rounded-md shadow-md relative",sideOffset:5,children:[(0,t.jsx)("div",{className:"absolute right-1 top-1"}),(0,t.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,t.jsx)("p",{className:"text-sm",children:r})})]})]})};function O(e){let{isOpen:r,onClose:s,onSubmit:l,companyDetails:n}=e,[i,c]=(0,a.useState)("CDSL"),o=(0,N.mN)({resolver:(0,v.u)(E(i)),defaultValues:{clientId:"",branchCode:"",quantity:0,depositoryType:"CDSL",..."CDSL"===i?{cdslBoId:""}:{dpId:"",boId:""}}}),m=e=>{c(e),o.reset({...o.getValues(),depositoryType:e,..."CDSL"===e?{cdslBoId:""}:{dpId:"",boId:""}})};return(0,t.jsx)(b.lG,{open:r,onOpenChange:e=>!e&&s(),children:(0,t.jsxs)(b.Cf,{className:"sm:max-w-[425px]",children:[(0,t.jsx)(b.c7,{children:(0,t.jsx)(b.L3,{children:"Apply Buyback"})}),(0,t.jsx)(S.lV,{...o,children:(0,t.jsxs)("form",{onSubmit:o.handleSubmit(e=>{l({...e,scripName:(null==n?void 0:n.scrip)||"",isin:(null==n?void 0:n.isin)||""}),s()}),className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(D.J,{htmlFor:"scripName",className:"text-right",children:"Scrip Name"}),(0,t.jsx)(w.p,{id:"scripName",value:(null==n?void 0:n.scrip)||"",className:"col-span-3",readOnly:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(D.J,{htmlFor:"isin",className:"text-right",children:"ISIN"}),(0,t.jsx)(w.p,{id:"isin",value:(null==n?void 0:n.isin)||"",className:"col-span-3",readOnly:!0})]}),(0,t.jsx)(S.zB,{control:o.control,name:"clientId",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"UCC"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(w.p,{...r})}),(0,t.jsx)(S.C5,{})]})]})}}),(0,t.jsx)(S.zB,{control:o.control,name:"branchCode",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"Branch Code"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(w.p,{...r})}),(0,t.jsx)(S.C5,{})]})]})}}),(0,t.jsx)(S.zB,{control:o.control,name:"quantity",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"Quantity"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(w.p,{...r,type:"number",onChange:e=>r.onChange(Number(e.target.value))})}),(0,t.jsx)(S.C5,{})]})]})}}),(0,t.jsx)(S.zB,{control:o.control,name:"depositoryType",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"Depository"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsxs)(I.z,{value:i,onValueChange:e=>{r.onChange(e),m(e)},className:"flex space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(I.C,{value:"CDSL",id:"cdsl"}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(D.J,{htmlFor:"cdsl",children:"CDSL"}),(0,t.jsx)(L,{content:"Central Depository Services Limited"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(I.C,{value:"NSDL",id:"nsdl"}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(D.J,{htmlFor:"nsdl",children:"NSDL"}),(0,t.jsx)(L,{content:"National Securities Depository Limited"})]})]})]})}),(0,t.jsx)(S.C5,{})]})]})}}),"CDSL"===i?(0,t.jsx)(S.zB,{control:o.control,name:"cdslBoId",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"BO ID"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"BO ID must be 16 digits"}),(0,t.jsx)(L,{content:"The Beneficial Owner ID (BO ID) for CDSL must be exactly 16 digits long."})]}),(0,t.jsx)(S.MJ,{children:(0,t.jsx)(w.p,{...r,maxLength:16,inputMode:"numeric",pattern:"\\d*",onChange:e=>{let s=e.target.value.replace(/\D/g,"").slice(0,16);r.onChange(s)}})}),(0,t.jsx)(S.C5,{})]})]})}}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.zB,{control:o.control,name:"dpId",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"DP ID"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"DP ID must be 8 digits"}),(0,t.jsx)(L,{content:"The Depository Participant ID (DP ID) for NSDL must be exactly 8 digits long."})]}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-yellow-600 bg-yellow-600 text-white text-sm font-medium",children:"IN"}),(0,t.jsx)(S.MJ,{children:(0,t.jsx)(w.p,{...r,className:"rounded-l-none",maxLength:6,inputMode:"numeric",pattern:"\\d*",onChange:e=>{let s=e.target.value.replace(/\D/g,"").slice(0,6);r.onChange(s)}})})]}),(0,t.jsx)(S.C5,{})]})]})}}),(0,t.jsx)(S.zB,{control:o.control,name:"boId",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(S.lR,{className:"text-right",children:"BO ID"}),(0,t.jsxs)("div",{className:"col-span-3",children:[(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"BO ID must be 8 digits"}),(0,t.jsx)(L,{content:"The Beneficial Owner ID (BO ID) for NSDL must be exactly 8 digits long."})]}),(0,t.jsx)(S.MJ,{children:(0,t.jsx)(w.p,{...r,maxLength:8,inputMode:"numeric",pattern:"\\d*",onChange:e=>{let s=e.target.value.replace(/\D/g,"").slice(0,8);r.onChange(s)}})}),(0,t.jsx)(S.C5,{})]})]})}})]}),(0,t.jsxs)(b.Es,{children:[(0,t.jsx)(d.$,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),(0,t.jsx)(d.$,{type:"submit",className:"bg-yellow-600 hover:bg-yellow-700",children:"Apply"})]})]})})]})})}function P(e){let{isOpen:r,onClose:s,onConfirm:a,title:l,description:n,selectedCount:i}=e;return(0,t.jsx)(b.lG,{open:r,onOpenChange:e=>!e&&s(),children:(0,t.jsxs)(b.Cf,{className:"sm:max-w-[425px]",children:[(0,t.jsxs)(b.c7,{children:[(0,t.jsx)(b.L3,{children:l}),(0,t.jsx)(b.rr,{children:n})]}),void 0!==i&&(0,t.jsx)("div",{className:"py-4",children:(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected records: ",i]})}),(0,t.jsxs)(b.Es,{children:[(0,t.jsx)(d.$,{variant:"outline",onClick:s,children:"Cancel"}),(0,t.jsx)(d.$,{onClick:a,children:"Confirm"})]})]})})}var A=s(86659);let B=C.Ik({exchange:C.k5(["NSE","BSE"],{required_error:"Please select an exchange."}),orderType:C.k5(["CDSL OTHER","NSDL OTHER"],{required_error:"Please select a file type."})});function T(e){let{isOpen:r,onOpenChange:s,onGenerateFile:l,dataAvailable:n}=e,[i,c]=(0,a.useState)(!1),o=(0,N.mN)({resolver:(0,v.u)(B),defaultValues:{exchange:void 0,orderType:void 0}});(0,a.useEffect)(()=>{r||o.reset({exchange:void 0,orderType:void 0})},[r,o]);let m=async e=>{if(!n){h.oR.error("Data not available. Cannot generate file."),s(!1);return}c(!0);try{await l(e)}catch(e){console.error("Error generating file:",e),h.oR.error("An error occurred while generating the file")}finally{c(!1),s(!1)}};return(0,t.jsx)(b.lG,{open:r,onOpenChange:s,children:(0,t.jsxs)(b.Cf,{children:[(0,t.jsx)(b.c7,{children:(0,t.jsx)(b.L3,{children:"Generate File"})}),(0,t.jsx)(S.lV,{...o,children:(0,t.jsxs)("form",{onSubmit:o.handleSubmit(m),className:"space-y-4",children:[(0,t.jsx)(S.zB,{control:o.control,name:"orderType",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{children:[(0,t.jsx)(S.lR,{children:"File for: "}),(0,t.jsx)(S.MJ,{children:(0,t.jsxs)(I.z,{onValueChange:r.onChange,defaultValue:r.value,className:"flex flex-col space-y-1",children:[(0,t.jsxs)(S.eI,{className:"flex items-center space-x-3 space-y-0",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(I.C,{value:"CDSL OTHER"})}),(0,t.jsx)(S.lR,{className:"font-normal",children:"CDSL OTHER"})]}),(0,t.jsxs)(S.eI,{className:"flex items-center space-x-3 space-y-0",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(I.C,{value:"NSDL OTHER"})}),(0,t.jsx)(S.lR,{className:"font-normal",children:"NSDL OTHER"})]})]})}),(0,t.jsx)(S.C5,{})]})}}),(0,t.jsx)(S.zB,{control:o.control,name:"exchange",render:e=>{let{field:r}=e;return(0,t.jsxs)(S.eI,{children:[(0,t.jsx)(S.lR,{children:"Exchange: "}),(0,t.jsx)(S.MJ,{children:(0,t.jsxs)(I.z,{onValueChange:r.onChange,defaultValue:r.value,className:"flex flex-col space-y-1",children:[(0,t.jsxs)(S.eI,{className:"flex items-center space-x-3 space-y-0",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(I.C,{value:"NSE"})}),(0,t.jsx)(S.lR,{className:"font-normal",children:"NSE"})]}),(0,t.jsxs)(S.eI,{className:"flex items-center space-x-3 space-y-0",children:[(0,t.jsx)(S.MJ,{children:(0,t.jsx)(I.C,{value:"BSE"})}),(0,t.jsx)(S.lR,{className:"font-normal",children:"BSE"})]})]})}),(0,t.jsx)(S.C5,{})]})}}),(0,t.jsxs)(b.Es,{children:[(0,t.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>{o.reset({exchange:void 0,orderType:void 0}),s(!1)},children:"Cancel"}),(0,t.jsx)(d.$,{type:"submit",className:"bg-teal-600 hover:bg-teal-700 text-white",disabled:i,children:i?"Generating...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"mr-2 h-4 w-4"}),"Generate"]})})]})]})})]})})}var F=s(85147),z=s(55546),M=s(17733);let J=[{id:"isin",accessorKey:"isin",header:"ISIN",hidden:!0},{id:"branchcode",accessorKey:"branchcode",header:"Branch Code"},{id:"clientId",accessorKey:"clientId",header:"Client ID",cell:e=>{var r;let{row:s}=e,a=null!==(r=s.original.clientId)&&void 0!==r?r:"-";return(0,t.jsx)("div",{className:"font-medium",children:a})}},{id:"orderType",accessorKey:"orderType",header:"Depository",cell:e=>{let{row:r}=e,s=r.original.orderType;return"CDSL OTHER"===s?"CDSL":"NSDL OTHER"===s?"NSDL":s}},{id:"dpid",accessorKey:"dpid",header:"DPID"},{id:"boid",accessorKey:"boid",header:"BOID"},{id:"quantity",accessorKey:"quantity",header:"Applied Quantity"},{id:"orderStatus",accessorKey:"orderStatus",header:"Order Status",cell:e=>{let{row:r}=e,s=r.original.orderStatus;if(!s)return"-";let a=s.toLowerCase(),l="";return l="processed"===a?"bg-green-100 text-green-800 hover:bg-green-200 border border-green-200":"applied"===a?"bg-amber-50 text-amber-700 hover:bg-amber-100 border border-amber-200":"cancelled"===a?"bg-red-100 text-red-800 hover:bg-red-200 border border-red-200":"bg-gray-100 text-gray-800 hover:bg-gray-200 border border-gray-200",(0,t.jsx)(x.E,{className:l,children:s})}},{id:"appliedDate",accessorKey:"appliedDate",header:"Time",cell:e=>{let{row:r}=e,s=r.original.appliedDate;return s?(0,M.GP)(new Date(s),"yyyy-MM-dd HH:mm:ss"):"-"}}];var q=s(65753),H=s(69660),V=s(77711),$=s(74317),G=s(68678);let _=(0,V.default)(()=>Promise.all([s.e(1122),s.e(3930),s.e(343),s.e(9690),s.e(4390),s.e(2449),s.e(4156),s.e(227),s.e(5996),s.e(1846)]).then(s.bind(s,75996)),{loadableGenerated:{webpack:()=>[75996]},ssr:!1});function K(){let[e,r]=(0,a.useState)("orders"),[s,l]=(0,a.useState)([]),[b,N]=(0,a.useState)(!1),[v,C]=(0,a.useState)(null),[w,D]=(0,a.useState)(!1),[S,I]=(0,a.useState)(!1);(0,z.U)("(max-width: 640px)");let[k,R]=(0,a.useState)([]),[E,L]=(0,a.useState)(""),[B,M]=(0,a.useState)(null),[V,K]=(0,a.useState)(!1),[U,Y]=(0,a.useState)(!1),[Q,W]=(0,a.useState)(null),[Z,X]=(0,a.useState)([]),[ee,er]=(0,a.useState)(!1),[es,et]=(0,a.useState)(!1),[ea,el]=(0,a.useState)(null),en=(0,a.useRef)(null),ei=(0,a.useRef)([]),ed=(0,a.useRef)(null),ec=(0,a.useCallback)(()=>{if(!en.current)return[];let e=n()(en.current).find("table");if(!e)return[];let r=e.DataTable(),s=r.rows({selected:!0}).nodes(),t=r.rows({selected:!0}).data().toArray().map((e,r)=>{let t=n()(s[r]),a=t.next("tr.child"),l={};return t.add(a).find("input, select, textarea").each(function(){let e=n()(this).attr("name")||n()(this).attr("data-id");e&&(l[e]=this.value)}),{...e,inputs:l}});return ei.current=t,t},[]),eo=(0,a.useCallback)(async()=>{N(!0),C(null);try{let e=await (0,f.D5k)();if(!(0,g.k9)(e)){D(!0);return}let r="string"==typeof e.data.data?JSON.parse(e.data.data):e.data.data;if(r)R(r.map(e=>({scrip:e.scrip,value:e.buybackid.toString(),isin:e.isin,fromdate:e.fromdate,todate:e.todate,buybackprice:e.buybackprice,nsesettno:e.nsesettno,bsesettno:e.bsesettno})));else throw Error(r["Error Description"]||"Failed to fetch template data.")}catch(e){C(e.message||"An error occurred while fetching data.")}finally{N(!1)}},[]);(0,a.useEffect)(()=>{eo()},[eo]);let em=(0,a.useCallback)(async e=>{N(!0),C(null);try{let r=await (0,f.zwJ)({isin:e});if(!(0,g.k9)(r)){D(!0);return}let s="string"==typeof r.data.data?JSON.parse(r.data.data):r.data.data;l(s&&Array.isArray(s)&&s.length>0?s:[])}catch(e){C(e.message||"An error occurred while fetching data.")}finally{N(!1)}},[]),eu=async()=>{N(!0);try{if(!Q)throw Error("No order to confirm");let e=await (0,f.qVY)({data:[Q]});if(!(0,g.k9)(e)){D(!0);return}let r=e.data;r&&r.data?r.data.every(e=>!0===e.status)?(h.oR.success("Order Placed successfully!"),(null==B?void 0:B.isin)&&await em(B.isin)):h.oR.error("Buyback application failed. Please check and try again."):h.oR.error("Failed to apply for buyback. Please try again.")}catch(e){console.error("Error during buyback application:",e),h.oR.error("An error occurred while applying for buyback. Please try again later.")}finally{N(!1),Y(!1),K(!1),W(null)}},ex=async e=>{let r={quantity:e.quantity,clientId:e.clientId,scrip:(null==B?void 0:B.scrip)||"",isin:(null==B?void 0:B.isin)||"",buybackid:E,branchcode:e.branchCode,boid:"CDSL"===e.depositoryType?e.cdslBoId:e.boId,dpid:"CDSL"===e.depositoryType?"":"IN".concat(e.dpId),orderType:"CDSL"===e.depositoryType?"CDSL OTHER":"NSDL OTHER"};console.log(r),W(r),Y(!0),K(!1)},eh=(0,a.useCallback)(async()=>{let e=Z.length>0?Z:ei.current;if(S||0===e.length){h.oR.error("Please select orders to delete.");return}I(!0);try{if(!(null==B?void 0:B.scrip)||!E){h.oR.error("Please select a company first.");return}let r=e.map(e=>({boid:e.boid,dpid:e.dpid,scrip:B.scrip,isin:e.original.isin,buybackid:Number.parseInt(E),clientId:e.clientId.toString(),id:e.original.id})),s=await (0,f.Vl2)({data:r});if(!(0,g.k9)(s)){D(!0);return}let t=s.data;t&&t.data?t.data.every(e=>!0===e.status)?(h.oR.success("Orders deleted successfully."),await em(B.isin)):h.oR.error("Failed to delete order. Please check and try again."):h.oR.error("Some orders failed to delete.")}catch(e){h.oR.error("Error: ".concat(e.message||"Unknown error"))}finally{var r;I(!1),et(!1),null===(r=ed.current)||void 0===r||r.close()}},[E,S,B,em,ea]),ep=async e=>{try{N(!0);let r=await (0,f.Pn0)({isin:(null==B?void 0:B.isin)||"",exchange:e.exchange,orderType:e.orderType});if(r.data&&r.data.data&&r.data.data.zipfile){let e=r.data.data.zipfile;(function(e){let r=document.createElement("a");r.href=e,r.download=function(e){let r=e.split("/");return r[r.length-1]}(e),document.body.appendChild(r),r.click(),document.body.removeChild(r)})(e),h.oR.success("File generated successfully!"),(null==B?void 0:B.isin)&&await em(B.isin)}else h.oR.error("Failed to generate file. Please try again.")}catch(e){console.error("Error generating file:",e),h.oR.error("An error occurred while generating the file. Please try again later.")}finally{N(!1),er(!1)}};return(0,a.useEffect)(()=>{if(!en.current||0===s.length)return;let e=n()(en.current);return e.off("select.dt"),e.on("select.dt",(e,r,s,t)=>{if("row"===s){if(1===t.length){let e=t[0],s=r.row(e).data(),a=r.row(e).node();if(["PROCESSED"].includes(s.original.orderStatus)){n()(a).data("suppressCheckbox",!0),r.row(e).deselect(),h.oR.warning("Cannot select order for ".concat(s.original.clientId||"this client"," - Please only select orders with the 'APPLIED' status."),{position:"top-center",duration:5e3}),n()(a).find(".rowCheckbox").prop("checked",!1);return}if(["CANCELLED"].includes(s.original.orderStatus)){n()(a).data("suppressCheckbox",!0),r.row(e).deselect(),h.oR.warning("Cannot select order for ".concat(s.original.clientId||"this client"," - The order is already cancelled. Please only select orders with the 'APPLIED' order status."),{position:"top-center",duration:5e3}),n()(a).find(".rowCheckbox").prop("checked",!1);return}}else if(t.length>1){let e=[];if(t.forEach(s=>{let t=r.row(s).data(),a=r.row(s).node();["PROCESSED","CANCELLED"].includes(t.original.orderStatus)?(n()(a).data("suppressCheckbox",!0),r.row(s).deselect(),e.push(t.original.clientId||"this client"),n()(a).find(".rowCheckbox").prop("checked",!1)):["APPLIED"].includes(t.original.orderStatus)&&(n()(a).find(".rowCheckbox").prop("checked",!0),n()(a).data("shouldCheck",!0))}),e.length>0){let r=e.slice(0,3),s=e.length-3;s>0?h.oR.warning("Cannot select orders for clients: ".concat(r.join(", ")," and ").concat(s," more - Please only select orders with the 'APPLIED' status."),{position:"top-center",duration:5e3}):h.oR.warning("Cannot select order".concat(r.length>1?"s":""," for ").concat(r.join(", ")," - Please only select orders with the 'APPLIED' status."),{position:"top-center",duration:5e3})}}}}),()=>{en.current&&e.off("select.dt")}},[s]),(0,t.jsxs)(y.default,{children:[(0,t.jsxs)(i.Zp,{className:"w-full",children:[(0,t.jsxs)(i.aR,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-2 sm:space-y-0",children:[(0,t.jsxs)(i.ZB,{children:["External DP / NSDL Buyback ",(0,t.jsx)("span",{className:"text-sm text-muted",children:" (covers NSDL, other CDSL DP, and Non-POA)"})]}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800 dark:border-amber-800/30 dark:bg-amber-900/30 dark:text-amber-200",children:[(0,t.jsx)(c.A,{className:"h-3.5 w-3.5 flex-shrink-0"}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"NOTE:"})," On End Date Cut_Off time to place order is 12:00 PM."]})]})]}),(0,t.jsxs)(i.Wu,{children:[(0,t.jsx)("div",{className:"bg-slate-50 rounded-md p-1 mb-2",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 items-start md:items-center",children:[(0,t.jsx)("div",{className:"w-full md:w-auto md:mr-auto",children:(0,t.jsx)("div",{className:"relative w-full md:w-[260px]",children:(0,t.jsxs)(u.l6,{value:E,onValueChange:e=>{if(!e||"NONE"===e){h.oR.error("Please select a company."),L(""),l([]),M(null);return}L(e);let r=k.find(r=>r.value===e);r&&(M(r),em(r.isin))},children:[(0,t.jsx)(u.bq,{className:"w-full bg-white h-9",children:(0,t.jsx)(u.yv,{placeholder:"Select a company"})}),(0,t.jsxs)(u.gC,{children:[(0,t.jsx)(u.eb,{value:"NONE",children:"Select a company"}),k.map(e=>(0,t.jsx)(u.eb,{value:e.value,children:e.scrip},e.value))]})]})})}),B&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.$,{onClick:()=>K(!0),className:"bg-yellow-600 hover:bg-yellow-700",size:"sm",children:[" ",(0,t.jsx)(o.A,{className:"h-4 w-4"}),"Place Order"]}),(0,t.jsxs)(d.$,{variant:"destructive",size:"sm",onClick:()=>{var e;let r=ec();if(0===r.length){h.oR.error("Please select at least one order to delete");return}ei.current=r,X(r),null===(e=ed.current)||void 0===e||e.open()},className:"whitespace-nowrap",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Delete Order"]}),(0,t.jsxs)(d.$,{onClick:()=>er(!0),className:"bg-teal-600 hover:bg-teal-700 text-white",size:"sm",children:[(0,t.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Generate File"]})]})]})}),(0,t.jsx)(G.A,{selectedCompanyDetails:B}),E&&"NONE"!==E&&(0,t.jsx)(t.Fragment,{children:b?(0,t.jsx)(F.A,{columns:4,rows:10}):v?(0,t.jsx)("div",{className:"text-center text-red-500 p-4 bg-red-100 rounded-md",children:v}):0===s.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-4 text-center bg-muted/20 rounded-md border border-dashed border-muted-foreground/20 my-4",children:[(0,t.jsx)("div",{className:"rounded-full bg-muted p-3 mb-4",children:(0,t.jsx)(m.A,{className:"h-8 w-8 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No records found"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4 max-w-md",children:"There are no records available for this criteria."})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"overflow-x-auto",ref:en,children:(0,t.jsx)(_,{columns:J,data:s,selectableRows:!0,showPagination:!0,filterColumn:"clientId"},"buyback_table")})})})]})]}),V&&(0,t.jsx)(O,{isOpen:V,onClose:()=>K(!1),onSubmit:ex,companyDetails:B}),U&&(0,t.jsx)(P,{isOpen:U,onClose:()=>{Y(!1),W(null)},onConfirm:eu,title:"Confirm Order",description:"Are you sure you want to place this buyback order?"}),(0,t.jsx)(T,{isOpen:ee,onOpenChange:er,onGenerateFile:ep,dataAvailable:s.length>0}),(0,t.jsx)($.A,{ref:ed,title:"Confirm Delete ?",onConfirm:eh,confirmLoading:S,confirmText:"Delete",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-base font-medium",children:"Are you sure you want to delete the selected buyback order(s)?"}),B&&(0,t.jsx)("div",{className:"flex flex-col space-y-2 p-3 bg-slate-50 rounded-md",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(q.A,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),(0,t.jsx)("span",{className:"font-semibold",children:B.scrip}),B.buybackprice>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,t.jsx)(H.A,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"ISIN:"}),(0,t.jsx)(x.E,{variant:"secondary",className:"font-medium",children:B.isin})]})]})})]}),(0,t.jsx)("div",{className:"rounded-md border overflow-hidden",children:(0,t.jsxs)(j.XI,{children:[(0,t.jsx)(j.A0,{children:(0,t.jsxs)(j.Hj,{children:[(0,t.jsx)(j.nd,{className:"w-1/3",children:"ClientId"}),(0,t.jsx)(j.nd,{className:"w-1/4",children:"Applied Quantity"})]})}),(0,t.jsx)(j.BF,{children:Z&&Z.length>0?Z.map((e,r)=>{var s;return(0,t.jsxs)(j.Hj,{children:[(0,t.jsx)(j.nA,{className:"font-medium",children:e.clientId}),(0,t.jsx)(j.nA,{className:"font-medium",children:(null===(s=e.original)||void 0===s?void 0:s.quantity)||"-"})]},r)}):(0,t.jsx)(j.Hj,{children:(0,t.jsx)(j.nA,{colSpan:3,className:"text-center py-4",children:"No scrip selected"})})})]})}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground mt-2",children:(0,t.jsx)("p",{children:"Please review the details before confirming."})})]})}),w&&(0,t.jsx)(g.Bs,{})]})}},44870:(e,r,s)=>{"use strict";s.d(r,{C5:()=>g,MJ:()=>f,Rr:()=>j,eI:()=>h,lR:()=>p,lV:()=>c,zB:()=>m});var t=s(95155),a=s(12115),l=s(14707),n=s(69606),i=s(21567),d=s(98986);let c=n.Op,o=a.createContext({}),m=e=>{let{...r}=e;return(0,t.jsx)(o.Provider,{value:{name:r.name},children:(0,t.jsx)(n.xI,{...r})})},u=()=>{let e=a.useContext(o),r=a.useContext(x),{getFieldState:s,formState:t}=(0,n.xW)(),l=s(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...l}},x=a.createContext({}),h=a.forwardRef((e,r)=>{let{className:s,...l}=e,n=a.useId();return(0,t.jsx)(x.Provider,{value:{id:n},children:(0,t.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",s),...l})})});h.displayName="FormItem";let p=a.forwardRef((e,r)=>{let{className:s,...a}=e,{error:l,formItemId:n}=u();return(0,t.jsx)(d.J,{ref:r,className:(0,i.cn)(l&&"text-destructive",s),htmlFor:n,...a})});p.displayName="FormLabel";let f=a.forwardRef((e,r)=>{let{...s}=e,{error:a,formItemId:n,formDescriptionId:i,formMessageId:d}=u();return(0,t.jsx)(l.DX,{ref:r,id:n,"aria-describedby":a?"".concat(i," ").concat(d):"".concat(i),"aria-invalid":!!a,...s})});f.displayName="FormControl";let j=a.forwardRef((e,r)=>{let{className:s,...a}=e,{formDescriptionId:l}=u();return(0,t.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-[0.8rem] text-muted-foreground",s),...a})});j.displayName="FormDescription";let g=a.forwardRef((e,r)=>{let{className:s,children:a,...l}=e,{error:n,formMessageId:d}=u(),c=n?String(null==n?void 0:n.message):a;return c?(0,t.jsx)("p",{ref:r,id:d,className:(0,i.cn)("text-[0.8rem] font-medium text-destructive",s),...l,children:c}):null});g.displayName="FormMessage"},98986:(e,r,s)=>{"use strict";s.d(r,{J:()=>c});var t=s(95155),a=s(12115),l=s(46195),n=s(31027),i=s(21567);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.b,{ref:r,className:(0,i.cn)(d(),s),...a})});c.displayName=l.b.displayName},89095:(e,r,s)=>{"use strict";s.d(r,{AM:()=>i,Wv:()=>d,hl:()=>c});var t=s(95155),a=s(12115),l=s(38417),n=s(21567);let i=l.bL,d=l.l9;l.Mz;let c=a.forwardRef((e,r)=>{let{className:s,align:a="center",sideOffset:i=4,...d}=e;return(0,t.jsx)(l.ZL,{children:(0,t.jsx)(l.UC,{ref:r,align:a,sideOffset:i,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...d})})});c.displayName=l.UC.displayName},84179:(e,r,s)=>{"use strict";s.d(r,{C:()=>c,z:()=>d});var t=s(95155),a=s(12115),l=s(852),n=s(33565),i=s(21567);let d=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.bL,{className:(0,i.cn)("grid gap-2",s),...a,ref:r})});d.displayName=l.bL.displayName;let c=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.q7,{ref:r,className:(0,i.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:(0,t.jsx)(l.C1,{className:"flex items-center justify-center",children:(0,t.jsx)(n.A,{className:"h-3.5 w-3.5 fill-primary"})})})});c.displayName=l.q7.displayName}},e=>{var r=r=>e(e.s=r);e.O(0,[3740,1181,8526,8562,164,2589,814,8007,5565,9526,6143,4015,8665,8417,6527,7518,7733,2411,6137,7555,7328,9086,1816,8441,1517,7358],()=>r(47603)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9692],{32464:(e,t,a)=>{Promise.resolve().then(a.bind(a,45500))},65753:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},80175:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]])},61594:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},93650:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]])},69660:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]])},3265:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("ReceiptText",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M14 8H8",key:"1l3xfs"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"M13 16H8",key:"wsln4y"}]])},83489:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(67401).A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},77711:(e,t,a)=>{"use strict";a.d(t,{default:()=>l.a});var r=a(21956),l=a.n(r)},21956:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=a(60306)._(a(30580));function l(e,t){var a;let l={};"function"==typeof e&&(l.loader=e);let s={...l,...t};return(0,r.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},39827:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let r=a(93719);function l(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return a}},30580:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let r=a(95155),l=a(12115),s=a(39827),n=a(79214);function d(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(d(()=>null)),loading:null,ssr:!0},c=function(e){let t={...i,...e},a=(0,l.lazy)(()=>t.loader().then(d)),c=t.loading;function o(e){let d=c?(0,r.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,o=i?l.Suspense:l.Fragment,u=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(o,{...i?{fallback:d}:{},children:u})}return o.displayName="LoadableComponent",o}},79214:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return d}});let r=a(95155),l=a(47650),s=a(75861),n=a(18284);function d(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=s.workAsyncStorage.getStore();if(void 0===a)return null;let d=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files;d.push(...t)}}return 0===d.length?null:(0,r.jsx)(r.Fragment,{children:d.map(e=>{let t=a.assetPrefix+"/_next/"+(0,n.encodeURIPath)(e);return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,l.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},45500:(e,t,a)=>{"use strict";a.d(t,{default:()=>S});var r=a(95155),l=a(12115),s=a(22130),n=a(73312),d=a(25121),i=a(61594),c=a(83489),o=a(93650),u=a(37528),h=a(30814),p=a(47282),f=a(67328),m=a(12711),y=a(85147),x=a(55546);a(33900);let b=[{id:"clientId",accessorKey:"clientId",header:"Client ID",cell:e=>{var t;let{row:a}=e,l=null!==(t=a.original.clientId)&&void 0!==t?t:"-";return(0,r.jsx)("div",{className:"font-medium",children:l})}},{id:"scrip",accessorKey:"scrip",header:"Scrip Name",hidden:!0},{id:"branchcode",accessorKey:"branchcode",header:"Branch Code"},{id:"boidinp",accessorKey:"boid",header:"BOID"},{id:"quantity",accessorKey:"quantity",header:"Free Quantity"},{id:"pledgedquantity",accessorKey:"pledgedquantity",header:"Pledged"},{id:"alreadyApplied",accessorKey:"alreadyApplied",header:"Already Applied"},{id:"applyQuantityInp",accessorKey:"quantity",header:"Apply"},{id:"isin",accessorKey:"isin",header:"ISIN",hidden:!0}];var j=a(65753),g=a(69660),v=a(77711),k=a(74317),w=a(72508),N=a(43932),A=a.n(N),M=a(68678);let C=(0,v.default)(()=>Promise.all([a.e(2226),a.e(7690),a.e(9190),a.e(1122),a.e(2449),a.e(7981),a.e(853)]).then(a.bind(a,17981)),{loadableGenerated:{webpack:()=>[17981]},ssr:!1});function S(){let[e,t]=(0,l.useState)([]),[a,v]=(0,l.useState)(!1),[N,S]=(0,l.useState)(null),[P,O]=(0,l.useState)(!1),[q,_]=(0,l.useState)(!1);(0,x.U)("(max-width: 640px)");let[I,R]=(0,l.useState)([]),[D,E]=(0,l.useState)(""),[B,F]=(0,l.useState)(null),[T,H]=(0,l.useState)([]),K=(0,l.useRef)(null),z=(0,l.useRef)([]),L=(0,l.useRef)(null),Q=(0,l.useCallback)(()=>{if(!K.current)return[];let e=A()(K.current).find("table");if(!e)return[];let t=e.DataTable(),a=t.rows({selected:!0}).nodes();return t.rows({selected:!0}).data().toArray().map((e,t)=>{let r=A()(a[t]),l=r.next("tr.child"),s={};return r.add(l).find("input, select, textarea").each(function(){let e=A()(this).attr("name")||A()(this).attr("data-id");e&&(s[e]=this.value)}),{...e,inputs:s}})},[]),Z=(0,l.useCallback)(async()=>{v(!0),S(null);try{let e=await (0,p.D5k)();if(!(0,f.k9)(e)){_(!0);return}let t="string"==typeof e.data.data?JSON.parse(e.data.data):e.data.data;if(t)R(t.map(e=>({scrip:e.scrip,value:e.buybackid.toString(),isin:e.isin,fromdate:e.fromdate,todate:e.todate,buybackprice:e.buybackprice,nsesettno:e.nsesettno,bsesettno:e.bsesettno})));else throw Error(t["Error Description"]||"Failed to fetch template data.")}catch(e){S(e.message||"An error occurred while fetching data.")}finally{v(!1)}},[]);(0,l.useEffect)(()=>{Z()},[Z]);let V=(0,l.useCallback)(async e=>{v(!0),S(null);try{let a=await (0,p.sd)({isin:e});if(!(0,f.k9)(a)){_(!0);return}let r="string"==typeof a.data.data?JSON.parse(a.data.data):a.data.data;r&&Object.keys(r).length>0?t(r):t([])}catch(e){S(e.message||"An error occurred while fetching data.")}finally{v(!1)}},[]),J=async()=>{var e,t;if(0===T.length){h.oR.error("Please select at least one client to proceed.");return}v(!0);try{let t=T.map(e=>({applied:e.inputs.quantity||e.applied,clientId:e.clientId.toString(),quantity:e.quantity,boid:e.boid,scrip:e.scrip,isin:e.isin,buybackid:D,branchcode:e.branchcode.toString(),orderType:"CDSL"})),a=await (0,p.F0Y)({data:t});if(!(0,f.k9)(a)){_(!0);return}let l=a.data;if(l&&l.data){let t=l.data.every(e=>!0===e.status),a=l.data.map(e=>{var t,a;let r=(null===(t=e.request)||void 0===t?void 0:t.clientId)||"N/A",l=(null===(a=e.request)||void 0===a?void 0:a.applied)||"N/A",s=e.message||(e.status?"Application submitted successfully.":"Application failed.");return!0===e.status?"✔️ Client ".concat(r,": Applied ").concat(l," – ").concat(s):"❌ Client ".concat(r,": Applied ").concat(l," – ").concat(s)}),s=(0,r.jsx)("div",{children:a.map((e,t)=>(0,r.jsx)("div",{children:e},t))});t?h.oR.success(s):h.oR.error(s),t&&await V((null===(e=I.find(e=>e.value===D))||void 0===e?void 0:e.isin)||"")}else h.oR.error("Buyback request failed. Please try again.")}catch(e){console.error("Buyback error:",e),h.oR.error("An unexpected error occurred. Please try again later.")}finally{v(!1),O(!1),null===(t=L.current)||void 0===t||t.close()}},Y=e=>{let t=A()(e),a=JSON.parse((t.closest("tr").hasClass("child")?t.closest("tr").prev():t.closest("tr")).attr("data-row-data")||"{}"),r=parseInt(t.val()),l=parseInt(a.quantity),s=Number.parseInt(a.alreadyApplied)||0,n=l-s;return isNaN(r)||r<0?(G(t,"*Quantity should not be blank or zero."),!1):r>n?(G(t,"*Already applied Quantity ".concat(s,". Available Quantity : ").concat(n)),!1):r>l?(G(t,"*Quantity cannot exceed the free quantity."),!1):(a.applied=r,U(t),!0)},G=(e,t)=>{e.addClass("border-red-500"),e.next(".error-message").length||e.after('<span class="error-message text-red-500" style="display: block;">'.concat(t,"</span>"))},U=e=>{e.removeClass("border-red-500"),e.next(".error-message").remove()},W=()=>{let e=!0;if(!K.current)return!0;let t=A()(K.current).find("table");if(!t.length)return!0;try{let a=t.DataTable().rows({selected:!0}).nodes();A()(a).each(function(){let t=A()(this),a=t.next("tr.child");t.add(a).find("input[name='quantity']").each(function(){Y(this)||(e=!1)})})}catch(t){console.error("Error in validateAllInputs:",t),A()("input[name='quantity']").each(function(){Y(this)||(e=!1)})}return e};return(0,l.useEffect)(()=>{if(K.current&&0!==e.length)return A()(K.current).on("input","input[name='quantity']",function(){Y(this)}),()=>{K.current&&A()(K.current).off("input","input[name='quantity']")}},[e]),(0,r.jsxs)(m.default,{children:[(0,r.jsxs)(s.Zp,{className:"w-full",children:[(0,r.jsxs)(s.aR,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-2 sm:space-y-0",children:[(0,r.jsx)(s.ZB,{children:"Buybackk"}),(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2 rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800 dark:border-amber-800/30 dark:bg-amber-900/30 dark:text-amber-200",children:[(0,r.jsx)(i.A,{className:"h-3.5 w-3.5 flex-shrink-0"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"NOTE:"})," On End Date Cut_Off time to place order is 12:00 PM."]})]})]}),(0,r.jsxs)(s.Wu,{children:[(0,r.jsx)("div",{className:"bg-slate-50 rounded-md p-1 mb-2",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-3 items-start md:items-center justify-between",children:[(0,r.jsx)("div",{className:"w-full md:w-auto",children:(0,r.jsx)("div",{className:"relative w-full md:w-[260px]",children:(0,r.jsxs)(u.l6,{value:D,onValueChange:e=>{if(!e||"NONE"===e){h.oR.error("Please select a company."),E(""),t([]),F(null);return}E(e);let a=I.find(t=>t.value===e);if(a){F(a);let e=new Date(a.todate),t=new Date;if(t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()){let e=new Date(a.todate);if(e.setHours(12,0,0),new Date>e){h.oR.warning("On End Date Cut_Off time to place order is 12:00 PM.");return}}V(a.isin)}},children:[(0,r.jsx)(u.bq,{className:"w-full bg-white h-9",children:(0,r.jsx)(u.yv,{placeholder:"Select a company"})}),(0,r.jsxs)(u.gC,{children:[(0,r.jsx)(u.eb,{value:"NONE",children:"Select a company"}),I.map(e=>(0,r.jsx)(u.eb,{value:e.value,children:e.scrip},e.value))]})]})})}),B&&"NONE"!==D?(0,r.jsx)(r.Fragment,{children:e.length>0&&(0,r.jsxs)(n.$,{onClick:()=>{let e=Q();if(0===e.length){h.oR.error("Please select at least one");return}if(z.current=e,H(e),W()){var t;null===(t=L.current)||void 0===t||t.open()}else h.oR.error("Please review the details before confirming.")},className:"w-full sm:w-auto",size:"sm",children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Apply Buyback"]})}):null]})}),(0,r.jsx)(M.A,{selectedCompanyDetails:B}),D&&"NONE"!==D?(0,r.jsx)(r.Fragment,{children:a?(0,r.jsx)(y.A,{columns:4,rows:10}):N?(0,r.jsx)("div",{className:"text-center text-red-500 p-4 bg-red-100 rounded-md",children:N}):0===e.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-4 text-center bg-muted/20 rounded-md border border-dashed border-muted-foreground/20 my-4",children:[(0,r.jsx)("div",{className:"rounded-full bg-muted p-3 mb-4",children:(0,r.jsx)(o.A,{className:"h-8 w-8 text-muted-foreground"})}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No records found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4 max-w-md",children:"There are no records available for this criteria."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",ref:K,children:(0,r.jsx)(C,{columns:b,data:e,selectableRows:!0,showPagination:!0},"buyback_table")})}):null]})]}),(0,r.jsx)(k.A,{ref:L,title:"Confirm Buyback ?",onConfirm:J,confirmLoading:!1,confirmText:"Confirm",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-base font-medium",children:"Are you sure you want to buyback?"}),B&&(0,r.jsx)("div",{className:"flex flex-col space-y-2 p-3 bg-slate-50 rounded-md",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(j.A,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),(0,r.jsx)("span",{className:"font-semibold",children:B.scrip}),B.buybackprice>0&&(0,r.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,r.jsx)(g.A,{className:"h-5 w-5 flex-shrink-0 text-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"ISIN:"}),(0,r.jsx)(d.E,{variant:"secondary",className:"font-medium",children:B.isin})]})]})})]}),(0,r.jsx)("div",{className:"rounded-md border overflow-hidden",children:(0,r.jsxs)(w.XI,{children:[(0,r.jsx)(w.A0,{children:(0,r.jsxs)(w.Hj,{children:[(0,r.jsx)(w.nd,{className:"w-1/3",children:"ClientId"}),(0,r.jsx)(w.nd,{className:"w-1/4",children:"Quantity"})]})}),(0,r.jsx)(w.BF,{children:T&&T.length>0?T.map((e,t)=>{var a;return(0,r.jsxs)(w.Hj,{children:[(0,r.jsx)(w.nA,{className:"font-medium",children:e.clientId}),(0,r.jsx)(w.nA,{className:"font-medium",children:(null===(a=e.inputs)||void 0===a?void 0:a.quantity)||"-"})]},t)}):(0,r.jsx)(w.Hj,{children:(0,r.jsx)(w.nA,{colSpan:3,className:"text-center py-4",children:"No scrip selected"})})})]})}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground mt-2",children:(0,r.jsx)("p",{children:"Please review the details before confirming."})})]})}),q&&(0,r.jsx)(f.Bs,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3740,1181,8526,8562,164,2589,814,8007,5565,9526,6143,4015,8665,6527,6137,7555,7328,9086,1816,8441,1517,7358],()=>t(32464)),_N_E=e.O()}]);
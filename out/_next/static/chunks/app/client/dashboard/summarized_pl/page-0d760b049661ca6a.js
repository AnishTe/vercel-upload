(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[132],{18873:(e,t,r)=>{Promise.resolve().then(r.bind(r,34271))},34271:(e,t,r)=>{"use strict";r.d(t,{default:()=>R});var a=r(95155),n=r(12115),s=r(17733),l=r(22130);let o=[{id:"SCRIP_NAME",accessorKey:"SCRIP_NAME",header:"Scrip Name",sortable:!1},{id:"BUY_QTY",accessorKey:"BUY_QTY",header:"Buy Quantity"},{id:"BUY_RATE",accessorKey:"BUY_RATE",header:"Buy Rate",dtRender:function(e,t,r){let a=parseFloat(e),n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'<span data-sort="'.concat(a,'">').concat(n,"</span>"):a}},{id:"BUY_AMT",accessorKey:"BUY_AMT",header:"Buy Amount",dtRender:function(e,t,r){let a=parseFloat(e),n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'<span data-sort="'.concat(a,'">').concat(n,"</span>"):a}},{id:"SALE_QTY",accessorKey:"SALE_QTY",header:"Sell Quantity",conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_RATE",accessorKey:"SALE_RATE",header:"Sell Rate",dtRender:function(e,t,r){let a=parseFloat(e),n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'<span data-sort="'.concat(a,'">').concat(n,"</span>"):a},conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"SALE_AMT",accessorKey:"SALE_AMT",header:"Sell Amount",dtRender:function(e,t,r){let a=parseFloat(e),n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'<span data-sort="'.concat(a,'">').concat(n,"</span>"):a},conditionalColumn:[["TR_TYPE",[{value:"OP_ASSETS"},{value:"ASSETS"}]]]},{id:"NET_QTY",accessorKey:"NET_QTY",header:"Net Quantity",conditionalColumn:[["TR_TYPE",[{value:"SHORTTERM"},{value:"LONGTERM"},{value:"TRADING"}]]]},{id:"CURR_AMOUNT",accessorKey:"CURR_AMOUNT",header:"Current Amount",conditionalColumn:[["TR_TYPE",[{value:"SHORTTERM"},{value:"LONGTERM"},{value:"TRADING"}]]],dtRender:function(e,t,r){let a=parseFloat(e),n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'<span data-sort="'.concat(a,'">').concat(n,"</span>"):a}},{id:"PL_AMT",accessorKey:"PL_AMT",header:"P&L Amount",profitLoss:!0,dtRender:function(e,t,r){let a=parseFloat(e),n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'<span data-sort="'.concat(a,'" class="').concat(a>=0?"text-green-600":"text-red-600",'">').concat(n,"</span>"):a}},{id:"Closing_Price",accessorKey:"Closing_Price",header:"Closing Price",dtRender:function(e,t,r){let a=parseFloat(e)||"0",n=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a);return"display"===t?'\n                    <div data-sort="'.concat(a,'" class="').concat("flex flex-col",'">\n                        <span >').concat(n,'</span>\n                        <span class="text-xs text-muted-foreground">').concat(r.PriceDate||"","</span>\n                    </div>\n                "):a}},{id:"SCRIP_SYMBOL",accessorKey:"SCRIP_SYMBOL",header:"Scrip Symbol",deselected:!0},{id:"ISIN",accessorKey:"ISIN",header:"ISIN",deselected:!0}],c=o.filter(e=>e.hidden).map(e=>e.id);var i=r(12711),d=r(85147),u=r(47282),m=r(30814),x=r(67328),S=r(42020),p=r(60208),f=r(77711),h=r(69606),y=r(85060),T=r(43415),N=r(77594),v=r(20853),j=r(73312),E=r(44870),A=r(37528),g=r(33900);let I=T.Ik({financialYear:T.Ik({fromDate:T.Yj(),toDate:T.Yj(),value:T.Yj()}),toDate:T.Yj().nonempty("To Date is required")}),b=(0,n.memo)(function(e){var t;let{financialYears:r,onSubmit:l,loading:o}=e,c=(0,h.mN)({resolver:(0,y.u)(I),defaultValues:{financialYear:r[0],toDate:(null===(t=r[0])||void 0===t?void 0:t.toDate)||""}}),{watch:i,setValue:d}=c;return(0,n.useEffect)(()=>{let e=i((e,t)=>{let{name:a}=t;if("financialYear"===a){var n,s;d("toDate",(null===(n=e.financialYear)||void 0===n?void 0:n.toDate)||(null===(s=r[0])||void 0===s?void 0:s.toDate)||"")}});return()=>e.unsubscribe()},[i,r,d]),(0,a.jsx)(E.lV,{...c,children:(0,a.jsxs)("form",{onSubmit:c.handleSubmit(e=>{let{financialYear:t,toDate:r}=e;t.fromDate&&r&&l(t.fromDate,r)}),className:"flex gap-3",children:[(0,a.jsx)(E.zB,{control:c.control,name:"financialYear",render:e=>{var t;let{field:n}=e;return(0,a.jsxs)(E.eI,{className:"w-[200px]",children:[(0,a.jsxs)(A.l6,{onValueChange:e=>{let t=r.find(t=>t.value===e);n.onChange(t)},defaultValue:(null===(t=n.value)||void 0===t?void 0:t.value)||"",children:[(0,a.jsx)(E.MJ,{children:(0,a.jsx)(A.bq,{children:(0,a.jsx)(A.yv,{placeholder:"Select year"})})}),(0,a.jsx)(A.gC,{children:r.map(e=>(0,a.jsx)(A.eb,{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)(E.C5,{})]})}}),(0,a.jsx)(E.zB,{control:c.control,name:"toDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(E.eI,{className:"w-[150px]",children:[(0,a.jsx)(E.MJ,{children:(0,a.jsx)(g.p,{type:"date",className:"flex h-10 w-full rounded-md border text-white bg-transparent px-3 py-2 text-sm",value:(0,s.GP)(new Date(t.value.split("/").reverse().join("-")),"yyyy-MM-dd"),min:(0,s.GP)(new Date(c.watch("financialYear").fromDate.split("/").reverse().join("-")),"yyyy-MM-dd"),max:(0,s.GP)(new Date(c.watch("financialYear").toDate.split("/").reverse().join("-")),"yyyy-MM-dd"),onChange:e=>{let r=new Date(e.target.value);t.onChange((0,s.GP)(r,"dd/MM/yyyy"))}})}),(0,a.jsx)(E.C5,{})]})}}),(0,a.jsx)(j.$,{type:"submit",disabled:o,children:o?(0,a.jsx)(N.A,{className:"h-5 w-5"}):(0,a.jsx)(v.A,{className:"h-5 w-5"})})]})})},(e,t)=>e.loading===t.loading&&e.financialYears===t.financialYears),_=(0,f.default)(()=>Promise.all([r.e(2226),r.e(7690),r.e(9190),r.e(1122),r.e(3740),r.e(3930),r.e(343),r.e(9690),r.e(4390),r.e(2449),r.e(8417),r.e(4156),r.e(227),r.e(3638),r.e(3266)]).then(r.bind(r,3266)),{loadableGenerated:{webpack:()=>[3266]},ssr:!1,loading:()=>(0,a.jsx)(d.A,{columns:4,rows:10})});function R(){var e,t,r,f;let[h,y]=(0,n.useState)(!1),[T,N]=(0,n.useState)(null),[v,j]=(0,n.useState)([]),[E,A]=(0,n.useState)(!1),[g,I]=(0,n.useState)([]),R=()=>{let e=new Date,t=e.getMonth(),r=e.getFullYear(),a=t<3?r-1:r;return Array.from({length:5},(e,t)=>{let r=a-t;return{label:"".concat(r,"-").concat(r+1),value:"".concat(r,"-").concat(r+1),fromDate:(0,s.GP)(new Date(r,3,1),"dd/MM/yyyy"),toDate:(0,s.GP)(new Date(r+1,2,31),"dd/MM/yyyy")}})},P=(0,n.useMemo)(()=>R(),[]),[w,O]=(0,n.useState)({financialYear:(null===(e=P[0])||void 0===e?void 0:e.value)||"",fromDate:(null===(t=P[0])||void 0===t?void 0:t.fromDate)||"",toDate:(null===(r=P[0])||void 0===r?void 0:r.toDate)||""}),M=async(e,t)=>{y(!0),N(null);try{var r;O({financialYear:(null===(r=P.find(t=>t.fromDate===e))||void 0===r?void 0:r.value)||"",fromDate:e,toDate:t});let a=await (0,u.swN)({fromDate:e,toDate:t});if(!(0,x.k9)(a)){A(!0);return}let n="string"==typeof a.data.data?JSON.parse(a.data.data):a.data.data;if("True"===n.Success){m.oR.success("Data fetched successfully!");let e=n["Success Description"],t=e.filter(e=>"EXPENSES"===e.TR_TYPE),r=e.filter(e=>"EXPENSES"!==e.TR_TYPE);I(t),j(r)}else throw Error(n["Error Description"]||"Failed to fetch data.")}catch(e){N(e.message||"An error occurred.")}finally{y(!1)}};(0,n.useEffect)(()=>{let{fromDate:e,toDate:t}=P[0];M(e,t)},[]);let Y=Object.entries(v.map(e=>({...e,TR_TYPE:["LONGTERM","OP LONGTERM"].includes(e.TR_TYPE)?"LONGTERM":["SHORTTERM","OP_SHORTTERM"].includes(e.TR_TYPE)?"SHORTTERM":e.TR_TYPE})).reduce((e,t)=>{var r,a;let n=t.TR_TYPE;return e[n]||(e[n]={rows:[],sum:0}),e[n].rows.push(t),"LIABILITIES"===n?e[n].sum+=Number.parseFloat((null===(r=t.SALE_AMT)||void 0===r?void 0:r.toString())||"0"):e[n].sum+=Number.parseFloat((null===(a=t.PL_AMT)||void 0===a?void 0:a.toString())||"0"),e},{})).sort((e,t)=>{let[r]=e,[a]=t;return"OP_ASSETS"===r?-1:"OP_ASSETS"===a?1:"ASSETS"===r?-1:"ASSETS"===a?1:0}).reduce((e,t)=>{let[r,a]=t;return e[r]=a,e},{}),L=e=>null==e?void 0:e.replace(/^\*|\*$/g,""),D=(()=>{let e={};g.forEach(t=>{let{SCRIP_SYMBOL:r,PL_AMT:a}=t,n=L(r),s="CGST"===n||"SGST"===n?"GST":n;e[s]||(e[s]={SCRIP_SYMBOL:s,PL_AMT:0}),e[s].PL_AMT+=Number(a)});let t=Object.values(e),r=["STT","STAMP DUTY","GST"];return t.sort((e,t)=>{let a=r.indexOf(e.SCRIP_SYMBOL),n=r.indexOf(t.SCRIP_SYMBOL);return -1!==a&&-1!==n?a-n:-1!==a?-1:-1!==n?1:0})})(),C=null==g?void 0:g.reduce((e,t)=>{var r;return e+Number.parseFloat((null===(r=t.PL_AMT)||void 0===r?void 0:r.toString())||"0")},0);return Object.entries(Y).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).reduce((e,t)=>{let[,{sum:r}]=t;return e+r},0),Object.entries(Y).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).reduce((e,t)=>{let[,{sum:r}]=t;return e+r},0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.default,{children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{className:"flex flex-col md:flex-col sm:flex-col mb-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(l.ZB,{children:"Summarized P&L Equity"})}),(0,a.jsx)("div",{className:"flex-shrink-0 m-0",children:(0,a.jsx)(b,{financialYears:P,onSubmit:M,loading:h})})]}),(0,a.jsxs)(l.Wu,{children:[(Object.keys(Y).length>0||D.length>0)&&!T&&(0,a.jsx)(p.A,{sortedGroupedData:Y,processedExpensesData:D.reduce((e,t)=>(e[t.SCRIP_SYMBOL]={rows:[t],sum:t.PL_AMT},e),{}),totalExpenses:C,handleTypeClick:e=>{let t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})}}),h?(0,a.jsx)(d.A,{columns:4,rows:10}):T?(0,a.jsx)("div",{className:"text-center text-red-500 p-4 bg-red-100 rounded-md",children:T}):(0,a.jsx)(_,{columns:o,data:Y,hiddenColumns:c,filterColumn:"scrip_name1",filterPlaceholder:"Filter Scrip...",includeFileData:!0,showAllRows:!0,year:w.financialYear,fromDate:w.fromDate,toDate:w.toDate,totalDataSummary:{unrealized:Object.entries(Y).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).reduce((e,t)=>{let[,{sum:r}]=t;return e+r},0),realized:Object.entries(Y).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).reduce((e,t)=>{let[,{sum:r}]=t;return e+r},0)-Math.abs(Number(C)),liabilities:(null===(f=Y.LIABILITIES)||void 0===f?void 0:f.sum)||0},expensesData:{rowKey:"SCRIP_SYMBOL",rowAmount:"PL_AMT",rows:D,total:C},showPagination:!1,downloadFileName:"Summarized_P&L_Equity",columnsWithTotals:["BUY_QTY","BUY_AMT","SALE_QTY","SALE_AMT","NET_QTY","CURR_AMOUNT","PL_AMT"]}),(0,a.jsx)(S.A,{processedExpensesData:D,totalExpenses:C,expenseRowKey:"SCRIP_SYMBOL",expenseRowAmount:"PL_AMT"})]})]})})}),E&&(0,a.jsx)(x.Bs,{})]})}},60208:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(95155);r(12115);var n=r(35765),s=r(1541);let l=e=>{let{sortedGroupedData:t,processedExpensesData:r,totalExpenses:l,handleTypeClick:o}=e;if(0===Object.keys(t).length)return null;let c=Object.entries(t).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).reduce((e,t)=>{let[,{sum:r}]=t;return e+r},0),i=Object.entries(t).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).reduce((e,t)=>{let[,{sum:r}]=t;return e+r},0)-Math.abs(Number(l));return(0,a.jsx)("div",{className:"flex justify-start items-center",children:(0,a.jsx)("div",{className:"w-full max-w-screen-xl px-4",children:(0,a.jsxs)("div",{className:"flex flex-col justify-start gap-4 mb-3 md:mb-2 lg:mb-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-start items-center lg:gap-6 sm:gap-3",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold flex gap-2 items-center py-2",children:["Unrealized",(0,a.jsx)("p",{className:"text-sm font-regular",children:c>=0?"Profit":"Loss"}),(0,a.jsx)("p",{className:"text-sm font-regular ".concat(c>=0?"text-green-600":"text-red-600"),children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(c).replace(/^(\D?)(.+)$/,(e,t,r)=>"(".concat(t," ").concat(r,")"))})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(t).filter(e=>{let[t]=e;return"OP_ASSETS"===t||"ASSETS"===t}).map(e=>{let[t,{sum:r}]=e;return(0,a.jsxs)("div",{className:"flex flex-wrap border gap-2 items-center justify-between cursor-pointer hover:bg-accent hover:text-accent-foreground p-2 rounded-md transition-all duration-300 ease-in-out group shadow-sm hover:shadow-md",onClick:()=>o(t),children:[(0,a.jsx)("h3",{className:"text-sm font-semibold group-hover:underline transition-all duration-200",children:"OP_ASSETS"===t?"OPENING ASSETS":t.toUpperCase()}),(0,a.jsx)("p",{className:"text-xs font-regular",children:r>=0?"Profit":"Loss"}),(0,a.jsxs)("p",{className:"text-xs ".concat(r>=0?"text-green-600":"text-red-600"," transition-colors duration-300 flex gap-2"),children:[(0,a.jsx)(s.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r)}),(0,a.jsx)(n.A,{size:15,className:"text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]})]},t)})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap justify-start items-center lg:gap-6 sm:gap-3",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold flex gap-2 items-center py-2",children:["Realized",(0,a.jsx)("p",{className:"text-sm font-regular",children:i>=0?"Profit":"Loss"}),(0,a.jsx)("p",{className:"text-sm font-regular ".concat(i>=0?"text-green-600":"text-red-600"),children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(i).replace(/^(\D?)(.+)$/,(e,t,r)=>"(".concat(t).concat(r,")"))})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[Object.entries(t).filter(e=>{let[t]=e;return"OP_ASSETS"!==t&&"ASSETS"!==t&&"LIABILITIES"!==t}).map(e=>{let[t,{sum:r}]=e;return(0,a.jsxs)("div",{className:"flex border flex-wrap gap-2 items-center justify-between cursor-pointer hover:bg-accent hover:text-accent-foreground p-2 rounded-md transition-all duration-300 ease-in-out group shadow-sm hover:shadow-md",onClick:()=>o(t),children:[(0,a.jsx)("h3",{className:"text-sm font-semibold group-hover:underline transition-all duration-200",children:t.toUpperCase()}),(0,a.jsx)("p",{className:"text-xs font-regular",children:r>=0?"Profit":"Loss"}),(0,a.jsxs)("p",{className:"text-xs ".concat(r>=0?"text-green-600":"text-red-600"," transition-colors duration-300 flex gap-2"),children:[(0,a.jsx)(s.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r)}),(0,a.jsx)(n.A,{size:15,className:"text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]})]},t)}),r&&Object.keys(r).length>0&&(0,a.jsxs)("div",{className:"flex border gap-2 items-center justify-between cursor-pointer hover:bg-accent hover:text-accent-foreground p-2 rounded-md transition-all duration-300 ease-in-out group shadow-sm hover:shadow-md",onClick:()=>o("expenses"),children:[(0,a.jsx)("h3",{className:"text-sm font-semibold group-hover:underline transition-all duration-200",children:"EXPENSES"}),(0,a.jsxs)("p",{className:"text-xs ".concat(l>=0?"text-green-600":"text-red-600"," transition-colors duration-300 flex gap-2"),children:[(0,a.jsx)(s.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Math.abs(Number(l)))}),(0,a.jsx)(n.A,{size:15,className:"text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]})]},"expenses")]})]}),(0,a.jsx)("div",{className:"flex justify-start items-center gap-2",children:(0,a.jsx)("div",{className:"flex gap-4",children:Object.entries(t).filter(e=>{let[t]=e;return"LIABILITIES"===t}).map(e=>{let[t,{sum:r}]=e;return(0,a.jsxs)("div",{className:"flex border gap-2 items-center justify-between cursor-pointer hover:bg-accent hover:text-accent-foreground p-2 rounded-md transition-all duration-300 ease-in-out group shadow-sm hover:shadow-md",onClick:()=>o(t),children:[(0,a.jsx)("h3",{className:"text-sm font-semibold group-hover:underline transition-all duration-200",children:t.toUpperCase()}),(0,a.jsx)("p",{className:"text-xs font-regular",children:r>=0?"Profit":"Loss"}),(0,a.jsxs)("p",{className:"text-xs ".concat(r>=0?"text-green-600":"text-red-600"," transition-colors duration-300 flex gap-2"),children:[(0,a.jsx)(s.A,{animateOn:"view",revealDirection:"center",characters:"123456789",text:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(r)}),(0,a.jsx)(n.A,{size:15,className:"text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]})]},t)})})})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1181,8526,8562,164,2589,814,8007,5565,9526,6143,4015,8665,6527,7518,5427,7733,6137,7555,7328,9086,5960,8441,1517,7358],()=>t(18873)),_N_E=e.O()}]);
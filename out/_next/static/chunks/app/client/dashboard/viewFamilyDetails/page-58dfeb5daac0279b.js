(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[525],{44908:(e,s,a)=>{Promise.resolve().then(a.bind(a,11011))},11011:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>J});var t=a(95155),l=a(12115),r=a(12711),i=a(47282),n=a(67328),d=a(58690),c=a(73312),m=a(21773),o=a(28701),x=a(38002),u=a(30814),h=a(51344),f=a(33900),p=a(98986),g=a(33473),j=a(26336),y=a(42640),b=a(57517),N=a(61594),v=a(14505),w=a(77995);function C(e){let{open:s,onOpenChange:a,onSuccess:r}=e,[m,o]=(0,l.useState)("details"),[C,A]=(0,l.useState)({familyClientId:"",pan:"",otp:""}),[k,F]=(0,l.useState)(!1),[I,R]=(0,l.useState)(null),[D,S]=(0,l.useState)(!1),P=(0,d.Lg)("currentClientId"),O=()=>{A({familyClientId:"",pan:"",otp:""}),R(null),o("details")},T=e=>/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/.test(e.toUpperCase()),E=async e=>{if(e.preventDefault(),R(null),!C.familyClientId.trim()){R("Please enter Family Client ID");return}if(C.familyClientId.trim().length<3){R("Family Client ID must be at least 3 characters long");return}if(!C.pan.trim()){R("Please enter PAN");return}if(!T(C.pan)){R("Please enter a valid PAN (e.g., ABCDE1234F)");return}F(!0);try{let e=await (0,i.$Uz)({clientId:P,familyClientId:C.familyClientId.trim(),familyClientPan:C.pan.trim().toUpperCase()});if(!(0,n.k9)(e)){S(!0);return}if(200===e.status){var s,a,t,l;if(null===(s=e.data)||void 0===s?void 0:s.data.status)o("otp-sent"),u.oR.success((null===(t=e.data)||void 0===t?void 0:t.data.message)||"OTP sent successfully");else if(!(null===(a=e.data)||void 0===a?void 0:a.data.status)){let s=(null===(l=e.data)||void 0===l?void 0:l.data.message)||"Failed to send OTP";R(s),u.oR.error(s)}}}catch(s){let e=s.message||"An error occurred while sending OTP";R(e),u.oR.error(e)}finally{F(!1)}},$=async e=>{if(e.preventDefault(),R(null),!C.otp.trim()){R("Please enter OTP");return}if(6!==C.otp.trim().length){R("OTP must be 6 digits");return}if(!/^\d{6}$/.test(C.otp.trim())){R("OTP must contain only numbers");return}F(!0);try{var s,t;let e=await (0,i.myk)({clientId:P,familyClientId:C.familyClientId.trim(),otp:C.otp.trim()});if(!(0,n.k9)(e)){S(!0);return}if(200===e.status)o("verify-otp"),u.oR.success((null===(s=e.data)||void 0===s?void 0:s.data.message)||"Family member added successfully"),setTimeout(()=>{O(),a(!1),r()},1500);else{let s=(null===(t=e.data)||void 0===t?void 0:t.data.message)||"Failed to verify OTP";R(s),u.oR.error(s)}}catch(s){let e=s.message||"An error occurred while verifying OTP";R(e),u.oR.error(e)}finally{F(!1)}},L=async()=>{R(null),F(!0);try{let s=await (0,i.$Uz)({familyClientId:C.familyClientId.trim(),pan:C.pan.trim().toUpperCase()});if(200===s.status)A(e=>{var a;return{...e,otpId:(null===(a=s.data)||void 0===a?void 0:a.otpId)||"",otp:""}}),u.oR.success("New OTP sent successfully");else{var e;R((null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to resend OTP")}}catch(e){R(e.message||"An error occurred while resending OTP")}finally{F(!1)}},_=e=>{e||k||O(),a(e)},z=(e,s)=>{A(a=>({...a,[e]:s})),I&&R(null)},M=C.familyClientId.trim().length>=3&&10===C.pan.trim().length&&T(C.pan),Z=6===C.otp.trim().length&&/^\d{6}$/.test(C.otp.trim());return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.lG,{open:s,onOpenChange:_,children:[(0,t.jsx)(h.zM,{asChild:!0,children:(0,t.jsxs)(c.$,{className:"flex items-center justify-center gap-2 w-full sm:w-auto",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Add Family Member"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Add Member"})]})}),(0,t.jsxs)(h.Cf,{className:"w-[95vw] max-w-[500px] max-h-[90vh] flex flex-col",children:[(0,t.jsxs)(h.c7,{className:"space-y-3",children:[(0,t.jsxs)(h.L3,{className:"flex items-center gap-2 text-lg",children:["verify-otp"===m?(0,t.jsx)(j.A,{className:"h-5 w-5 text-green-600"}):"otp-sent"===m?(0,t.jsx)(y.A,{className:"h-5 w-5 text-orange-600"}):(0,t.jsx)(b.A,{className:"h-5 w-5 text-blue-600"}),"verify-otp"===m?"Success!":"otp-sent"===m?"Verify OTP":"Add Family Member"]}),(0,t.jsx)(h.rr,{className:"text-sm text-inherit-600",children:"verify-otp"===m?"Family member has been added successfully!":"otp-sent"===m?"Enter the 6-digit OTP sent to verify and add the family member.":"Enter the Family Client ID and PAN to send OTP for verification."})]}),(0,t.jsx)(w.F,{className:"flex-1 pr-4",children:(0,t.jsxs)("div",{className:"space-y-6",children:[I&&(0,t.jsxs)(x.Fc,{className:"border-red-200 bg-red-50",children:[(0,t.jsx)(N.A,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(x.TN,{className:"text-red-800",children:I})]}),"details"===m&&(0,t.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(p.J,{htmlFor:"familyClientId",className:"text-sm font-medium",children:["Family Client ID ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(f.p,{id:"familyClientId",placeholder:"Enter family client ID",value:C.familyClientId,onChange:e=>z("familyClientId",e.target.value),required:!0,className:I&&!C.familyClientId.trim()?"border-red-300 focus:border-red-500":"",disabled:k}),(0,t.jsx)("p",{className:"text-xs text-inherit-500",children:"The unique client ID of the family member"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(p.J,{htmlFor:"pan",className:"text-sm font-medium",children:["Family Client PAN ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(f.p,{id:"pan",placeholder:"Enter PAN (e.g., ABCDE1234F)",value:C.pan,onChange:e=>z("pan",e.target.value.toUpperCase()),required:!0,maxLength:10,className:!I||C.pan.trim()&&T(C.pan)?"":"border-red-300 focus:border-red-500",disabled:k}),(0,t.jsx)("p",{className:"text-xs text-inherit-500",children:"Enter the 10-digit PAN number"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 pt-4 border-t",children:[(0,t.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>_(!1),className:"w-full sm:w-auto",disabled:k,children:"Cancel"}),(0,t.jsx)(c.$,{type:"submit",className:"w-full sm:w-auto gap-2",disabled:k||!M,children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.A,{className:"h-4 w-4 animate-spin"}),"Sending OTP..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.A,{className:"h-4 w-4"}),"Send OTP"]})})]})]}),"otp-sent"===m&&(0,t.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(p.J,{htmlFor:"otp",className:"text-sm font-medium",children:["Enter OTP ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(f.p,{id:"otp",placeholder:"Enter 6-digit OTP",value:C.otp,onChange:e=>z("otp",e.target.value.replace(/\D/g,"")),required:!0,maxLength:6,className:I&&(!C.otp.trim()||6!==C.otp.length)?"border-red-300 focus:border-red-500":"",disabled:k,autoFocus:!0}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-xs text-inherit-500",children:"Enter the 6-digit OTP sent to your registered mobile"}),(0,t.jsx)(c.$,{type:"button",variant:"link",className:"h-auto p-0 text-xs text-blue-600",onClick:L,disabled:k,children:"Resend OTP"})]})]})}),(0,t.jsxs)("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 pt-4 border-t",children:[(0,t.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>o("details"),className:"w-full sm:w-auto",disabled:k,children:"Back"}),(0,t.jsx)(c.$,{type:"submit",className:"w-full sm:w-auto gap-2",disabled:k||!Z,children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.A,{className:"h-4 w-4 animate-spin"}),"Verifying..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.A,{className:"h-4 w-4"}),"Verify & Add"]})})]})]}),"verify-otp"===m&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(j.A,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Family Member Added!"}),(0,t.jsx)("p",{className:"text-sm text-inherit-600",children:"The family member has been successfully added to your account."})]}),"details"===m&&(0,t.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-sm text-blue-800 border border-blue-200",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"\uD83D\uDCA1 Pro Tip:"}),(0,t.jsx)("p",{children:"Ensure the Family Client ID and PAN belong to a valid user in the system."})]}),"otp-sent"===m&&(0,t.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 text-sm text-orange-800 border border-orange-200",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"\uD83D\uDD10 Security Note:"}),(0,t.jsx)("p",{children:"OTP is valid for 10 minutes. Don't share it with anyone."})]})]})})]})]}),D&&(0,t.jsx)(n.Bs,{})]})}var A=a(1466),k=a(20853),F=a(92823),I=a(35765),R=a(45686),D=a(10445),S=a(92598),P=a(70422),O=a(69343),T=a(53601),E=a(22130),$=a(21567),L=a(15157);let _=["clientId","clientName","email","pan","mobile","birthDate","branchCode"];function z(e){let{familyMembers:s,loading:a,refreshing:r=!1,onRemove:i,onAddClick:n,onMemberClick:d}=e,[m,o]=l.useState(null),[x,u]=l.useState(null),[f,p]=l.useState(!1),[j,y]=(0,l.useState)(""),[b,N]=(0,l.useState)(null),w=(0,l.useRef)({}),C=async()=>{if(!m)return;p(!0);let e=await i(m);p(!1),e&&o(null)},z=(e,s)=>{!s.target.closest("button")&&d&&d(e)},M=(e,s)=>{s.stopPropagation(),u(e)},Z=e=>e.split(/(?=[A-Z])|_/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),U=(0,l.useMemo)(()=>j.trim()?s.filter(e=>e.clientName.toLowerCase().includes(j.toLowerCase())):[],[j,s]),J=e=>{let s=w.current[e];s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),N(e),setTimeout(()=>N(null),1500)),y("")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"relative",children:[r&&(0,t.jsx)(()=>(0,t.jsx)("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-10 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-white px-4 py-2 rounded-lg shadow-lg",children:[(0,t.jsx)(v.A,{className:"h-4 w-4 animate-spin text-blue-600"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Refreshing..."})]})}),{}),a?(0,t.jsx)(()=>(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6",children:[...Array(8)].map((e,s)=>(0,t.jsx)(E.Zp,{className:"animate-pulse",children:(0,t.jsxs)(E.Wu,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-full"}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/3"})]})]})},s))}),{}):0===s.length?(0,t.jsx)(()=>(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(A.A,{className:"h-10 w-10 text-blue-600"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"No family members found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-8 text-sm sm:text-base max-w-md mx-auto",children:"No family member mappings found. You can add members to view holdings, ledger, and reports ."}),(0,t.jsxs)(c.$,{onClick:n,size:"lg",className:"gap-2",children:[(0,t.jsx)(g.A,{className:"h-5 w-5"}),"Add Your First Family Member"]})]}),{}):(0,t.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"w-full sm:w-1/2 relative",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400",children:(0,t.jsx)(k.A,{className:"h-4 w-4"})}),(0,t.jsx)("input",{type:"text",placeholder:"Search family member...",className:"w-full border border-gray-300 pl-9 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-md",value:j,onChange:e=>y(e.target.value)})]}),U.length>0&&(0,t.jsx)("div",{className:"absolute z-20 mt-1 w-full bg-white border border-gray-200 rounded shadow-lg max-h-60 overflow-y-auto",children:U.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-800 hover:bg-gray-100 cursor-pointer",onClick:()=>J(e.clientId),children:[(0,t.jsx)(A.A,{className:"h-4 w-4 text-blue-500"}),e.clientName]},e.clientId))})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 flex items-center gap-1 pl-1",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 text-gray-400"}),"Showing ",s.length," family member",1!==s.length?"s":""]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-6",children:s.map(e=>(0,t.jsxs)(E.Zp,{ref:s=>{w.current[e.clientId]=s},className:(0,$.cn)("group relative hover:shadow-lg hover:border-gray-300 transition-all duration-300 cursor-pointer hover:scale-[1.02] mt-3",b===e.clientId&&"ring-2 ring-blue-500 ring-offset-2"),onClick:d?s=>z(e,s):void 0,children:[d&&(0,t.jsx)("div",{className:"absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(I.A,{className:"h-4 w-4 text-gray-400"})}),(0,t.jsxs)(E.Wu,{className:"p-6 pb-2",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(A.A,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 truncate text-md sm:text-base",children:e.clientName}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 truncate",children:["Client ID: ",e.clientId.toUpperCase()]})]})]}),(0,t.jsx)(T.Bc,{children:(0,t.jsxs)(T.m_,{children:[(0,t.jsx)(T.k$,{asChild:!0,children:(0,t.jsx)(c.$,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),o(e.clientId)},className:"text-red-600 hover:bg-red-50 hover:text-red-700 opacity-100 transition-all duration-200 flex-shrink-0",children:(0,t.jsx)(R.A,{className:"h-4 w-4"})})}),(0,t.jsx)(T.ZI,{children:"Remove family member"})]})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[e.pan&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 truncate",children:[(0,t.jsx)(D.A,{className:"h-4 w-4 flex-shrink-0"}),e.pan]}),(0,t.jsxs)("div",{className:"pt-3 border-t border-gray-100 flex items-center justify-center",children:[(0,t.jsxs)(c.$,{variant:"ghost",size:"sm",className:"w-full text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 gap-2",onClick:s=>M(e,s),children:[(0,t.jsx)(S.A,{className:"h-3 w-3"}),"View Details"]}),(0,t.jsx)(L.w,{orientation:"vertical",className:"mr-4 h-6"}),(0,t.jsxs)("span",{className:"w-full text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 gap-2 flex items-center hover:m-2 mx-2",children:[(0,t.jsx)(P.A,{className:"h-3 w-3"}),"Go to Dashboard"]})]})]})]})]},e.clientId))})]})]}),(0,t.jsx)(h.lG,{open:!!x,onOpenChange:e=>!e&&u(null),children:(0,t.jsxs)(h.Cf,{className:"w-[95vw] max-w-4xl max-h-[90vh] overflow-y-auto pt-0",children:[(0,t.jsxs)(h.c7,{className:"space-y-3 sticky top-0 bg-white pb-4 border-b pt-4",children:[(0,t.jsxs)(h.L3,{className:"flex items-center gap-2 text-xl",children:[(0,t.jsx)(A.A,{className:"h-5 w-5 text-blue-600"}),null==x?void 0:x.clientName," - Details"]}),(0,t.jsx)(h.rr,{className:"text-sm text-gray-600",children:"Complete information for this family member"})]}),x&&Object.keys(x).length>0?(0,t.jsxs)("div",{className:"space-y-6 pt-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-4",children:[null==_?void 0:_.filter(e=>"segment"!==e&&x[e]).map(e=>(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-900 block mb-2",children:Z(e)}),(0,t.jsx)("span",{className:"text-sm text-gray-700 break-words",children:String(x[e])})]},e)),Object.entries(x).filter(e=>{let[s]=e;return!(null==_?void 0:_.includes(s))&&"segment"!==s}).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-900 block mb-2",children:Z(s)}),(0,t.jsx)("span",{className:"text-sm text-gray-700 break-words",children:String(a)})]},s)})]}),"segment"in x&&x.segment&&(0,t.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,t.jsx)("span",{className:"font-semibold text-blue-900 block mb-2 text-lg",children:"Segment"}),(0,t.jsx)("span",{className:"text-sm text-blue-800 break-words",children:String(x.segment)})]})]}):(0,t.jsx)("div",{className:"text-gray-500 text-center p-8 italic",children:"No details available for this member."})]})}),(0,t.jsx)(O.Lt,{open:!!m,onOpenChange:e=>!e&&o(null),children:(0,t.jsxs)(O.EO,{className:"w-[95vw] max-w-md",children:[(0,t.jsxs)(O.wd,{children:[(0,t.jsxs)(O.r7,{className:"flex items-center gap-2",children:[(0,t.jsx)(R.A,{className:"h-5 w-5 text-red-600"}),"Remove Family Member"]}),(0,t.jsxs)(O.$v,{className:"text-base",children:["Are you sure you want to remove this family member? This action cannot be undone and will:",(0,t.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1 text-sm",children:[(0,t.jsx)("li",{children:"Remove their access to family-related information"}),(0,t.jsx)("li",{children:"Disconnect them from your family network"}),(0,t.jsx)("li",{children:"Remove any shared permissions or access"})]})]})]}),(0,t.jsxs)(O.ck,{className:"flex-col sm:flex-row gap-2",children:[(0,t.jsx)(O.Zr,{disabled:f,className:"w-full sm:w-auto",children:"Cancel"}),(0,t.jsx)(O.Rx,{onClick:C,disabled:f,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600 w-full sm:w-auto",children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.A,{className:"h-4 w-4 animate-spin mr-2"}),"Removing..."]}):"Remove Member"})]})]})})]})}var M=a(25121);function Z(e){let{open:s,onOpenChange:a,familyHeads:r,loading:i,error:n,onRefresh:d,onRemove:o}=e,[x,u]=l.useState(null),[f,p]=l.useState(!1),g=async()=>{if(!x)return;p(!0);let e=await o(x);p(!1),e&&u(null)},j=e=>{if(!e)return null;try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(s){return e}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.lG,{open:s,onOpenChange:a,children:(0,t.jsxs)(h.Cf,{className:"w-[95vw] max-w-[700px] max-h-[90vh] flex flex-col",children:[(0,t.jsx)(h.c7,{className:"pb-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)(h.L3,{className:"flex items-center gap-2",children:[(0,t.jsx)(F.A,{className:"h-5 w-5 text-blue-600"}),"Mapped As Member"]}),(0,t.jsx)(h.rr,{className:"mt-2",children:"You have been added as a family member under a primary client. Your reports may be accessible to them for viewing individually, based on the permissions configured"})]}),(0,t.jsxs)("div",{className:"flex items-center  gap-2 mr-4",children:[r.length>0&&!n&&(0,t.jsxs)(M.E,{variant:"secondary",className:"text-xs",children:[r.length," families"]}),(0,t.jsxs)(c.$,{variant:"outline",size:"sm",onClick:d,disabled:i,className:"gap-2",children:[(0,t.jsx)(m.A,{className:"h-4 w-4 ".concat(i?"animate-spin":"")}),(0,t.jsx)("span",{className:"inline",children:"Refresh"})]})]})]})}),(0,t.jsx)(L.w,{}),(0,t.jsx)(w.F,{className:"flex-1 pr-2",children:i?(0,t.jsx)(()=>(0,t.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"animate-pulse",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-full"}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"}),(0,t.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]}),(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded"})]})},s))}),{}):n?(0,t.jsx)(()=>(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(N.A,{className:"h-6 w-6 text-red-600"})}),(0,t.jsx)("div",{className:"text-red-600 font-medium mb-2",children:"Failed to Load"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:n}),(0,t.jsxs)(c.$,{variant:"outline",size:"sm",onClick:d,className:"gap-2",children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),"Try Again"]})]}),{}):0===r.length?(0,t.jsx)(()=>(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(F.A,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Family Memberships Found"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm max-w-md mx-auto",children:"You are not currently a member of any family. When someone adds you as a family member, those connections will appear here."})]}),{}):(0,t.jsx)("div",{className:"space-y-4",children:r.map((e,s)=>(0,t.jsxs)("div",{className:"group relative bg-inherit border border-gray-200 rounded-lg p-4 hover:shadow-md hover:border-gray-300 transition-all duration-200",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-100 to-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(A.A,{className:"h-6 w-6 text-emerald-600"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-1",children:[(0,t.jsx)("h4",{className:"font-semibold text-inherit-900 truncate",children:e.client_name}),(0,t.jsx)(M.E,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-200 w-fit",children:"Family Head"})]}),(0,t.jsxs)("p",{className:"text-xs text-inherit-500 truncate mb-2",children:["Client ID: ",e.client_id.toUpperCase()]}),(0,t.jsxs)("div",{className:"space-y-1",children:[e.phone&&(0,t.jsxs)("p",{className:"text-xs text-inherit-600 flex items-center gap-1",children:["\uD83D\uDCDE ",(0,t.jsx)("span",{className:"truncate",children:e.phone})]}),e.email&&(0,t.jsxs)("p",{className:"text-xs text-inherit-600 flex items-center gap-1 min-w-0",children:["✉️ ",(0,t.jsx)("span",{className:"truncate",children:e.email})]}),e.family_size&&(0,t.jsxs)("p",{className:"text-xs text-inherit-600 flex items-center gap-1",children:["\uD83D\uDC65 ",e.family_size," members"]}),e.joined_date&&(0,t.jsxs)("p",{className:"text-xs text-inherit-500",children:["Joined: ",j(e.joined_date)]})]})]})]}),(0,t.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>u(e.client_id),className:"text-red-600 hover:bg-red-500 transition-all duration-200 flex-shrink-0",title:"Leave this family",children:(0,t.jsx)(R.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"absolute top-2 left-2 w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs font-medium text-gray-600",children:s+1})})]},e.client_id))})}),r.length>0&&!n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.w,{}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 text-center py-2",children:["You are a member of ",r.length," famil",1===r.length?"y":"ies"]})]})]})}),(0,t.jsx)(O.Lt,{open:!!x,onOpenChange:e=>!e&&u(null),children:(0,t.jsxs)(O.EO,{className:"w-[95vw] max-w-md",children:[(0,t.jsxs)(O.wd,{children:[(0,t.jsxs)(O.r7,{className:"flex items-center gap-2",children:[(0,t.jsx)(R.A,{className:"h-5 w-5 text-red-600"}),"Leave Family"]}),(0,t.jsxs)(O.$v,{className:"text-base",children:["Are you sure you want to remove yourself from this family? This action will:",(0,t.jsxs)("ul",{className:"list-disc list-inside mt-3 space-y-1 text-sm",children:[(0,t.jsx)("li",{children:"Remove your access to this family's information"}),(0,t.jsx)("li",{children:"Disconnect you from their family network"}),(0,t.jsx)("li",{children:"Remove any shared permissions or benefits"}),(0,t.jsx)("li",{children:"Require re-invitation to rejoin"})]}),(0,t.jsx)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-md",children:(0,t.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,t.jsx)("strong",{children:"Note:"})," You cannot undo this action. You'll need to be re-invited by the family head to rejoin."]})})]})]}),(0,t.jsxs)(O.ck,{className:"flex-col sm:flex-row gap-2",children:[(0,t.jsx)(O.Zr,{disabled:f,className:"w-full sm:w-auto",children:"Cancel"}),(0,t.jsx)(O.Rx,{onClick:g,disabled:f,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600 w-full sm:w-auto",children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.A,{className:"h-4 w-4 animate-spin mr-2"}),"Leaving..."]}):"Leave Family"})]})]})})]})}var U=a(83469);function J(){let[e,s]=(0,l.useState)(!1),[a,h]=(0,l.useState)(!1),[f,p]=(0,l.useState)(null),[g,j]=(0,l.useState)(!1),[y,b]=(0,l.useState)([]),[N,v]=(0,l.useState)(!1),[w,A]=(0,l.useState)(!1),[k,F]=(0,l.useState)([]),[I,R]=(0,l.useState)(!1),[D,S]=(0,l.useState)(null),P=(0,d.Lg)("currentClientId"),O=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?v(!0):h(!0),p(null);try{var a;let e=await (0,i.Udn)({clientId:P});if(!(0,n.k9)(e)){s(!0);return}if(!e.status||200!==e.status)throw Error("Failed to fetch family members");if(null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.data)try{let s="string"==typeof e.data.data?JSON.parse(e.data.data):e.data.data;b(s)}catch(e){p("Error parsing data: "+e.message)}else throw Error("Invalid API response format.")}catch(e){p(e.message||"An error occurred while fetching family members")}finally{h(!1),v(!1)}},[P]),T=(0,l.useCallback)(async()=>{R(!0),S(null);try{var e;let a=await (0,i.In8)({clientId:P});if(!(0,n.k9)(a)){s(!0);return}if(!a.status||200!==a.status)throw Error("Failed to fetch family heads");if(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.data)try{let e="string"==typeof a.data.data?JSON.parse(a.data.data):a.data.data;F(e)}catch(e){S("Error parsing data: "+e.message)}else throw Error("Invalid API response format.")}catch(e){S(e.message||"An error occurred while fetching family heads")}finally{R(!1)}},[P]),$=async e=>{try{var a;let t=await (0,i.j_V)({clientId:P,familyClientId:e});if(!(0,n.k9)(t))return s(!0),!1;if(200!==t.status)return u.oR.error("Failed to remove family member"),!1;return u.oR.success((null===(a=t.data)||void 0===a?void 0:a.data.message)||"Family member removed successfully"),O(),!0}catch(e){return u.oR.error(e.message||"An error occurred while removing family member"),!1}},L=async e=>{try{var a;let t=await (0,i.lJe)({clientId:P,familyHeadClientId:e});if(!(0,n.k9)(t))return s(!0),!1;if(200!==t.status)return u.oR.error("Failed to remove family member"),!1;return u.oR.success((null===(a=t.data)||void 0===a?void 0:a.data.message)||"Removed from family successfully"),T(),!0}catch(e){return u.oR.error(e.message||"An error occurred while removing family member"),!1}};return(0,l.useEffect)(()=>{O()},[O]),(0,l.useEffect)(()=>{w&&0===k.length&&!I&&T()},[k.length,w,I,T]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.default,{children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)(E.Zp,{className:"w-full shadow-lg",children:[(0,t.jsxs)(E.aR,{className:"flex flex-col gap-1 sm:gap-1 lg:flex-col lg:items-start",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row sm:items-center gap-2 w-full sm:w-auto",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Mapped Clients"}),(0,t.jsxs)(c.$,{variant:"default",size:"sm",onClick:()=>{O(!0)},disabled:a||N,className:"gap-2 sm:w-auto w-fit self-start sm:self-auto",children:[(0,t.jsx)(m.A,{className:"h-4 w-4 ".concat(N?"animate-spin":"")}),"Refresh"]})]}),(0,t.jsxs)("div",{className:"flex flex-row sm:flex-row sm:items-center gap-2  sm:w-auto w-fit mx-auto sm:mx-0",children:[(0,t.jsx)(C,{open:g,onOpenChange:j,onSuccess:O}),(0,t.jsxs)(c.$,{variant:"secondary",className:"flex items-center justify-center gap-2 w-fit sm:w-auto",onClick:()=>A(!0),children:[(0,t.jsx)(o.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"inline",children:"Mapped As Member"})]})]})]}),(0,t.jsx)(E.BT,{className:"text-md",children:"Family members mapped under your client code will appear here. You can view their individual reports such as holdings, ledger, and transactions as per access rights."})]}),(0,t.jsxs)(E.Wu,{children:[f&&(0,t.jsx)(x.Fc,{className:"mb-6 border-red-200 bg-red-50",children:(0,t.jsx)(x.TN,{className:"text-red-800",children:f})}),(0,t.jsx)(z,{familyMembers:y,loading:a,refreshing:N,onRemove:$,onAddClick:()=>j(!0),onMemberClick:e=>{let s=e.clientId;sessionStorage.setItem("familyClientCheck_".concat(s),JSON.stringify(e));let a=(0,U.K)("/client/dashboard");window.open("".concat(a,"?clientId=").concat(s,"&familyClientCheck=true"),"_blank")}}),(0,t.jsx)(Z,{open:w,onOpenChange:A,familyHeads:k,loading:I,error:D,onRefresh:T,onRemove:L})]})]})})}),e&&(0,t.jsx)(n.Bs,{})]})}},69343:(e,s,a)=>{"use strict";a.d(s,{$v:()=>f,EO:()=>o,Lt:()=>d,Rx:()=>p,Zr:()=>g,ck:()=>u,r7:()=>h,wd:()=>x});var t=a(95155),l=a(12115),r=a(4733),i=a(21567),n=a(73312);let d=r.bL;r.l9;let c=r.ZL,m=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:s})});m.displayName=r.hJ.displayName;let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsxs)(c,{children:[(0,t.jsx)(m,{}),(0,t.jsx)(r.UC,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});o.displayName=r.UC.displayName;let x=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...a})};x.displayName="AlertDialogHeader";let u=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};u.displayName="AlertDialogFooter";let h=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.hE,{ref:s,className:(0,i.cn)("text-lg font-semibold",a),...l})});h.displayName=r.hE.displayName;let f=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.VY,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",a),...l})});f.displayName=r.VY.displayName;let p=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.rc,{ref:s,className:(0,i.cn)((0,n.r)(),a),...l})});p.displayName=r.rc.displayName;let g=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.ZD,{ref:s,className:(0,i.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});g.displayName=r.ZD.displayName},38002:(e,s,a)=>{"use strict";a.d(s,{Fc:()=>d,TN:()=>m,XL:()=>c});var t=a(95155),l=a(12115),r=a(31027),i=a(21567);let n=(0,r.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=l.forwardRef((e,s)=>{let{className:a,variant:l,...r}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,i.cn)(n({variant:l}),a),...r})});d.displayName="Alert";let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...l})});c.displayName="AlertTitle";let m=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...l})});m.displayName="AlertDescription"},25121:(e,s,a)=>{"use strict";a.d(s,{E:()=>n});var t=a(95155);a(12115);var l=a(31027),r=a(21567);let i=(0,l.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:a,...l}=e;return(0,t.jsx)("div",{className:(0,r.cn)(i({variant:a}),s),...l})}},22130:(e,s,a)=>{"use strict";a.d(s,{BT:()=>c,Wu:()=>m,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>o});var t=a(95155),l=a(12115),r=a(21567);let i=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow mt-7",a),...l})});i.displayName="Card";let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-row lg:flex-row md:flex-col sm:flex-col md:items-center md:justify-between p-6 border-b bg-blue-500 mx-3 -mt-6 px-8 pt-4 pb-4 rounded-xl shadow-lg text-white space-y-4 md:space-y-0 mb-4",a),...l})});n.displayName="CardHeader";let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("font-semibold leading-none tracking-tight",a),...l})});d.displayName="CardTitle";let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted",a),...l})});c.displayName="CardDescription";let m=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("p-3 pt-0",a),...l})});m.displayName="CardContent";let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-3 pt-0",a),...l})});o.displayName="CardFooter"},98986:(e,s,a)=>{"use strict";a.d(s,{J:()=>c});var t=a(95155),l=a(12115),r=a(46195),i=a(31027),n=a(21567);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.b,{ref:s,className:(0,n.cn)(d(),a),...l})});c.displayName=r.b.displayName},87081:(e,s,a)=>{"use strict";a.d(s,{E:()=>r});var t=a(95155),l=a(21567);function r(e){let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-primary/10",s),...a})}},21567:(e,s,a)=>{"use strict";a.d(s,{cn:()=>r});var t=a(43463),l=a(69795);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,l.QP)((0,t.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[1181,8526,8562,164,2589,814,8007,5565,9526,6143,4015,8665,5449,6137,7555,7328,9086,8441,1517,7358],()=>s(44908)),_N_E=e.O()}]);